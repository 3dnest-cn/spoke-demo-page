(function(t){function e(e){for(var r,o,s=e[0],u=e[1],c=e[2],h=0,f=[];h<s.length;h++)o=s[h],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&f.push(i[o][0]),i[o]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(t[r]=u[r]);l&&l(e);while(f.length)f.shift()();return a.push.apply(a,c||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],r=!0,s=1;s<n.length;s++){var u=n[s];0!==i[u]&&(r=!1)}r&&(a.splice(e--,1),t=o(o.s=n[0]))}return t}var r={},i={app:0},a=[];function o(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=r,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(n,r,function(e){return t[e]}.bind(null,r));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],u=s.push.bind(s);s.push=e,s=s.slice();for(var c=0;c<s.length;c++)e(s[c]);var l=u;a.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},1227:function(t,e,n){},"33ba":function(t){t.exports=JSON.parse('{"a":"0.0.0"}')},4909:function(t){t.exports=JSON.parse('{"a":"0.0.0"}')},"4c9e":function(t){t.exports=JSON.parse('{"a":"0.0.0"}')},"56d7":function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"EventType",(function(){return V})),n.d(r,"EventListener",(function(){return X})),n.d(r,"PointAxis",(function(){return Y})),n.d(r,"Point",(function(){return z}));var i={};n.r(i),n.d(i,"Element",(function(){return Q})),n.d(i,"Plugin",(function(){return nt})),n.d(i,"_",(function(){return q}));var a={};n.r(a),n.d(a,"PI",(function(){return it})),n.d(a,"ROUND",(function(){return at}));var o={};n.r(o),n.d(o,"fromTwoPoint",(function(){return dt})),n.d(o,"dot",(function(){return vt})),n.d(o,"multiply",(function(){return pt})),n.d(o,"cross",(function(){return gt})),n.d(o,"getLength",(function(){return yt})),n.d(o,"rotate90",(function(){return bt})),n.d(o,"normalize",(function(){return mt})),n.d(o,"invert",(function(){return wt})),n.d(o,"clone",(function(){return $t})),n.d(o,"rotate",(function(){return Ot})),n.d(o,"project",(function(){return xt}));var s={};n.r(s),n.d(s,"fromSegment",(function(){return Dt})),n.d(s,"toStandard",(function(){return Vt})),n.d(s,"intersectLine",(function(){return Xt}));var u={};n.r(u),n.d(u,"translate",(function(){return ct})),n.d(u,"toLeftOfSegment",(function(){return jt})),n.d(u,"rotate",(function(){return kt})),n.d(u,"project",(function(){return Tt})),n.d(u,"distanceToPoint",(function(){return Et})),n.d(u,"distanceToLine",(function(){return St})),n.d(u,"distanceToSegment",(function(){return Yt}));var c={};n.r(c),n.d(c,"differ",(function(){return zt}));var l={};n.r(l),n.d(l,"intersectSegment",(function(){return Gt})),n.d(l,"translate",(function(){return te}));var h={};n.r(h),n.d(h,"containsPoint",(function(){return ee}));var f={};n.r(f),n.d(f,"Vertex",(function(){return ne})),n.d(f,"HalfEdge",(function(){return re})),n.d(f,"Face",(function(){return ie}));var d={};n.r(d),n.d(d,"allHalfEdgeOfVertex",(function(){return se})),n.d(d,"allHalfEdgeOfPath",(function(){return ce}));var v={};n.r(v),n.d(v,"Struct",(function(){return f})),n.d(v,"Iterator",(function(){return d})),n.d(v,"createVertex",(function(){return le})),n.d(v,"getVertexHalfEdgeList",(function(){return he})),n.d(v,"hasNoHalfEdge",(function(){return fe})),n.d(v,"hasOnlyHalfEdge",(function(){return de})),n.d(v,"getAngleOfHalfEdge",(function(){return ve})),n.d(v,"isPathContainsHalfEdge",(function(){return pe})),n.d(v,"isPathContainsVertex",(function(){return ge})),n.d(v,"isTwinInSamePath",(function(){return ye})),n.d(v,"getPathOfHalfEdge",(function(){return be})),n.d(v,"isOuterPath",(function(){return we})),n.d(v,"isInnerPath",(function(){return $e})),n.d(v,"splitHalfEdgeByVertex",(function(){return Oe})),n.d(v,"getPolygonFromFaceOuter",(function(){return je})),n.d(v,"getFaceOfPoint",(function(){return Ee})),n.d(v,"createGlobalFace",(function(){return Se})),n.d(v,"queryChildFaceList",(function(){return Te}));var p={};n.r(p),n.d(p,"CENTER",(function(){return Tn})),n.d(p,"CURRENT_POINTER",(function(){return En}));var g={};n.r(g),n.d(g,"register",(function(){return Aa})),n.d(g,"HollowProxy",(function(){return Xa})),n.d(g,"plugin",(function(){return za}));var y={};n.r(y),n.d(y,"register",(function(){return Qa})),n.d(y,"registerUrl",(function(){return Za})),n.d(y,"plugin",(function(){return oo}));var b={};n.r(b),n.d(b,"IDLE",(function(){return ts})),n.d(b,"PICKING_FROM",(function(){return es})),n.d(b,"PICKING_TO",(function(){return ns}));var m={};n.r(m),n.d(m,"STAGE",(function(){return b})),n.d(m,"plugin",(function(){return fs}));var w={};n.r(w),n.d(w,"Drawing",(function(){return Nn})),n.d(w,"use",(function(){return rn})),n.d(w,"PIXI",(function(){return S})),n.d(w,"SCALE_MODE",(function(){return p})),n.d(w,"Wall",(function(){return g})),n.d(w,"Room",(function(){return y})),n.d(w,"StructureTool",(function(){return m}));var $={};n.r($),n.d($,"SingleDoor",(function(){return _c})),n.d($,"DoubleDoor",(function(){return Bc})),n.d($,"SlidingDoor",(function(){return Vc})),n.d($,"ParentDoor",(function(){return Xc})),n.d($,"Bealock",(function(){return Yc}));var O={};n.r(O),n.d(O,"BasicWindow",(function(){return zc})),n.d(O,"BoilerWindow",(function(){return Uc})),n.d(O,"FloorWindow",(function(){return Gc})),n.d(O,"LWindow",(function(){return Kc})),n.d(O,"UWindow",(function(){return qc})),n.d(O,"LBoilerWindow",(function(){return Jc})),n.d(O,"UBoilerWindow",(function(){return Qc}));n("e260"),n("e6cf"),n("cca6"),n("a79d"),n("1227");var x=n("2b0e"),j=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("framework",{staticClass:"h-100"})},k=[],T=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"d-flex text-monospace",staticStyle:{"font-size":"12px","user-select":"none"}},[n("div",{staticClass:"d-flex flex-column",staticStyle:{width:"300px"}},[n("core-state",{attrs:{drawing:t.drawing}}),n("div",{staticClass:"h-100 overflow-auto"},t._l(t.componentList,(function(e,r){return n("b-card",{key:r,attrs:{"no-body":""}},[n("b-card-header",{staticClass:"p-0",attrs:{"header-tag":"header",role:"tab"}},[n("b-button",{staticClass:"py-0 text-left",attrs:{block:"",variant:"info"},on:{click:function(e){return t.toggleState(r)}}},[t._v(t._s(e.title))])],1),n("b-collapse",{attrs:{visible:t.stateShowingList[r]}},[n(e.stateComponent,{tag:"component",attrs:{drawing:t.drawing}})],1)],1)})),1)],1),n("div",{ref:"drawing",staticClass:"overflow-hidden",staticStyle:{flex:"1"}}),n("div",{staticStyle:{width:"300px"}},[n("core-tool",{attrs:{drawing:t.drawing}}),n("div",t._l(t.componentList,(function(e,r){return n("b-card",{key:r,attrs:{"no-body":""}},[n("b-card-header",{staticClass:"p-0",attrs:{"header-tag":"header",role:"tab"}},[n("b-button",{staticClass:"py-0 text-left",attrs:{block:"",variant:"dark"},on:{click:function(e){return t.toggleTool(r)}}},[t._v(t._s(e.title))])],1),n("b-collapse",{attrs:{visible:t.toolShowingList[r]}},[n(e.toolComponent,{tag:"component",attrs:{drawing:t.drawing}})],1)],1)})),1)],1)])},E=[],S=(n("d81d"),n("d3b7"),n("159b"),n("3a02")),C=n("3338"),F=n("d91e"),N=function(){return{}},P=function(){return F["a"]()},W=function(t){var e={data:N,created:C["c"],methods:{},getters:{},proxy:function(){return this},options:P},n=t.data,r=void 0===n?e.data:n,i=t.created,a=void 0===i?e.created:i,o=t.methods,s=void 0===o?e.methods:o,u=t.getters,c=void 0===u?e.getters:u,l=t.proxy,h=void 0===l?e.proxy:l,f=t.options,d=void 0===f?e.options:f;for(var v in C["e"].Not.Function(r)&&C["a"].Throw.TypeError("Invalid `.data`, a function as constructor expected."),C["e"].Not.Function(a)&&C["a"].Throw.TypeError("Invalid `.created`, a function expected."),C["e"].Not.Object(s)&&C["a"].Throw.TypeError("Invalid `.methods`, an object expected."),s)C["e"].Not.Function(s[v])&&C["a"].Throw.TypeError("Invalid `.methods.".concat(v,"`, a function expected."));for(var p in C["e"].Not.Object(c)&&C["a"].Throw.TypeError("Invalid `.getters`, an object expected."),c)C["e"].Not.Function(c[p])&&C["a"].Throw.TypeError("Invalid `.getters.".concat(p,"`, a function expected."));return C["e"].Not.Function(h)&&C["a"].Throw.TypeError("Invalid `.proxy`, a function as constructor expected."),e.data=r,e.created=a,e.methods=s,e.getters=c,e.proxy=h,e.options=d,e},L=function(){return{}},H=function(t){var e={groupIndex:0,interative:!1,hoverable:!1,focusable:!1,selectable:!1,draggable:!1,state:L,render:null,created:C["c"],destroy:C["c"],methods:{},getters:{},proxy:function(){return this}},n=t.groupIndex,r=void 0===n?e.groupIndex:n,i=t.interative,a=void 0===i?e.interative:i,o=t.hoverable,s=void 0===o?e.hoverable:o,u=t.focusable,c=void 0===u?e.focusable:u,l=t.selectable,h=void 0===l?e.selectable:l,f=t.draggable,d=void 0===f?e.draggable:f,v=t.state,p=void 0===v?e.state:v,g=t.render,y=void 0===g?e.render:g,b=t.created,m=void 0===b?e.created:b,w=t.destroy,$=void 0===w?e.destroy:w,O=t.methods,x=void 0===O?e.methods:O,j=t.getters,k=void 0===j?e.getters:j,T=t.proxy,E=void 0===T?e.proxy:T;for(var S in C["e"].Not.Number(r)&&C["a"].Throw.TypeError("Invalid `.elements[].groupIndex`, a number expected."),C["e"].Not.Boolean(a)&&C["a"].Throw.TypeError("Invalid `.elements[].interative`, a boolean expected."),C["e"].Not.Boolean(s)&&C["a"].Throw.TypeError("Invalid `.elements[].hoverable`, a boolean expected."),C["e"].Not.Boolean(c)&&C["a"].Throw.TypeError("Invalid `.elements[].focusable`, a boolean expected."),C["e"].Not.Boolean(h)&&C["a"].Throw.TypeError("Invalid `.elements[].selectable`, a boolean expected."),C["e"].Not.Boolean(d)&&C["a"].Throw.TypeError("Invalid `.elements[].draggable`, a boolean expected."),C["e"].Not.Function(p)&&C["a"].Throw.TypeError("Invalid `.elements[].state`, a function expected."),C["e"].Not.Function(y)&&C["e"].Not.Null(y)&&C["a"].Throw.TypeError("Invalid `.elements[].render`, a function or null expected."),C["e"].Not.Function(m)&&C["a"].Throw.TypeError("Invalid `.elements[].created`, a function expected."),C["e"].Not.Function($)&&C["a"].Throw.TypeError("Invalid `.elements[].destroy`, a function expected."),C["e"].Not.Object(x)&&C["a"].Throw.TypeError("Invalid `.elements[].methods`, an object as function map expected"),x)C["e"].Not.Function(x[S])&&C["a"].Throw.TypeError("Invalid `.elements[].methods.".concat(S,"`, a function expected."));for(var F in C["e"].Not.Object(k)&&C["a"].Throw.TypeError("Invalid `.elements[].getters`, an object as function map expected"),k)C["e"].Not.Function(k[F])&&C["a"].Throw.TypeError("Invalid `.elements[].getters.".concat(F,"`, a function expected."));return C["e"].Not.Function(E)&&C["a"].Throw.TypeError("Invalid `.proxy`, a function as constructor expected."),e.groupIndex=r,e.interative=a,e.hoverable=s,e.focusable=c,e.selectable=h,e.draggable=d,e.state=p,e.render=y,e.created=m,e.destroy=$,e.methods=x,e.getters=k,e.proxy=E,e},M=n("26a3"),I=n("0402"),D=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e={namespace:null,version:null,dependencies:[],plugin:{},elements:{}},n=t.id,r=t.version,i=t.namespace,a=void 0===i?e.namespace:i,o=t.dependencies,s=void 0===o?e.dependencies:o,u=t.plugin,c=void 0===u?e.plugin:u,l=t.elements,h=void 0===l?e.elements:l;if(C["e"].Not.String(n)&&C["a"].Throw.TypeError("Invalid `.id`, a string expected."),C["e"].Not.String(r)&&C["a"].Throw.TypeError("Invalid `.version`, string expected."),C["e"].Not.String(a)&&C["e"].Not.Null(a)&&C["a"].Throw.TypeError("Invalid `.namespace`, a string or null expected."),C["e"].Not.Array(s))C["a"].Throw.TypeError("Invalid `.dependencies`, an array expected.");else{var f,d=Object(I["a"])(s);try{for(d.s();!(f=d.n()).done;){var v=Object(M["a"])(f.value,2),p=v[0],g=v[1];C["e"].Not.String(p)&&C["a"].Throw.TypeError("Invalid `.dependencies[".concat(g,"]`, a string expected."))}}catch(b){d.e(b)}finally{d.f()}}for(var y in C["e"].Not.Object(h)&&C["a"].Throw.TypeError("Invalid `.elements`, an object as map expected."),e.id=n,e.version=r,e.namespace=a,e.dependencies=s,e.plugin=W(c),h)e.elements[y]=H(h[y]);return e},R=n("ac84"),A=n("2d58"),_=n("2fe6"),B=n("0bd7"),V=(n("99af"),n("dca8"),n("caad"),n("2532"),n("07ac"),function(t){C["e"].Not.String(t)&&C["a"].Throw.TypeError("Invalid event `type`, a string expected.")}),X=function(t){C["e"].Not.Function(t)&&C["a"].Throw.TypeError("In valid event `listener`, a function expected.")},Y=function(t,e){C["e"].Not.Number(t)&&C["a"].Throw.TypeError("Invalid `".concat(e,"`, a number excepted."))},z=function(t,e){Y(t),Y(e)},U=n("a007"),G=n("e3fc"),K=(n("3ca3"),n("10d1"),n("ddb0"),new WeakMap),q=function(t){return K.get(t)},J=function(){function t(e){Object(R["a"])(this,t),K.set(this,e)}return Object(A["a"])(t,[{key:"on",value:function(t,e){return V(t),X(e),q(this).$on(t,e),this}},{key:"off",value:function(t,e){return V(t),X(e),q(this).$off(t,e),this}}]),t}(),Q=function(t){Object(U["a"])(n,t);var e=Object(G["a"])(n);function n(t){return Object(R["a"])(this,n),e.call(this,t)}return Object(A["a"])(n)}(J),Z=n("c20e"),tt=new WeakMap,et=function(t){return tt.get(t)},nt=function(t){Object(U["a"])(n,t);var e=Object(G["a"])(n);function n(t){var r;return Object(R["a"])(this,n),r=e.call(this,t),tt.set(Object(Z["a"])(r),t),r}return Object(A["a"])(n,[{key:"options",get:function(){return et(this).$options}},{key:"setOptions",value:function(){}}]),n}(J),rt=Math,it=rt.PI,at=2*it,ot=[0,0],st=0,ut=1,ct=function(t,e,n,r){return ot[st]=t+n,ot[ut]=e+r,ot},lt=0,ht=1,ft=[0,0],dt=function(t,e,n,r){return ft[lt]=n-t,ft[ht]=r-e,ft},vt=function(t,e,n,r){return t*n+e*r},pt=function(t,e,n){return ft[lt]=t*n,ft[ht]=e*n,ft},gt=function(t,e,n,r){return t*r-e*n},yt=function(t,e){return C["b"].sqrt(vt(t,e,t,e))},bt=function(t,e){return ft[lt]=-e,ft[ht]=t,ft},mt=function(t,e){var n=yt(t,e);return 0===n&&C["a"].throwError("Zero Vector CAN NOT be normalized."),ft[lt]=t/n,ft[ht]=e/n,ft},wt=function(t,e){return ft[lt]=-t,ft[ht]=-e,ft},$t=(n("fb6a"),function(t){return t.slice(0)}),Ot=function(t,e,n){var r=C["b"].cos(n),i=C["b"].sin(n);return ft[lt]=t*r-e*i,ft[ht]=t*i+e*r,ft},xt=function(t,e,n,r){var i=mt(n,r);return pt.apply(void 0,Object(B["a"])(i).concat([vt.apply(void 0,[t,e].concat(Object(B["a"])(i)))]))},jt=function(t,e,n,r,i,a){return gt.apply(o,Object(B["a"])(dt(n,r,i,a)).concat(Object(B["a"])(dt(i,a,t,e))))>0},kt=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return ct.apply(void 0,Object(B["a"])(Ot.apply(o,Object(B["a"])(dt(r,i,t,e)).concat([n]))).concat([r,i]))},Tt=function(t,e,n,r,i,a){if(t===n&&e===r)return ot[st]=t,ot[ut]=e,ot;var s=dt(t,e,n,r);if(0===gt.apply(o,Object(B["a"])(s).concat([i,a])))return ot[st]=n,ot[ut]=r,ot;var u=vt.apply(o,Object(B["a"])(s).concat([i,a]));return ct.apply(void 0,[t,e].concat(Object(B["a"])(pt(i,a,u))))},Et=function(t,e,n,r){return yt.apply(o,Object(B["a"])(dt(t,e,n,r)))},St=function(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return Et.apply(void 0,[t,e].concat(Object(B["a"])(Tt.apply(void 0,[t,e].concat(r)))))},Ct=[0,0,1,0],Ft=0,Nt=1,Pt=2,Wt=3,Lt=mt,Ht=dt,Mt=bt,It=wt,Dt=function(t,e,n,r){var i=Mt.apply(void 0,Object(B["a"])(Lt.apply(void 0,Object(B["a"])(Ht(t,e,n,r))))),a=Object(M["a"])(i,2),o=a[0],s=a[1];if(Ct[Ft]=t,Ct[Nt]=e,vt(o,s,t,e)>=0){var u=It(o,s),c=Object(M["a"])(u,2),l=c[0],h=c[1];Ct[Pt]=l,Ct[Wt]=h}else Ct[Pt]=o,Ct[Wt]=s;return Ct},Rt=[0,0,0],At=0,_t=1,Bt=2,Vt=function(t,e,n,r){return Rt[At]=n,Rt[_t]=r,Rt[Bt]=vt(n,r,t,e),Rt},Xt=function(t,e,n,r,i,a,o,s){var u=Vt(t,e,n,r),c=Object(M["a"])(u,3),l=c[0],h=c[1],f=c[2],d=Vt(i,a,o,s),v=Object(M["a"])(d,3),p=v[0],g=v[1],y=v[2],b=l*g-h*p,m=f*g-h*y,w=l*y-f*p;return 0===b?null:(0===h?(ot[st]=f/l,ot[ut]=w/b):0===g?(ot[st]=y/p,ot[ut]=w/b):0===l?(ot[st]=m/b,ot[ut]=f/h):0===p?(ot[st]=m/b,ot[ut]=y/g):(ot[st]=m/b,ot[ut]=w/b),ot)},Yt=function(t,e,n,r,i,a){return St.apply(void 0,[t,e].concat(Object(B["a"])(Dt(n,r,i,a))))},zt=function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=(n?1:-1)*(t-e);return r>=0?r:r+at},Ut=function(t,e,n,r,i,a){return(t-i)*(r-a)-(e-a)*(n-i)},Gt=function(t,e,n,r,i,a,o,s){var u=Ut(t,e,n,r,i,a),c=Ut(t,e,n,r,o,s);if(u*c>=0)return null;var l=Ut(i,a,o,s,t,e),h=l+u-c;if(l*h>=0)return null;var f=l/(c-u);return ot[st]=t+f*(n-t),ot[ut]=e+f*(r-e),ot},Kt=[0,0,0,0],qt=0,Jt=1,Qt=2,Zt=3,te=function(t,e,n,r,i,a){return Kt[qt]=t+i,Kt[Jt]=e+a,Kt[Qt]=n+i,Kt[Zt]=r+a,Kt},ee=function(t,e){for(var n=!1,r=t.length,i=0,a=r-1;i<r;a=i++){var o=t[i],s=t[a],u=o.y>e.y!==s.y>e.y&&e.x<(e.y-o.y)/(s.y-o.y)*(s.x-o.x)+o.x;u&&(n=!n)}return n},ne=Object(A["a"])((function t(e,n){Object(R["a"])(this,t),this.x=e,this.y=n,this.incidentEdge=null})),re=Object(A["a"])((function t(){Object(R["a"])(this,t),this.origin=null,this.twin=null,this.incidentFace=null,this.next=null,this.previous=null})),ie=Object(A["a"])((function t(){Object(R["a"])(this,t),this.outerComponent=null,this.innerComponents=[]})),ae=(n("96cf"),9999),oe=regeneratorRuntime.mark(se);function se(t){var e,n,r;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(e=t.incidentEdge,!C["e"].Not.Null(e)){i.next=8;break}n=e,r=0;case 3:return i.next=5,n;case 5:n=n.twin.next,r++;case 7:if(n!==e&&r<ae){i.next=3;break}case 8:case"end":return i.stop()}}),oe)}var ue=regeneratorRuntime.mark(ce);function ce(t){var e,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:e=t,n=0;case 1:return r.next=3,e;case 3:e=e.next,n++;case 5:if(e!==t&&n<ae){r.next=1;break}case 6:case"end":return r.stop()}}),ue)}var le=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new ne(t,e)},he=function(t){var e,n=[],r=Object(I["a"])(se(t));try{for(r.s();!(e=r.n()).done;){var i=e.value;n.push(i)}}catch(a){r.e(a)}finally{r.f()}return n},fe=function(t){return C["e"].isNull(t.incidentEdge)},de=function(t){return!fe(t)&&t.incidentEdge===t.incidentEdge.twin.next},ve=function(t){var e=t.origin,n=e.x,r=e.y,i=t.twin.origin,a=i.x,o=i.y;return Math.atan2(o-r,a-n)},pe=function(t,e){var n,r=Object(I["a"])(ce(t));try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i===e)return!0}}catch(a){r.e(a)}finally{r.f()}return!1},ge=function(t,e){var n,r=Object(I["a"])(ce(t));try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.origin===e)return!0}}catch(a){r.e(a)}finally{r.f()}return!1},ye=function(t){return pe(t,t.twin)},be=function(t){var e,n=[],r=Object(I["a"])(ce(t));try{for(r.s();!(e=r.n()).done;){var i=e.value;n.push(i)}}catch(a){r.e(a)}finally{r.f()}return n},me=(n("aff5"),n("a9e3"),function(t){var e,n,r=null,i=-1/0;e=n=Number.MAX_SAFE_INTEGER;var a,o=Object(I["a"])(ce(t));try{for(o.s();!(a=o.n()).done;){var s=a.value,u=s.origin,c=u.x,l=u.y,h=s.next.origin,f=h.x,d=h.y,v=(d-l)/(f-c);(c<e||c===e&&l<n||c===e&&l===n&&v>i)&&(e=c,n=l,i=v,r=s)}}catch(p){o.e(p)}finally{o.f()}return r}),we=function(t){var e=me(t),n=e.previous.twin;return n!==e&&zt(ve(n),ve(e))<Math.PI},$e=function(t){return!we(t)},Oe=function(t,e){var n=t,r=n.twin,i=new re,a=new re;e.incidentEdge=i,i.origin=a.origin=e,i.incidentFace=n.incidentFace,a.incidentFace=r.incidentFace,i.twin=r,r.twin=i,a.twin=n,n.twin=a;var o=n.next,s=r.next;return i.next=o,n.next=i,i.previous=n,o.previous=i,a.next=s,r.next=a,a.previous=r,s.previous=a,i},xe=function(t){return t.origin},je=function(t){var e=t.outerComponent;return C["e"].isNull(e)?[]:be(e).map(xe)},ke=(n("a434"),function(t,e,n){var r=t.twin.incidentFace;e.includes(r)||(e.push(r),n.push(r))}),Te=function(t){var e,n=[t],r=[],i=Object(I["a"])(t.innerComponents);try{for(i.s();!(e=i.n()).done;){var a,o=e.value,s=Object(I["a"])(ce(o));try{for(s.s();!(a=s.n()).done;){var u=a.value;ke(u,n,r)}}catch(p){s.e(p)}finally{s.f()}while(r.length){var c,l=Object(I["a"])(r.splice(0));try{for(l.s();!(c=l.n()).done;){var h,f=c.value,d=Object(I["a"])(ce(f.outerComponent));try{for(d.s();!(h=d.n()).done;){var v=h.value;ke(v,n,r)}}catch(p){d.e(p)}finally{d.f()}}}catch(p){l.e(p)}finally{l.f()}}}}catch(p){i.e(p)}finally{i.f()}return n.shift(),n},Ee=function t(e,n){var r=!!C["e"].isNull(e.outerComponent)||ee(je(e),n);if(r){var i,a=Object(I["a"])(Te(e));try{for(a.s();!(i=a.n()).done;){var o=i.value,s=t(o,n);if(C["e"].Not.Null(s))return s}}catch(u){a.e(u)}finally{a.f()}return e}return null},Se=function(){return new ie},Ce=(n("4ec9"),n("4743")),Fe=n("dcb4"),Ne=(n("b0c0"),n("4e82"),n("e5cd")),Pe=n("0384"),We=(n("af93"),function(t,e){var n=function(n){Object.defineProperty(t,n,{get:function(){return e[n].call(this)}})};for(var r in e)n(r)}),Le=function(t,e){var n=function(n){var r=e[n];t[n]=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.call.apply(r,[this].concat(e))}};for(var r in e)n(r)},He=(n("6062"),new Set),Me=new S["Container"],Ie=new WeakMap,De=function(t){return Ie.get(t)},Re=function(t){Object(U["a"])(n,t);var e=Object(G["a"])(n);function n(t){var r;return Object(R["a"])(this,n),r=e.call(this),r.plugin=t,r.context=null,r.graphics=null,r.isDirty=!1,r._update=C["c"],r.destroyed=!1,r.collection.add(Object(Z["a"])(r)),r}return Object(A["a"])(n,[{key:"renderable",get:function(){return!1}},{key:"interactive",get:function(){return!1}},{key:"hoverable",get:function(){return!1}},{key:"focusable",get:function(){return!1}},{key:"selectable",get:function(){return!1}},{key:"draggable",get:function(){return!1}},{key:"drawing",get:function(){return this.plugin.drawing}},{key:"selecting",get:function(){return this.drawing.state.selecting===this}},{key:"hovering",get:function(){return this.drawing.state.hovering===this}},{key:"holding",get:function(){return this.drawing.state.holding===this}},{key:"focusing",get:function(){return this.drawing.state.focusing===this}},{key:"hover",value:function(){C["e"].isNull(this.drawing.state.holding)&&(this.drawing.setHovering(this),this.setDirty())}},{key:"cancelHover",value:function(){this.drawing.setHovering(),this.setDirty()}},{key:"focus",value:function(){var t=this.drawing.state.focusing;t!==this&&(this.drawing.setFocusing(this),Ae(this,"focus"),this.setDirty())}},{key:"emitBlur",value:function(){Ae(this,"blur"),this.setDirty()}},{key:"hold",value:function(){this.drawing.setHolding(this),this.setDirty()}},{key:"release",value:function(){this.drawing.setHolding(),this.setDirty()}},{key:"group",get:function(){return Me}},{key:"application",get:function(){return this.drawing.application}},{key:"collection",get:function(){return He}},{key:"show",value:function(){this.graphics.visible=!0}},{key:"hide",value:function(){this.graphics.visible=!1}},{key:"setDirty",value:function(){this.destroyed||this.isDirty||(this.isDirty=!0,Ae(this,"dirty"))}},{key:"getBounds",value:function(){return this.graphics.getBounds()}},{key:"update",value:function(){this.isDirty&&(this.isDirty=!1,this.graphics.clear(),this._update(this.graphics),Ae(this,"render"))}},{key:"destroy",value:function(){C["e"].Not.Null(this.graphics)&&(this.graphics.destroy(),this.application.ticker.remove(this.observer)),this.collection.delete(this),Ae(this,"destroy"),Fe["a"].destroy(this),this.destroyed=!0}}]),n}(Fe["a"].Emitter),Ae=function(t,e){t.emit(e,t.drawing.globalEvent)},_e=Re,Be=function(){function t(){Object(R["a"])(this,t),this.$proxy=this,this.$state=C["d"].freeze({})}return Object(A["a"])(t,[{key:"$data",get:function(){return De(this).plugin.context.$data}},{key:"$drawing",get:function(){return De(this).drawing.proxy}},{key:"$selecting",get:function(){return De(this).selecting}},{key:"$focusing",get:function(){return De(this).focusing}},{key:"$hovering",get:function(){return De(this).hovering}},{key:"$holding",get:function(){return De(this).holding}},{key:"$visable",get:function(){return De(this).graphics.visible}},{key:"$isDirty",get:function(){return De(this).isDirty}},{key:"$getBounds",value:function(){return De(this).getBounds()}},{key:"$show",value:function(){De(this).show()}},{key:"$hide",value:function(){De(this).hide()}},{key:"$setDirty",value:function(){De(this).setDirty()}},{key:"$destroy",value:function(){De(this).destroy()}},{key:"$on",value:function(t,e){return r.EventType(t),r.EventListener(e),De(this).on(t,e),this}},{key:"$off",value:function(t,e){return r.EventType(t),r.EventListener(e),De(this).off(t,e),this}},{key:"$emit",value:function(t){for(var e,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return(e=De(this)).emit.apply(e,[t].concat(r)),this}},{key:"$focus",value:function(){var t=De(this);t.focusable&&t.focus()}},{key:"$toCanvas",value:function(t,e){return r.Point(t,e),De(this).drawing.coordinate.toCanvas(t,e)}},{key:"$toGeometry",value:function(t,e){return r.Point(t,e),De(this).drawing.coordinate.toGeometry(t,e)}}]),t}(),Ve=Be,Xe=function(t,e){var n=C["e"].Not.Null(e.render),r=function(r){Object(U["a"])(o,r);var a=Object(G["a"])(o);function o(r){var s,u;Object(R["a"])(this,o),u=a.call(this,r);var c=new i;if(n){var l=new S["Graphics"];u.observer=function(){return u.update()},u.application.ticker.add(u.observer),u.group.addChild(l),u.graphics=l,u.graphics.name=t,u.graphics.interactive=e.interative,e.interative&&(l.on("pointermove",(function(){return Ae(Object(Z["a"])(u),"pointermove")})).on("pointerover",(function(){return Ae(Object(Z["a"])(u),"pointerover")})).on("pointerout",(function(){return Ae(Object(Z["a"])(u),"pointerout")})).on("pointerdown",(function(){return Ae(Object(Z["a"])(u),"pointerdown")})).on("pointerup",(function(){return Ae(Object(Z["a"])(u),"pointerup")})),e.hoverable&&l.on("pointerover",(function(){return u.hover()})).on("pointerout",(function(){return u.cancelHover()})),e.draggable&&l.on("pointerdown",(function(){return u.hold()})).on("pointerup",(function(){return u.release()})),e.focusable&&l.on("pointerdown",Ce["b"].stopPropagation).on("pointerdown",(function(){return u.focus()}))),u._update=e.render.bind(c)}u.context=c,Ie.set(c,Object(Z["a"])(u));for(var h=arguments.length,f=new Array(h>1?h-1:0),d=1;d<h;d++)f[d-1]=arguments[d];return(s=e.created).call.apply(s,[c].concat(f)),u.setDirty(),u}return Object(A["a"])(o,[{key:"renderable",get:function(){return n}},{key:"interactive",get:function(){return this.renderable&&e.interative}},{key:"hoverable",get:function(){return this.interactive&&e.hoverable}},{key:"focusable",get:function(){return this.interactive&&e.focusable}},{key:"selectable",get:function(){return this.interactive&&e.selectable}},{key:"draggable",get:function(){return this.interactive&&e.draggable}},{key:"group",get:function(){return this.plugin.drawing.groupMap.get(o)}},{key:"collection",get:function(){return this.plugin.elementCollectionMap[t]}}]),o}(_e),i=function(n){Object(U["a"])(i,n);var r=Object(G["a"])(i);function i(){var t;return Object(R["a"])(this,i),t=r.call(this),t.$proxy=e.proxy.call(Object(Z["a"])(t)),t.$state=C["d"].seal(e.state.call(Object(Z["a"])(t))),C["d"].freeze(Object(Z["a"])(t)),t}return Object(A["a"])(i,[{key:"$name",get:function(){return t}},{key:"$data",get:function(){return this.$plugin.$data}},{key:"$plugin",get:function(){return De(this).plugin.context}},{key:"$destroy",value:function(){Object(Ne["a"])(Object(Pe["a"])(i.prototype),"$destroy",this).call(this),e.destroy.call(this)}}]),i}(Ve);return We(i.prototype,e.getters),Le(i.prototype,e.methods),r},Ye=n("493b"),ze=Object(F["a"])(),Ue=Object(F["a"])({capture:!0,autoResizing:!0},{snap:Object(F["a"])({enable:!0,interval:20}),scale:Object(F["a"])({max:100,min:1}),style:Object(F["a"])({backgroundColor:{value:15790320,set:function(t){this.application.renderer.backgroundColor=t}},backgroundOpacity:{value:1,set:function(t){this.application.renderer.backgroundAlpha=t}},fontSize:12}),plugin:ze}),Ge=new WeakMap,Ke=function(t){return Ge.get(t)},qe=function(t){Object(U["a"])(n,t);var e=Object(G["a"])(n);function n(t){var r;return Object(R["a"])(this,n),r=e.call(this),r.context=null,r.drawing=t,r.elementCollectionMap={},r}return Object(A["a"])(n,[{key:"forceUpdate",value:function(){for(var t in this.elementCollectionMap){var e,n=Object(I["a"])(this.elementCollectionMap[t]);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.setDirty()}}catch(i){n.e(i)}finally{n.f()}}}}]),n}(Fe["a"].Emitter),Je=qe,Qe=function(t){C["e"].Not.String(t)&&C["a"].Throw.TypeError("Invalid `className`, a string excepted.")},Ze=function(){function t(e,n){Object(R["a"])(this,t),this.$id=e,this.$version=n,this.$proxy=this,this.$data=C["d"].freeze({})}return Object(A["a"])(t,[{key:"$drawing",get:function(){return Ke(this).drawing.proxy}},{key:"$getElementList",value:function(t){Qe(t);var e=Ke(this).elementCollectionMap[t];C["e"].isUndefined(e)&&C["a"].throwError("The Element named `".concat(t,"` is NOT existed in this Plugin."));var n,r=[],i=Object(I["a"])(e);try{for(i.s();!(n=i.n()).done;){var a=n.value;r.push(a.context)}}catch(o){i.e(o)}finally{i.f()}return r}},{key:"$hideElement",value:function(t){Qe(t);var e=Ke(this).elementCollectionMap;if(t in e){var n,r=Object(I["a"])(e[t]);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.hide()}}catch(a){r.e(a)}finally{r.f()}}}},{key:"$showElement",value:function(t){Qe(t);var e=Ke(this).elementCollectionMap;if(t in e){var n,r=Object(I["a"])(e[t]);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.show()}}catch(a){r.e(a)}finally{r.f()}}}},{key:"$hideAll",value:function(){for(var t in Ke(this).elementCollectionMap)this.$hideElement(t)}},{key:"$showAll",value:function(){for(var t in Ke(this).elementCollectionMap)this.$showElement(t)}},{key:"$forceUpdate",value:function(){Ke(this).forceUpdate()}},{key:"$toCanvas",value:function(t,e){return r.Point(t,e),Ke(this).drawing.coordinate.toCanvas(t,e)}},{key:"$toGeometry",value:function(t,e){return r.Point(t,e),Ke(this).drawing.coordinate.toGeometry(t,e)}},{key:"$on",value:function(t,e){return r.EventType(t),r.EventListener(e),Ke(this).on(t,e),this}},{key:"$off",value:function(t,e){return r.EventType(t),r.EventListener(e),Ke(this).off(t,e),this}},{key:"$emit",value:function(t){var e;r.EventType(t);for(var n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];return(e=Ke(this)).emit.apply(e,[t].concat(i)),this}}]),t}(),tn=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=n.options(F["a"]);ze.appendChild(t,i);var a=function(t){Object(U["a"])(n,t);var e=Object(G["a"])(n);function n(t){var i;for(var a in Object(R["a"])(this,n),i=e.call(this,t),r)i.elementCollectionMap[a]=new Set;return Ge.set(i.context=new o,Object(Z["a"])(i)),i}return Object(A["a"])(n)}(Je),o=function(a){Object(U["a"])(s,a);var o=Object(G["a"])(s);function s(){var r;return Object(R["a"])(this,s),r=o.call(this,t,e),r.$proxy=n.proxy.call(Object(Z["a"])(r)),r.$data=C["d"].seal(n.data()),r.$options=new i(Object(Z["a"])(r)),C["d"].freeze(Object(Z["a"])(r)),r}return Object(A["a"])(s,[{key:"$createElement",value:function(t){Qe(t);var e=r[t].Element;C["e"].isUndefined(e)&&C["a"].throwError("The Element named `".concat(t,"` is NOT existed in this Plugin."));for(var n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];var o=Object(Ye["a"])(e,[Ke(this)].concat(i)).context;return this.$emit("element-created",o.$proxy,t),o}}]),s}(Ze);return Le(o.prototype,n.methods),We(o.prototype,n.getters),a},en=new Map,nn=[],rn=function(t){var e=D(t),n=e.id,r=e.namespace,i=e.version,a=e.plugin,o=e.elements;nn.some((function(t){return t.id===n}))&&C["a"].throwError("A Plugin id=".concat(n," is used."));var s={};for(var u in o)s[u]={index:o[u].groupIndex,Element:Xe(u,o[u])};var c=tn(n,i,a,s);en.set(c,a.created),nn.push({id:n,namespace:r,Plugin:c,Elements:Object.freeze(s)})},an=function(t){var e,n=[],r=Object(I["a"])(nn);try{for(r.s();!(e=r.n()).done;){var i=e.value,a=i.id,o=i.namespace,s=i.Plugin,u=i.Elements,c=new s(t),l=t.Plugin.Proxy[a]=c.context.$proxy;for(var h in t.Plugin.Context[a]=c.context,C["e"].isString(o)&&(C["e"].isUndefined(t.proxy[o])?t.proxy[o]=l:console.warn('Registering namespace "'.concat(o,'" is duplicated.'))),u){var f=new S["Container"],d=u[h];f.name="".concat(h,"-group"),t.groupMap.set(d.Element,f),n.push({container:f,index:d.index})}n.sort((function(t,e){return t.index-e.index}));var v,p=Object(I["a"])(n);try{for(p.s();!(v=p.n()).done;){var g=v.value;t.application.stage.addChild(g.container)}}catch(y){p.e(y)}finally{p.f()}en.get(s).call(c.context)}}catch(y){r.e(y)}finally{r.f()}},on={button:0,buttons:0,ctrlKey:!1,shiftKey:!1,altKey:!1,metaKey:!1},sn=function(t){return C["e"].isNull(t)?null:t.context.$proxy};function un(t,e){return C["d"].freeze({get drawing(){return t.proxy},get button(){return on.button},get buttons(){return on.buttons},get ctrlKey(){return on.ctrlKey},get shiftKey(){return on.shiftKey},get altKey(){return on.altKey},get metaKey(){return on.metaKey},get pointerX(){return e.pointer.x},get pointerY(){return e.pointer.y},get virtualX(){return e.virtual.x},get virtualY(){return e.virtual.y},get hovering(){return sn(e.hovering)},get focusing(){return sn(e.focusing)},get selecting(){return sn(e.selecting)},get holding(){return sn(e.holding)}})}["mousedown","mouseup"].forEach((function(t){Ce["a"].addEventListener(Ce["c"].WINDOW,t,(function(t){on.button=t.button,on.buttons=t.buttons}))})),["keydown","keyup"].forEach((function(t){Ce["a"].addEventListener(Ce["c"].WINDOW,t,(function(t){on.ctrlKey=t.ctrlKey,on.shiftKey=t.shiftKey,on.altKey=t.altKey,on.metaKey=t.metaKey}))}));var cn=25,ln=100,hn=100,fn=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ln,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:hn;Object(R["a"])(this,t),this.scale=cn,this.originX=e,this.originY=n}return Object(A["a"])(t,[{key:"setScale",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:cn;this.scale=t}},{key:"move",value:function(t,e){this.originX=C["b"].round(t),this.originY=C["b"].round(e)}},{key:"toGeometry",value:function(t,e){var n=this.scale,r=this.originX,i=this.originY;return[(t-r)*n,(i-e)*n]}},{key:"toCanvas",value:function(t,e){var n=this.scale,r=this.originX,i=this.originY;return[r+t/n,i-e/n]}}]),t}(),dn=function(){return{x:0,y:0}},vn=function(){return{capturing:!0,capturedAt:null,pointer:dn(),virtual:dn(),hovering:null,focusing:null,selecting:null,holding:null}},pn=(n("4de4"),n("a630"),function(){function t(){Object(R["a"])(this,t),this.disabledMap={},this.store=new Set}return Object(A["a"])(t,[{key:"register",value:function(t){this.store.add(t)}},{key:"remove",value:function(t){this.store.has(t)&&this.store.delete(t)}},{key:"from",value:function(t,e){var n=!1,r=[t,e],i=Array.from(this.store).filter(yn).sort(gn),a=function(t,e){C["e"].Not.Number(t)&&C["a"].Throw.TypeError("Invalid `x`, a number expected."),C["e"].Not.Number(e)&&C["a"].Throw.TypeError("Invalid `y`, a number expected."),r[0]=t,r[1]=e,n=!0};while(!n&&i.length>0)i.pop().handle(t,e,a);return r}}]),t}()),gn=function(t,e){return t.priority-e.priority},yn=function(t){return t.active},bn=new WeakMap,mn=function(t){return bn.get(t)},wn=["keydown","keyup"];function $n(t){Ce["a"].addEventListener(Ce["c"].WINDOW,t,this.keyboardEventListener)}function On(t){Ce["a"].removeEventListener(Ce["c"].WINDOW,t,this.keyboardEventListener)}for(var xn,jn=function(t){Object(U["a"])(n,t);var e=Object(G["a"])(n);function n(t){var r;Object(R["a"])(this,n),r=e.call(this,t),bn.set(t,Object(Z["a"])(r));var i=new Ue(Object(Z["a"])(r)),a=vn(),o=un(Object(Z["a"])(r),a),s=new pn,u=new S["Application"]({antialias:!0,backgroundColor:i.style.backgroundColor,backgroundAlpha:i.style.backgroundOpacity});return u.stage.interactive=!0,u.stage.hitArea=new S["Rectangle"],u.ticker.add((function(){return r.watchSnap()})).add((function(){return r.watchSize()})),u.stage.on("pointerdown",(function(){return kn(Object(Z["a"])(r),"pointerdown")})).on("pointerdown",(function(){return r.setFocusing()})).on("pointerup",(function(){return kn(Object(Z["a"])(r),"pointerup")})).on("pointerup",(function(){return r.setHolding()})).on("pointermove",(function(t){if(r.state.capturing){var e=t.data.global,n=e.x,i=e.y,o=a.pointer;o.x===n&&o.y===i||r.setPointer(n,i)}})),r.destroyed=!1,r.proxy=t,r.options=i,r.state=a,r.application=u,r.coordinate=new fn,r.globalEvent=o,r.snapManager=s,r.containerElement=null,r.keyboardEventListener=function(t){return kn(Object(Z["a"])(r),t.type)},r.groupMap=new Map,r.Plugin={Proxy:{},Context:{}},an(Object(Z["a"])(r)),C["d"].freeze(r.Plugin.Proxy),wn.forEach($n,Object(Z["a"])(r)),r}return Object(A["a"])(n,[{key:"canvasElement",get:function(){return this.application.view}},{key:"watchSize",value:function(){if(this.options.autoResizing){var t=this.application.view,e=t.parentElement;t.height===e.offsetHeight&&t.width===e.offsetWidth||this.resize()}}},{key:"watchSnap",value:function(){if(this.options.snap.enable){var t=this.state,e=t.capturedAt,n=t.virtual,r=t.pointer;if(!C["e"].isNull(e)){var i=Date.now();if(i-e>this.options.snap.interval){var a=this.snapManager.from(r.x,r.y),o=Object(M["a"])(a,2);n.x=o[0],n.y=o[1],kn(this,"pointermove"),kn(this,"snap"),this.state.capturedAt=null}}}}},{key:"mount",value:function(t){Ce["a"].appendChild(t,this.canvasElement),this.containerElement=t,kn(this,"mount"),this.resize()}},{key:"destroy",value:function(){wn.forEach(On,this),this.keyboardEventListener=null,Ce["a"].removeFromParent(this.canvasElement),Fe["a"].destroy(this),this.destroyed=!0}},{key:"resize",value:function(){var t=this.application,e=t.stage,n=t.view,r=this.containerElement,i=r.offsetWidth,a=r.offsetHeight;e.hitArea.width=n.width=i,e.hitArea.height=n.height=a,this.application.renderer.resize(i,a),this.forceUpdateAll(),kn(this,"resize")}},{key:"setPointer",value:function(t,e){this.state.pointer.x=this.state.virtual.x=t,this.state.pointer.y=this.state.virtual.y=e,this.state.capturedAt=Date.now(),kn(this,"pointermove")}},{key:"setHovering",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.state.hovering=t}},{key:"setFocusing",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.state.focusing;this.state.focusing=t,C["e"].Not.Null(e)&&e.emitBlur()}},{key:"setHolding",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.state.holding=t}},{key:"forceUpdateAll",value:function(){for(var t in this.Plugin.Context)this.Plugin.Context[t].$forceUpdate()}}]),n}(Fe["a"].Emitter),kn=function(t,e){t.emit(e,t.globalEvent)},Tn=0,En=1,Sn=function(t){return C["e"].isNull(t)?null:t.context.$proxy},Cn=function(t){return[t.x,t.y]},Fn=(xn={},Object(_["a"])(xn,Tn,(function(t,e){t.setScale(e)})),Object(_["a"])(xn,En,(function(t,e){t.setScaleByReference.apply(t,[e].concat(Object(B["a"])(t.pointer)))})),xn),Nn=function(){function t(){Object(R["a"])(this,t),new jn(this),C["d"].freeze(this)}return Object(A["a"])(t,[{key:"options",get:function(){return mn(this).options}},{key:"hovering",get:function(){return Sn(mn(this).state.hovering)}},{key:"selecting",get:function(){return Sn(mn(this).state.selecting)}},{key:"focusing",get:function(){return Sn(mn(this).state.focusing)}},{key:"holding",get:function(){return Sn(mn(this).state.holding)}},{key:"plugins",get:function(){return mn(this).Plugin.Proxy}},{key:"pointer",get:function(){return Cn(mn(this).state.pointer)}},{key:"virtual",get:function(){return Cn(mn(this).state.virtual)}},{key:"origin",get:function(){var t=mn(this).coordinate,e=t.originX,n=t.originY;return[e,n]}},{key:"scale",get:function(){return mn(this).coordinate.scale}},{key:"width",get:function(){return mn(this).application.view.width}},{key:"height",get:function(){return mn(this).application.view.height}},{key:"mount",value:function(t){C["a"].instanceOf(t,HTMLElement)||C["a"].Throw.TypeError("Invalid `element`, a HTMLElement expected."),mn(this).mount(t)}},{key:"resize",value:function(){mn(this).resize()}},{key:"destroy",value:function(){mn(this).destroy()}},{key:"setOrigin",value:function(t,e){r.Point(t,e);var n=mn(this);n.coordinate.move(t,e),n.forceUpdateAll()}},{key:"setScale",value:function(t){C["e"].Not.Number(t)&&C["a"].Throw.TypeError("Invalid scale, a number expected.");var e=mn(this),n=this.options.scale,r=n.min,i=n.max,a=C["b"].max(r,C["b"].min(i,t));e.coordinate.setScale(a),e.forceUpdateAll()}},{key:"setScaleByReference",value:function(t,e,n){var i,a;r.Point(e,n);var s=mn(this),c=this.origin,l=s.coordinate.toGeometry(e,n);this.setScale(t);var h=(i=s.coordinate).toCanvas.apply(i,Object(B["a"])(l)),f=o.fromTwoPoint.apply(o,Object(B["a"])(h).concat([e,n]));(a=s.coordinate).move.apply(a,Object(B["a"])(u.translate.apply(u,Object(B["a"])(c).concat(Object(B["a"])(f))))),s.forceUpdateAll()}},{key:"setScaleInMode",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Tn;C["d"].values(p).includes(e)?Fn[e](this,t):C["a"].Throw.TypeError("Invalid `mode`, a value of SCALE_MODE expected.")}},{key:"startCapture",value:function(){mn(this).state.capturing=!1}},{key:"stopCapture",value:function(){mn(this).state.capturing=!0}},{key:"on",value:function(t,e){return mn(this).on(t,e),this}},{key:"off",value:function(t,e){return mn(this).off(t,e),this}},{key:"registerSnap",value:function(t){mn(this).snapManager.register(t)}},{key:"removeSnap",value:function(t){mn(this).snapManager.remove(t)}}]),t}(),Pn=new WeakMap,Wn=function(t){return Pn.get(t)},Ln=function(){function t(e){Object(R["a"])(this,t),Pn.set(this,e)}return Object(A["a"])(t,[{key:"on",value:function(t,e){return Hn(t),Mn(e),Wn(this).$on(t,e),this}},{key:"off",value:function(t,e){return Hn(t),Mn(e),Wn(this).$off(t,e),this}}]),t}(),Hn=function(t){C["e"].Not.String(t)&&C["a"].Throw.TypeError("Invalid event `type`, a string expected.")},Mn=function(t){C["e"].Not.Function(t)&&C["a"].Throw.TypeError("In valid event `listener`, a function expected.")},In=new WeakMap,Dn=function(t){return In.get(t)},Rn=function(){function t(e){Object(R["a"])(this,t),In.set(this,e)}return Object(A["a"])(t,[{key:"on",value:function(t,e){return An(t),_n(e),Dn(this).$on(t,e),this}},{key:"off",value:function(t,e){return An(t),_n(e),Dn(this).$off(t,e),this}}]),t}(),An=function(t){C["e"].Not.String(t)&&C["a"].Throw.TypeError("Invalid event `type`, a string expected.")},_n=function(t){C["e"].Not.Function(t)&&C["a"].Throw.TypeError("In valid event `listener`, a function expected.")},Bn=function(t){return W(t)},Vn=function(t){return H(t)},Xn=function(t){return D(t)},Yn=n("4909"),zn=(n("9911"),n("ac1f"),n("1276"),function(t,e){var n,r=null,i=a.ROUND,o=Object(I["a"])(v.Iterator.allHalfEdgeOfVertex(t));try{for(o.s();!(n=o.n()).done;){var s=n.value,u=c.differ(e,v.getAngleOfHalfEdge(s),!1);u<i&&(i=u,r=s)}}catch(l){o.e(l)}finally{o.f()}return r}),Un=function(t,e,n){if(C["e"].Not.Null(t.incidentEdge)){var r=t.x,i=t.y,a=n.x,o=n.y,s=Math.atan2(o-i,a-r),u=zn(t,s),c=u.twin;e.previous=c,e.twin.next=c.next,c.next.previous=e.twin,c.next=e}e.origin=t,t.incidentEdge=e},Gn=function(t,e){var n,r=Object(I["a"])(v.Iterator.allHalfEdgeOfPath(t));try{for(r.s();!(n=r.n()).done;){var i=n.value;i.incidentFace=e}}catch(a){r.e(a)}finally{r.f()}},Kn=function(t,e){t.twin=e,e.twin=t,t.next=e,e.next=t,t.previous=e,e.previous=t},qn=function(t,e,n){var r=C["e"].isNull(t.incidentEdge)&&C["e"].isNull(e.incidentEdge),i=new v.Struct.HalfEdge,a=new v.Struct.HalfEdge;Kn(i,a),Un(t,i,e),Un(e,a,t);var o=r?v.getFaceOfPoint(n,t):i.previous.incidentFace||i.next.incidentFace,s=o.outerComponent,u=o.innerComponents;if(v.isTwinInSamePath(i)){i.incidentFace=a.incidentFace=o;var c=u.splice(0);v.isPathContainsHalfEdge(i,s)?o.outerComponent=i:u.push(i);var l,h=Object(I["a"])(c);try{for(h.s();!(l=h.n()).done;){var f=l.value;v.isPathContainsHalfEdge(i,f)||u.push(f)}}catch(k){h.e(k)}finally{h.f()}}else{var d=new v.Struct.Face,p=v.isOuterPath(a),g=v.isOuterPath(i),y=p?i:a,b=y.twin;Gn(b,d),y.incidentFace=o,d.outerComponent=b;var m=o.innerComponents.splice(0);g===p?o.outerComponent=y:o.innerComponents.push(y);var w,$=Object(I["a"])(m);try{for($.s();!(w=$.n()).done;){var O=w.value,x=O.origin;if(!v.isPathContainsVertex(y,x)&&!v.isPathContainsHalfEdge(b,O)){var j=v.getFaceOfPoint(d,x)?d:o;O.incidentFace!==j&&Gn(O,j),j.innerComponents.push(O)}}}catch(k){$.e(k)}finally{$.f()}}return i},Jn=function(t){t.incidentEdge=null,t.x=0,t.y=0},Qn=function(t){t.origin=null,t.twin=null,t.previous=null,t.next=null,t.incidentFace=null},Zn=function(t){return t.outerComponent=null,t.innerComponents.length=0,t},tr=function(t){var e=t.twin,n=t.previous,r=t.origin,i=null;return e===n?Jn(r):(n.next=r.incidentEdge=e.next,i=e.next.previous=n),i},er=function(t){var e=t.incidentFace,n=t.twin,r=v.isTwinInSamePath(t),i=v.isOuterPath(t),a=tr(t),o=tr(n);if(r){var s,u=e.innerComponents,c=u.splice(0),l=[a,o].filter(C["e"].Not.Null).filter((function(t){var n=v.isOuterPath(t);return n?e.outerComponent=t:u.push(t),!n})),h=Object(I["a"])(c);try{var f=function(){var e=s.value;e!==t&&e!==n&&l.every((function(t){return!v.isPathContainsHalfEdge(t,e)}))&&u.push(e)};for(h.s();!(s=h.n()).done;)f()}catch(x){h.e(x)}finally{h.f()}}else{var d,p,g=a.incidentFace,y=o.incidentFace;if(i?(d=y,p=g):(d=g,p=y),v.isOuterPath(a))d.outerComponent=a;else{var b=d.innerComponents,m=d.innerComponents.splice(0).concat(p.innerComponents);b.push(a);var w,$=Object(I["a"])(m);try{for($.s();!(w=$.n()).done;){var O=w.value;O===t||O===n||v.isPathContainsHalfEdge(a,O)||b.push(O)}}catch(x){$.e(x)}finally{$.f()}}Gn(a,d),Zn(p)}Qn(t),Qn(n)},nr=function(t){return v.getVertexHalfEdgeList(t).forEach(er),t.incidentEdge=null,t},rr=function(t){var e=t.incidentEdge.twin,n=e.next.twin,r=e.next.next,i=n.next.next;return Qn(e.twin),Qn(n.twin),Jn(t),e.twin=n,n.twin=e,e.next=r,n.next=i,r.previous=e,i.previous=n,e},ir=function(t){var e=t.incidentFace;if(e.outerComponent===t)e.outerComponent=t.next;else{var n=e.innerComponents,r=n.indexOf(t);-1!==r&&(n[r]=t.next)}},ar=function(t){var e=t.twin,n=t.origin,r=e.origin,i=v.hasOnlyHalfEdge(n),a=v.hasOnlyHalfEdge(r);ir(t),ir(e);var o=n;if(i)if(a)er(t);else{var s=[n.x,n.y];r.x=s[0],r.y=s[1],nr(n),o=r}else if(a)nr(r);else{var u,c=Object(I["a"])(v.Iterator.allHalfEdgeOfVertex(r));try{for(c.s();!(u=c.n()).done;){var l=u.value;l.origin=n}}catch(f){c.e(f)}finally{c.f()}n.incidentEdge=t.next,t.previous.next=t.next,t.next.previous=t.previous;var h=t.twin;h.previous.next=h.next,h.next.previous=h.previous,Qn(t),Qn(h),Jn(r)}return o},or="c",sr="d",ur="D",cr="Rg",lr="_D",hr="_Rg",fr=new WeakMap,dr=function(t){return fr.get(t)},vr=function(t,e,n,r,i){function a(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Object(R["a"])(this,a),fr.set(t,this),this[or]=e}return Object(A["a"])(a,[{key:t,get:function(){return C["e"].isNull(this[or])}},{key:e,value:function(){this[or]=null,this[lr]()}},{key:n,value:function(){this[hr]()}},{key:r,value:function(){}},{key:i,value:function(){}}]),a}(sr,ur,cr,lr,hr),pr=function(){function t(){Object(R["a"])(this,t)}return Object(A["a"])(t,[{key:"mesh",get:function(){var t=dr(this);return t[sr]?null:t[or].$}},{key:"destroyed",get:function(){return dr(this)[sr]}}]),t}(),gr="v",yr="F",br="H",mr="E",wr="M",$r="e",Or="v",xr="f",jr="g",kr="mv",Tr="mf",Er="mh",Sr="CV",Cr="M",Fr="L",Nr="S",Pr="G",Wr="C",Lr="LV",Hr="RV",Mr="RE",Ir="HV",Dr="HE",Rr="HF",Ar="TV",_r="TH",Br="TF",Vr="PF",Xr="AE",Yr="AV",zr="AF",Ur="F",Gr="FV",Kr="FE",qr="FF",Jr="l",Qr="VC",Zr="VD",ti="EC",ei="ED",ni="FC",ri="FD",ii="HC",ai="HD",oi="t",si="he",ui="v",ci="e",li="f",hi="n",fi="p",di="b",vi=new WeakMap,pi=function(t){return vi.get(t)},gi=function(t){return t[ci]},yi=function(t,e,n,r,i,a,o){Object(U["a"])(u,t);var s=Object(G["a"])(u);function u(t,e,n,r){var i;return Object(R["a"])(this,u),i=s.call(this,t,e),vi.set(t,Object(Z["a"])(i)),i.$=t,i[gr]=v.createVertex(n,r),i[cr](),i}return Object(A["a"])(u,[{key:e,value:function(){var t=this[or];t[Or].add(this),t[kr].set(this[gr],this)}},{key:n,value:function(){this[gr]=null}},{key:r,value:function(){return v.getVertexHalfEdgeList(this[gr]).map(this[or][_r])}},{key:i,value:function(){return this[br]().map(gi)}},{key:a,value:function(){var t,e=new Set,n=Object(I["a"])(v.Iterator.allHalfEdgeOfVertex(this[gr]));try{for(n.s();!(t=n.n()).done;){var r=t.value;e.add(r.incidentFace)}}catch(i){n.e(i)}finally{n.f()}return Array.from(e).map(this[or][Br])}},{key:o,value:function(t,e){this[gr].x=t,this[gr].y=e}}]),u}(vr,hr,lr,br,mr,yr,wr),bi=function(t){return t.$},mi=function(t){Object(U["a"])(n,t);var e=Object(G["a"])(n);function n(t,r,i){var a;return Object(R["a"])(this,n),a=e.call(this),new yi(Object(Z["a"])(a),t,r,i),Object.seal(Object(Z["a"])(a)),a}return Object(A["a"])(n,[{key:"x",get:function(){return pi(this)[gr].x}},{key:"y",get:function(){return pi(this)[gr].y}},{key:"move",value:function(t,e){return C["e"].Not.Number(t)&&C["a"].Throw.TypeError("Vertex.x MUST be a number."),C["e"].Not.Number(e)&&C["a"].Throw.TypeError("Vertex.y MUST be a number."),pi(this)[wr](t,e),this}},{key:"getFaceList",value:function(){return pi(this)[yr]().map(bi)}},{key:"getHalfEdgeList",value:function(){return pi(this)[br]().map(bi)}},{key:"getEdgeList",value:function(){return pi(this)[mr]().map(bi)}}]),n}(pr),wi="if",$i="af",Oi="iv",xi="av",ji="ih",ki="ah",Ti=new WeakMap,Ei=function(t){return Ti.get(t)},Si=function(t,e,n,r,i,a,o,s){Object(U["a"])(c,t);var u=Object(G["a"])(c);function c(t,e,n){var r;return Object(R["a"])(this,c),r=u.call(this,t,e),Ti.set(t,Object(Z["a"])(r)),r.$=t,r[ji]=n,n[ci]=n[di][ci]=Object(Z["a"])(r),r[cr](),r}return Object(A["a"])(c,[{key:e,value:function(){this[or][$r].add(this)}},{key:n,value:function(){this[ji]=null}},{key:r,get:function(){return this[ji][li]}},{key:i,get:function(){return this[ki][li]}},{key:a,get:function(){return this[ji][ui]}},{key:o,get:function(){return this[ki][ui]}},{key:s,get:function(){return this[ji][di]}}]),c}(vr,hr,lr,wi,$i,Oi,xi,ki),Ci=function(t){Object(U["a"])(n,t);var e=Object(G["a"])(n);function n(t,r){var i;return Object(R["a"])(this,n),i=e.call(this),new Si(Object(Z["a"])(i),t,r),Object.freeze(Object(Z["a"])(i)),i}return Object(A["a"])(n,[{key:"thisFace",get:function(){return Ei(this)[wi].$}},{key:"thatFace",get:function(){return Ei(this)[$i].$}},{key:"thisVertex",get:function(){return Ei(this)[Oi].$}},{key:"thatVertex",get:function(){return Ei(this)[xi].$}},{key:"thisHalfEdge",get:function(){return Ei(this)[ji].$}},{key:"thatHalfEdge",get:function(){return Ei(this)[ki].$}}]),n}(pr),Fi="f",Ni="H",Pi="C",Wi="O",Li="P",Hi=new WeakMap,Mi=function(t){return Hi.get(t)},Ii=function(t,e,n,r,i,a,o){Object(U["a"])(u,t);var s=Object(G["a"])(u);function u(t,e,n){var r;return Object(R["a"])(this,u),r=s.call(this,t,e),Hi.set(t,Object(Z["a"])(r)),r.$=t,r[Fi]=n,r}return Object(A["a"])(u,[{key:e,value:function(){var t=this[or];t[xr].add(this),t[Tr].set(this[Fi],this)}},{key:n,value:function(){this[Fi]=null}},{key:r,value:function(){return v.getPathOfHalfEdge(this[Fi].outerComponent)}},{key:i,value:function(){return this[Ni]().map(this[or][_r])}},{key:a,value:function(){return v.queryChildFaceList(this[Fi]).map(this[or][Br])}},{key:o,value:function(t,e){var n=v.getPolygonFromFaceOuter(this[Fi]);return h.containsPoint(n,{x:t,y:e})}}]),u}(vr,hr,lr,Ni,Wi,Pi,Li),Di=function(t){Object(U["a"])(n,t);var e=Object(G["a"])(n);function n(t,r){var i;return Object(R["a"])(this,n),i=e.call(this),new Ii(Object(Z["a"])(i),t,r),Object.freeze(Object(Z["a"])(i)),i}return Object(A["a"])(n,[{key:"getChildFaceList",value:function(){return Mi(this)[Pi]().map(bi)}},{key:"getOuterHalfEdgeList",value:function(){return Mi(this)[Wi]().map(bi)}},{key:"containsPoint",value:function(t,e){return Mi(this)[Li](t,e)}}]),n}(pr),Ri=function(t){return new Di(t,v.createGlobalFace())},Ai=new WeakMap,_i=function(t){return Ai.get(t)},Bi=function(t,e,n,r,i,a,o,s,u){Object(U["a"])(l,t);var c=Object(G["a"])(l);function l(t,e,n){var r;return Object(R["a"])(this,l),r=c.call(this,t,e),Ai.set(t,Object(Z["a"])(r)),r.$=t,r[si]=n,r[ci]=null,r[hr](),r}return Object(A["a"])(l,[{key:e,value:function(){this[or][Er].set(this[si],this)}},{key:n,value:function(){this[si]=null,this[ci]=null}},{key:r,get:function(){return this[si].twin}},{key:i,get:function(){return this[or][Ar](this[si].origin)}},{key:a,get:function(){return this[or][Br](this[si].incidentFace)}},{key:o,get:function(){return this[or][_r](this[si].next)}},{key:s,get:function(){return this[or][_r](this[si].previous)}},{key:u,get:function(){return this[or][_r](this[oi])}}]),l}(vr,hr,lr,oi,ui,li,hi,fi,di),Vi=function(t){Object(U["a"])(n,t);var e=Object(G["a"])(n);function n(t,r){var i;return Object(R["a"])(this,n),i=e.call(this),new Bi(Object(Z["a"])(i),t,r),Object.freeze(Object(Z["a"])(i)),i}return Object(A["a"])(n,[{key:"vertex",get:function(){return _i(this)[ui].$}},{key:"edge",get:function(){return _i(this)[ci].$}},{key:"face",get:function(){return _i(this)[li].$}},{key:"next",get:function(){return _i(this)[hi].$}},{key:"previous",get:function(){return _i(this)[fi].$}},{key:"back",get:function(){return _i(this)[di].$}}]),n}(pr),Xi=new WeakMap,Yi=function(t){return Xi.get(t)},zi=function(t,e,n,r,i,a,o,s,u,c,l,h,f,d,p,g,y,b,m,w){function $(t){var e;Object(R["a"])(this,$),Xi.set(t,this),this.$=t,this[$r]=new Set,this[Or]=new Set;var n=this[kr]=new Map,r=this[jr]=Mi(Ri(this));this[xr]=new Set;var i=this[Tr]=new Map,a=this[Er]=new Map;this[_r]=function(t){return a.get(t)};var o=r[Fi];this[Br]=function(t){return o===t?r:i.get(t)},this[Ar]=function(t){return n.get(t)},this[Jr]=(e={},Object(_["a"])(e,Qr,C["c"]),Object(_["a"])(e,Zr,C["c"]),Object(_["a"])(e,ti,C["c"]),Object(_["a"])(e,ei,C["c"]),Object(_["a"])(e,ni,C["c"]),Object(_["a"])(e,ri,C["c"]),Object(_["a"])(e,ii,C["c"]),Object(_["a"])(e,ai,C["c"]),e)}return Object(A["a"])($,[{key:t,value:function(t,e){var n=new mi(this,t,e);return this[Jr][Qr](n),n}},{key:e,value:function(t,e,n){t[wr](e,n)}},{key:n,value:function(t,e){var n=this[jr][Fi],r=t[gr],i=e[gr],a=qn(r,i,n),o=a.twin,s=a.incidentFace,u=o.incidentFace;if(s!==u){var c=this[Br](s)?u:s,l=new Di(this,c);Mi(l)[cr](),this[Jr][ni](l)}var h=new Vi(this,a),f=new Vi(this,o),d=new Ci(this,_i(h));return this[Jr][ii](h),this[Jr][ii](f),this[Jr][ti](d),d}},{key:r,value:function(t,e){var n=v.splitHalfEdgeByVertex(t[ji][si],e[gr]),r=t[ji][oi],i=new Vi(this,n),a=new Vi(this,r),o=new Ci(this,_i(i));return t[ki][ci]=t,this[Jr][ii](i),this[Jr][ii](a),this[Jr][ti](o),o}},{key:i,value:function(t){var e=t[gr],n=v.getVertexHalfEdgeList(e);2!==n.length&&C["a"].throwError("The MeshHalfEdge number of this MeshVertex is NOT 2.");var r=this[_r](e.incidentEdge.twin.next)[ci],i=this[_r](e.incidentEdge)[ci],a=this[_r](rr(e));a[di][ci]=i,i[ji]=a,r[ji]=n[0];var o,s=Object(I["a"])(n);try{for(s.s();!(o=s.n()).done;){var u=o.value;this[_r](u)[ci]=r}}catch(c){s.e(c)}finally{s.f()}return this[Kr](),this[kr].delete(t[gr]),this[Or].delete(t),this[Jr][Zr](t.$),i}},{key:a,value:function(t){var e=t[ji],n=e[si],r=ar(n);return this[Ur](),this[Ar](r)}},{key:o,value:function(t){nr(t[gr]),this[Kr](),this[qr]()}},{key:s,value:function(t){this[Lr](t),t[ur](),this[kr].delete(t[gr]),this[Or].delete(t),this[Jr][Zr](t.$)}},{key:u,value:function(t){er(t[ji][si]),this[Ur]()}},{key:c,value:function(t){return this[Or].has(t)}},{key:l,value:function(t){return this[$r].has(t)}},{key:h,value:function(t){return this[xr].has(t)}},{key:f,value:function(){return Array.from(this[$r])}},{key:d,value:function(){return Array.from(this[xr])}},{key:p,value:function(){return Array.from(this[Or])}},{key:g,value:function(t,e){var n=this[jr],r=n[Fi],i=v.getFaceOfPoint(r,{x:t,y:e});return i===r?n:this[Br](i)}},{key:y,value:function(){this[Gr](),this[Kr](),this[qr]()}},{key:b,value:function(){var t,e=this[kr],n=this[Or],r=[],i=Object(I["a"])(e);try{for(i.s();!(t=i.n()).done;){var a=Object(M["a"])(t.value,2),o=a[0],s=a[1];C["e"].isNull(o.incidentEdge)&&(n.delete(s),s[ur](),r.push(o),this[Jr][Zr](s.$))}}catch(h){i.e(h)}finally{i.f()}for(var u=0,c=r;u<c.length;u++){var l=c[u];e.delete(l)}}},{key:m,value:function(){var t,e=this[Er],n=this[$r],r=[],i=new Set,a=Object(I["a"])(e);try{for(a.s();!(t=a.n()).done;){var o=Object(M["a"])(t.value,2),s=o[0],u=o[1];if(C["e"].isNull(s.twin)){var c=u[ci];n.delete(c),c[ur](),u[ur](),r.push(s),i.add(c),this[Jr][ai](u.$)}}}catch(g){a.e(g)}finally{a.f()}for(var l=0,h=r;l<h.length;l++){var f=h[l];e.delete(f)}var d,v=Object(I["a"])(i);try{for(v.s();!(d=v.n()).done;){var p=d.value;this[Jr][ei](p.$)}}catch(g){v.e(g)}finally{v.f()}}},{key:w,value:function(){var t,e=this[Tr],n=this[xr],r=[],i=Object(I["a"])(e);try{for(i.s();!(t=i.n()).done;){var a=Object(M["a"])(t.value,2),o=a[0],s=a[1];C["e"].isNull(o.outerComponent)&&(n.delete(s),s[ur](),r.push(o),this[Jr][ri](s.$))}}catch(h){i.e(h)}finally{i.f()}for(var u=0,c=r;u<c.length;u++){var l=c[u];e.delete(l)}}}]),$}(Sr,Cr,Fr,Nr,Pr,Wr,Lr,Hr,Mr,Ir,Dr,Rr,Xr,zr,Yr,Vr,Ur,Gr,Kr,qr),Ui=function(){function t(){Object(R["a"])(this,t),new zi(this),C["d"].seal(this)}return Object(A["a"])(t,[{key:"globalFace",get:function(){return Yi(this)[jr].$}},{key:"createVertex",value:function(t,e){return C["e"].Not.Number(t)&&C["a"].throwError("The `x` MUST be a number."),C["e"].Not.Number(e)&&C["a"].throwError("The `y` MUST be a number."),Yi(this)[Sr](t,e)}},{key:"moveVertex",value:function(t,e,n){C["a"].instanceOf(t,mi)||C["a"].Throw.TypeError("The `vertex` MUST be a MeshVertex."),C["e"].Not.Number(e)&&C["a"].Throw.TypeError("Vertex.x MUST be a number."),C["e"].Not.Number(n)&&C["a"].Throw.TypeError("Vertex.y MUST be a number.");var r=Yi(this),i=pi(t);return r[Ir](i)||C["a"].throwError("The `vertex` does NOT belong to this mesh."),r[Cr](i,e,n)}},{key:"link",value:function(t,e){C["a"].instanceOf(t,mi)||C["a"].Throw.TypeError("The `thisVertex` MUST be a MeshVertex."),C["a"].instanceOf(e,mi)||C["a"].Throw.TypeError("The `thatVertex` MUST be a MeshVertex.");var n=Yi(this),r=pi(t),i=pi(e);return n[Ir](r)||C["a"].throwError("The `thisVertex` does NOT belong to this mesh."),n[Ir](i)||C["a"].throwError("The `thatVertex` does NOT belong to this mesh."),n[Fr](r,i)}},{key:"split",value:function(t,e){C["a"].instanceOf(t,Ci)||C["a"].Throw.TypeError("The `edge` MUST be a MeshEdge."),C["a"].instanceOf(e,mi)||C["a"].Throw.TypeError("The `vertex` MUST be a MeshVertex.");var n=Yi(this),r=Ei(t),i=pi(e);return n[Dr](r)||C["a"].throwError("The `edge` does NOT belong to this mesh."),n[Ir](i)||C["a"].throwError("The `vertex` does NOT belong to this mesh."),n[Nr](r,i)}},{key:"merge",value:function(t){C["a"].instanceOf(t,mi)||C["a"].Throw.TypeError("The `vertex` MUST be a MeshVertex.");var e=Yi(this)[Pr](pi(t));return C["e"].isNull(e)?null:e.$}},{key:"combine",value:function(t){C["a"].instanceOf(t,Ci)||C["a"].Throw.TypeError("The `edge` MUST be a MeshEdge.");var e=Yi(this)[Wr](Ei(t));return C["e"].isUndefined(e)?null:e.$}},{key:"clearVertex",value:function(t){C["a"].instanceOf(t,mi)||C["a"].Throw.TypeError("The `vertex` MUST be a MeshVertex.");var e=Yi(this),n=pi(t);e[Ir](n)||C["a"].throwError("The `vertex` does NOT belong to this mesh."),e[Lr](n)}},{key:"removeVertex",value:function(t){C["a"].instanceOf(t,mi)||C["a"].Throw.TypeError("The `vertex` MUST be a MeshVertex.");var e=Yi(this),n=pi(t);e[Ir](n)||C["a"].throwError("The `vertex` does NOT belong to this mesh."),e[Hr](n)}},{key:"removeEdge",value:function(t){C["a"].instanceOf(t,Ci)||C["a"].Throw.TypeError("The `edge` MUST be a MeshEdge.");var e=Yi(this),n=Ei(t);e[Dr](n)||C["a"].throwError("The `edge` does NOT belong to this mesh."),e[Mr](n)}},{key:"getAllVertexList",value:function(){return Yi(this)[Yr]().map(bi)}},{key:"getAllEdgeList",value:function(){return Yi(this)[Xr]().map(bi)}},{key:"getAllFaceList",value:function(){return Yi(this)[zr]().map(bi)}},{key:"hasVertex",value:function(t){return C["a"].instanceOf(t,mi)||C["a"].Throw.TypeError("The `vertex` MUST be a MeshVertex."),Yi(this)[Ir](pi(t))}},{key:"hasEdge",value:function(t){return C["a"].instanceOf(t,Ci)||C["a"].Throw.TypeError("The `edge` MUST be a MeshEdge."),Yi(this)[Dr](Ei(t))}},{key:"hasFace",value:function(t){return C["a"].instanceOf(t,Di)||C["a"].Throw.TypeError("The `face` MUST be a MeshFace."),Yi(this)[Rr](Mi(t))}},{key:"getFaceOfPoint",value:function(t,e){return C["e"].Not.Number(t)&&C["a"].Throw.TypeError("The `x` MUST be a number."),C["e"].Not.Number(e)&&C["a"].Throw.TypeError("The `y` MUST be a number."),Yi(this)[Vr](t,e).$}},{key:"flush",value:function(){Yi(this)[Ur]()}},{key:"flushVertex",value:function(){Yi(this)[Gr]()}}]),t}(),Gi=function(){var t=Object(M["a"])(qi[Ki],2),e=t[0],n=t[1];C["d"].defineProperty(Ui.prototype,e,{get:function(){return Yi(this)[Jr][n]},set:function(t){C["e"].Not.Function(t)&&C["a"].Throw.TypeError("listener MUST be a function."),Yi(this)[Jr][n]=t}})},Ki=0,qi=[["onVertexCreate",Qr],["onVertexDestroy",Zr],["onEdgeCreate",ti],["onEdgeDestroy",ei],["onFaceCreate",ni],["onFaceDestroy",ri],["onHalfEdgeCreate",ii],["onHalfEdgeDestroy",ai]];Ki<qi.length;Ki++)Gi();var Ji=new WeakMap,Qi=function(t){return Ji.get(t)},Zi=function(t){Object(U["a"])(n,t);var e=Object(G["a"])(n);function n(t){var r;return Object(R["a"])(this,n),r=e.call(this,t),Ji.set(Object(Z["a"])(r),t),C["d"].freeze(Object(Z["a"])(r)),r}return Object(A["a"])(n,[{key:"x",get:function(){return Qi(this).x}},{key:"y",get:function(){return Qi(this).y}},{key:"move",value:function(t,e){return r.Point(t,e),Qi(this).move(t,e),this}},{key:"remove",value:function(){return Qi(this).remove(),this}},{key:"getAdjacentCornerList",value:function(){return Qi(this).getAdjacentCornerList().map(ta)}}]),n}(i.Element),ta=function(t){return t.$proxy},ea=new WeakMap,na=function(t){return ea.get(t)},ra=function(t){Object(U["a"])(n,t);var e=Object(G["a"])(n);function n(t){var r;return Object(R["a"])(this,n),r=e.call(this,t),ea.set(Object(Z["a"])(r),t),C["d"].freeze(Object(Z["a"])(r)),r}return Object(A["a"])(n,[{key:"thickness",get:function(){return na(this).$state.thickness}},{key:"thisSurface",get:function(){return na(this).thisSurface.$proxy}},{key:"thatSurface",get:function(){return na(this).thatSurface.$proxy}},{key:"setThickness",value:function(t){(C["e"].Not.Number(t)||t<=0)&&C["a"].Throw.TypeError("Invalid `thickness`, a number >0 expected."),na(this).setThickness(t)}},{key:"remove",value:function(){na(this).remove()}}]),n}(i.Element),ia=new WeakMap,aa=function(t){return ia.get(t)},oa=function(t){Object(U["a"])(n,t);var e=Object(G["a"])(n);function n(t){var r;return Object(R["a"])(this,n),r=e.call(this,t),ia.set(Object(Z["a"])(r),t),C["d"].freeze(Object(Z["a"])(r)),r}return Object(A["a"])(n,[{key:"getOptions",value:function(){return aa(this).$data.optionsGetter}},{key:"createCorner",value:function(t,e){return r.Point(t,e),aa(this).createCorner(t,e).$proxy}},{key:"removeCorner",value:function(t){return C["a"].instanceOf(t,Zi)||C["a"].Throw.TypeError("Invalid `corner`, a CornerProxy expected."),aa(this).removeCorner(Qi(t))}},{key:"createWall",value:function(t,e){return ca(t,e),aa(this).createWall(Qi(t),Qi(e)).$proxy}},{key:"removeWall",value:function(t){return C["a"].instanceOf(t,ra)||C["a"].Throw.TypeError("Invalid `wall`, a WallProxy expected."),aa(this).removeWall(na(t))}},{key:"split",value:function(t,e,n){return r.Point(e,n),C["a"].instanceOf(t,ra)||C["a"].Throw.TypeError("Invalid `wall`, a WallProxy expected."),aa(this).split(na(t),e,n).$proxy}},{key:"merge",value:function(t){C["a"].instanceOf(t,Zi)||C["a"].Throw.TypeError("Invalid `corner`, a CornerProxy expected.");var e=Qi(t);return 2!==e.length&&C["a"].throwError("The Wall number of this Corner is NOT 2."),aa(this).merge(e).$proxy}},{key:"combine",value:function(t){C["a"].instanceOf(t,ra)||C["a"].Throw.TypeError("Invalid `wall`, a WallProxy expected.");var e=na(t);return aa(this).combine(e).$proxy}},{key:"removeRoom",value:function(){}},{key:"getAllWallList",value:function(){return aa(this).$getElementList("Wall").map(sa)}},{key:"getAllRoomList",value:function(){return aa(this).$getElementList("Room").map(sa)}},{key:"getRoomByPoint",value:function(t,e){r.Point(t,e);var n=aa(this).getRoomOfPoint(t,e);return n?n.$proxy:null}},{key:"queryCorner",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;r.Point(t,e),(C["e"].Not.Number(n)||n<=0)&&C["a"].Throw.TypeError("Invalid `range`, a number >0 expected.");var i=aa(this).queryCorner(t,e,n);return C["e"].isNull(i)?null:i.$proxy}},{key:"mergeAll",value:function(){}},{key:"clearEmplyCorner",value:function(){}}]),n}(i.Plugin),sa=function(t){return t.$proxy},ua=["from","to"],ca=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r in ua)C["a"].instanceOf(e[r],Zi)||C["a"].Throw.TypeError("Invalid `".concat(ua[r],"`, a CornerProxy excepted."))},la=Bn({data:function(){return{mesh:new Ui,vertexToCorner:new Map,edgeToWall:new Map,faceToRoom:new Map,halfEdgeToSurface:new Map}},created:function(){var t=this,e=this.$data,n=e.mesh,r=e.vertexToCorner,i=e.edgeToWall,a=e.halfEdgeToSurface,o=e.faceToRoom;n.onFaceCreate=function(e){t.$createElement("Room",e)},n.onEdgeCreate=function(e){t.$createElement("Wall",e)},n.onVertexCreate=function(e){t.$createElement("Corner",e)},n.onHalfEdgeCreate=function(e){t.$createElement("Surface",e)},n.onFaceDestroy=function(t){o.get(t).$destroy(),o.delete(t)},n.onVertexDestroy=function(t){r.get(t).$destroy(),r.delete(t)},n.onEdgeDestroy=function(t){i.get(t).$destroy(),i.delete(t)},n.onHalfEdgeDestroy=function(t){a.get(t).$destroy(),a.delete(t)},this.$on("element-created",(function(e,n){t.$emit("".concat(n.toLowerCase(),"-created"),e)}));var s=this,c=s.$options.snap;this.$drawing.registerSnap({name:"structure-corner",get priority(){return c.corner.priority},get active(){return c.corner.active},handle:function(t,e,n){var i,a=Object(I["a"])(r);try{for(a.s();!(i=a.n()).done;){var o=Object(M["a"])(i.value,1),l=o[0],h=s.$toCanvas(l.x,l.y),f=u.distanceToPoint.apply(u,[t,e].concat(Object(B["a"])(h)));if(f<c.corner.maxDistance)return n.apply(void 0,Object(B["a"])(h))}}catch(d){a.e(d)}finally{a.f()}}})},methods:{assertNoCornerAt:function(t,e){this.queryCorner(t,e)&&C["a"].throwError("It could NOT create a new `Corner` in same place")},createCorner:function(t,e){this.assertNoCornerAt(t,e);var n=this.$data,r=n.mesh,i=n.vertexToCorner;return i.get(r.createVertex(t,e))},removeCorner:function(t){return t.remove()},createWall:function(t,e){var n=this.$data,r=n.mesh,i=n.edgeToWall;return i.get(r.link(t.vertex,e.vertex))},removeWall:function(t){t.remove()},split:function(t,e,n){this.assertNoCornerAt(e,n);var r=t.thisSurface.corner,i=t.thatSurface.corner,a=this.$data,o=a.mesh,s=a.edgeToWall,u=this.createCorner(e,n),c=o.split(t.$state.edge,u.vertex);return r.updateSurface(),i.updateSurface(),s.get(c)},merge:function(t){var e=this.$data,n=e.mesh,r=e.edgeToWall,i=n.merge(t.$state.vertex),a=r.get(i);return a.thisSurface.corner.updateSurface(),a.thatSurface.corner.updateSurface(),a},combine:function(t){var e=this.$data,n=e.mesh,r=e.vertexToCorner,i=n.combine(t.$state.edge),a=r.get(i);return a.updateAllSiblingSurface(),a},queryCorner:function(t,e){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=Object(I["a"])(this.$data.vertexToCorner);try{for(i.s();!(n=i.n()).done;){var a=Object(M["a"])(n.value,2),s=a[0],u=a[1],c=o.fromTwoPoint(s.x,s.y,t,e);if(o.getLength.apply(o,Object(B["a"])(c))<r)return u}}catch(l){i.e(l)}finally{i.f()}return null},queryWall:function(t,e){},getRoomOfPoint:function(t,e){var n=this.$data,r=n.mesh,i=n.faceToRoom;return i.get(r.getFaceOfPoint(t,e))}},proxy:function(){return new oa(this)},options:function(t){return t({show:!0},{snap:t({},{corner:t({active:!0,priority:0,maxDistance:40})}),corner:t({show:!0,render:null},{style:t({color:16777215,opacity:.4,radius:ha(5)})}),wall:t({show:!0},{style:t({opacity:1,color:10066329,hoverColor:13421772}),midline:t({show:!0,color:16711680,width:1})}),room:t({show:!0,defaultTexture:null}),surface:t({opacity:1,borderColor:0,borderWidth:2})})}}),ha=function(t){return{value:t,set:function(){this.$forceUpdate()}}},fa=function(t,e,n,r,i){var a=o.fromTwoPoint(t,e,n,r),s=o.normalize.apply(o,Object(B["a"])(a)),u=o.rotate90.apply(o,Object(B["a"])(s)),c=o.multiply.apply(o,Object(B["a"])(u).concat([i]));return o.clone(c)},da=function(t){return[t.x,t.y]},va=function(t){return t.back.vertex},pa=function(t){return t.updateSurface()};function ga(t){return this.get(t)}var ya=Vn({groupIndex:1e3,interative:!0,render:function(t){var e=this.$plugin.$options.corner.style,n=e.color,r=e.opacity,i=e.radius,a=this.$state.vertex,o=a.x,s=a.y,u=this.$toCanvas(o,s),c=Object(M["a"])(u,2),l=c[0],h=c[1];t.beginFill(n,r).drawCircle(0,0,i).endFill(),t.x=l,t.y=h},created:function(t){this.$data.vertexToCorner.set(this.$state.vertex=t,this)},state:function(){return{vertex:null}},getters:{x:function(){return this.vertex.x},y:function(){return this.vertex.y},vertex:function(){return this.$state.vertex},length:function(){return 2}},methods:{move:function(t,e){var n=this.$plugin.queryCorner(t,e);C["e"].Not.Null(n)&&n!==this&&C["a"].throwError("It could NOT move the Corner to the same <".concat(t,", ").concat(e,"> place.")),this.$state.vertex.move(t,e),this.updateAllSiblingSurface(),this.$setDirty()},remove:function(){var t=this.$state.vertex,e=this.$data,n=e.mesh,r=e.vertexToCorner,i=t.getHalfEdgeList().map(va).map(ga,r);n.removeVertex(t);var a,o=Object(I["a"])(i);try{for(o.s();!(a=o.n()).done;){var s=a.value;s.updateSurface()}}catch(u){o.e(u)}finally{o.f()}return this},getAdjacentCornerList:function(){return this.$state.vertex.getHalfEdgeList().map(va).map(ga,this.$data.vertexToCorner)},updateAllSiblingSurface:function(){this.getAdjacentCornerList().concat([this]).forEach(pa)},updateSurface:function(){var t=this.$data,e=t.edgeToWall,n=t.halfEdgeToSurface,r=this.$state.vertex,i=r.getHalfEdgeList(),a=i.length;for(var c in i){var h=i[(c+a-1)%a],f=i[c],d=e.get(h.edge),v=e.get(f.edge),p=f.vertex,g=f.next,y=f.previous,b=da(y.vertex),m=da(p),w=da(g.vertex),$=fa.apply(void 0,Object(B["a"])(b).concat(Object(B["a"])(m),[d.$state.thickness/2])),O=fa.apply(void 0,Object(B["a"])(m).concat(Object(B["a"])(w),[v.$state.thickness/2])),x=o.clone(u.translate.apply(u,Object(B["a"])(m).concat(Object(B["a"])($)))),j=o.clone(u.translate.apply(u,Object(B["a"])(m).concat(Object(B["a"])(O)))),k=[].concat(Object(B["a"])(u.translate.apply(u,Object(B["a"])(b).concat(Object(B["a"])($)))),Object(B["a"])(x)),T=[].concat(Object(B["a"])(j),Object(B["a"])(u.translate.apply(u,Object(B["a"])(w).concat(Object(B["a"])(O))))),E=l.intersectSegment.apply(l,Object(B["a"])(k).concat(Object(B["a"])(T))),S=n.get(f),F=n.get(y);if(C["e"].isNull(E)){var N=s.intersectLine.apply(s,Object(B["a"])(x).concat(Object(B["a"])($),Object(B["a"])(j),Object(B["a"])(O)));C["e"].isNull(N)?(F.setTarget.apply(F,Object(B["a"])(x)),S.setOrigin.apply(S,Object(B["a"])(j))):(F.setTarget.apply(F,Object(B["a"])(N)),S.setOrigin.apply(S,Object(B["a"])(N)))}else F.setTarget.apply(F,Object(B["a"])(E)),S.setOrigin.apply(S,Object(B["a"])(E));v.$setDirty()}}},proxy:function(){return new Zi(this)}},la),ba=Vn({groupIndex:900,interative:!0,selectable:!0,hoverable:!0,render:function(t){var e,n,r,i=this.$plugin.$options.wall,a=i.midline,o=i.style,s=o.color,u=o.hoverColor,c=this.$state.edge,l=c.thisVertex,h=c.thatVertex,f=[l.x,l.y],d=[h.x,h.y],v=this.thisSurface,p=this.thatSurface;((e=t.beginFill(this.$hovering?u:s)).drawPolygon.apply(e,Object(B["a"])(this.$toCanvas.apply(this,f)).concat(Object(B["a"])(this.$toCanvas.apply(this,Object(B["a"])(v.origin))),Object(B["a"])(this.$toCanvas.apply(this,Object(B["a"])(v.target))),Object(B["a"])(this.$toCanvas.apply(this,d)),Object(B["a"])(this.$toCanvas.apply(this,Object(B["a"])(p.origin))),Object(B["a"])(this.$toCanvas.apply(this,Object(B["a"])(p.target))))).endFill(),a.show)&&(n=(r=t.lineStyle(a.width,a.color)).moveTo.apply(r,Object(B["a"])(this.$toCanvas.apply(this,f)))).lineTo.apply(n,Object(B["a"])(this.$toCanvas.apply(this,d)))},created:function(t){var e=this,n=t.thisVertex,r=t.thatVertex,i=this.$data,a=i.edgeToWall,o=i.vertexToCorner;a.set(this.$state.edge=t,this),o.get(n).updateSurface(),o.get(r).updateSurface(),this.$on("dirty",(function(){var t=e.thisSurface,n=e.thatSurface,r=t.room,i=n.room;C["e"].Not.Null(r)&&r.$setDirty(),C["e"].Not.Null(i)&&i.$setDirty(),t.emitChange(),n.emitChange()}))},state:function(){return{type:0,thickness:300,edge:null}},getters:{thisSurface:function(){return this.$data.halfEdgeToSurface.get(this.$state.edge.thisHalfEdge)},thatSurface:function(){return this.$data.halfEdgeToSurface.get(this.$state.edge.thatHalfEdge)}},methods:{setThickness:function(t){this.$state.thickness=t,this.thisSurface.corner.updateSurface(),this.thatSurface.corner.updateSurface(),this.$setDirty()},remove:function(){var t=this.thisSurface.corner,e=this.thatSurface.corner;return this.$data.mesh.removeEdge(this.$state.edge),t.updateSurface(),e.updateSurface(),this.$proxy}},proxy:function(){return new ra(this)}},la),ma=new WeakMap,wa=function(t){return ma.get(t)},$a=function(t){Object(U["a"])(n,t);var e=Object(G["a"])(n);function n(t){var r;return Object(R["a"])(this,n),r=e.call(this,t),ma.set(Object(Z["a"])(r),t),Object.freeze(Object(Z["a"])(r)),r}return Object(A["a"])(n,[{key:"back",get:function(){return wa(this).back.$proxy}},{key:"previous",get:function(){return wa(this).previous.$proxy}},{key:"next",get:function(){return wa(this).next.$proxy}},{key:"corner",get:function(){return wa(this).corner.$proxy}},{key:"wall",get:function(){return wa(this).wall.$proxy}},{key:"room",get:function(){return wa(this).room.$proxy}},{key:"origin",get:function(){return wa(this).origin}},{key:"target",get:function(){return wa(this).target}},{key:"originSafe",get:function(){return this.origin.slice(0)}},{key:"targetSafe",get:function(){return this.target.slice(0)}}]),n}(i.Element),Oa=function(t,e,n){n[0]=t,n[1]=e},xa=Vn({groupIndex:920,state:function(){return{halfEdge:null,origin:[0,0],target:[0,0]}},render:function(t){var e,n,r,i=this.$state,a=i.origin,o=i.target;(e=(n=(r=t.lineStyle(1.5,2236962)).moveTo.apply(r,Object(B["a"])(this.$toCanvas.apply(this,Object(B["a"])(a))))).lineTo.apply(n,Object(B["a"])(this.$toCanvas.apply(this,Object(B["a"])(o))))).lineTo.apply(e,Object(B["a"])(this.$toCanvas.apply(this,Object(B["a"])(this.next.origin))))},created:function(t){this.$data.halfEdgeToSurface.set(this.$state.halfEdge=t,this)},getters:{next:function(){return this.$data.halfEdgeToSurface.get(this.$state.halfEdge.next)},previous:function(){return this.$data.halfEdgeToSurface.get(this.$state.halfEdge.previous)},back:function(){return this.$data.halfEdgeToSurface.get(this.$state.halfEdge.back)},corner:function(){return this.$data.vertexToCorner.get(this.$state.halfEdge.vertex)},wall:function(){return this.$data.edgeToWall.get(this.$state.halfEdge.edge)},room:function(){var t=this.$state.halfEdge.face,e=this.$data.faceToRoom.get(t);return C["e"].isUndefined(e)?null:e},origin:function(){return this.$state.origin},target:function(){return this.$state.target}},methods:{setOrigin:function(t,e){return Oa(t,e,this.$state.origin),this.$setDirty(),this},setTarget:function(t,e){return Oa(t,e,this.$state.target),this.$setDirty(),this},emitChange:function(){this.$emit("change")}},proxy:function(){return new $a(this)}},la),ja=n("7580"),ka=new WeakMap,Ta=function(t){return ka.get(t)},Ea=function(t){Object(U["a"])(n,t);var e=Object(G["a"])(n);function n(t){var r;return Object(R["a"])(this,n),r=e.call(this,t),ka.set(Object(Z["a"])(r),t),Object.freeze(Object(Z["a"])(r)),r}return Object(A["a"])(n,[{key:"area",get:function(){return 0}},{key:"bounds",get:function(){return Ta(this).$getBounds()}},{key:"setFloor",value:function(t){return Ta(this).setFloor(t)}},{key:"getOuterSurfaceList",value:function(){return Ta(this).getOuterSurfaceList()}}]),n}(i.Element),Sa=S;function Ca(t){return this.get(t)}var Fa=Vn({groupIndex:800,interative:!0,selectable:!0,hoverable:!0,render:function(t){var e,n=[],r=this.$drawing,i=r.origin,a=r.scale,o=this.$state.face.getOuterHalfEdgeList().map(Ca,this.$data.halfEdgeToSurface),s=Object(I["a"])(o);try{for(s.s();!(e=s.n()).done;){var u=e.value;n.push.apply(n,Object(B["a"])(this.$toCanvas.apply(this,Object(B["a"])(u.origin))).concat(Object(B["a"])(this.$toCanvas.apply(this,Object(B["a"])(u.target)))))}}catch(c){s.e(c)}finally{s.f()}this.$plugin.$options.room.show&&(this.$state.floor&&t.beginTextureFill({texture:this.$state.floor,matrix:Object(Ye["a"])(Sa.Matrix,[5/a,0,0,5/a].concat(Object(B["a"])(i)))}),t.drawPolygon(n).endFill())},state:function(){return{face:null,floor:null}},created:function(t){this.$data.faceToRoom.set(this.$state.face=t,this)},methods:{setFloor:function(t){var e=this;return Object(ja["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,Sa.Texture.fromURL(t);case 2:e.$state.floor=n.sent,e.$setDirty();case 4:case"end":return n.stop()}}),n)})))()},getOuterSurfaceList:function(){var t=this.$data.halfEdgeToSurface,e=this.$state.face;return e.getOuterHalfEdgeList().map((function(e){return t.get(e).$proxy}))}},proxy:function(){return new Ea(this)}},la),Na="com.3dnest.spoke.structure",Pa="structure",Wa=Xn({id:Na,namespace:Pa,version:Yn["a"],plugin:la,elements:{Corner:ya,Wall:ba,Surface:xa,Room:Fa}}),La=n("f8cf"),Ha=new WeakMap,Ma=function(t){return Ha.get(t)},Ia=function(t){Object(U["a"])(n,t);var e=Object(G["a"])(n);function n(t){var r;return Object(R["a"])(this,n),r=e.call(this,t),Ha.set(Object(Z["a"])(r),t),Object.freeze(Object(Z["a"])(r)),r}return Object(A["a"])(n,[{key:"createHollow",value:function(t,e,n){return Ma(this).createHollow(t,e,n)}}]),n}(Rn),Da=Bn({methods:{createHollow:function(t,e,n){return this.$createElement("Hollow",t,e,n)}},proxy:function(){return new Ia(this)}}),Ra={},Aa=function(t,e){C["e"].Not.String(t)&&C["a"].Throw.TypeError("Invalid `name`, a string expected."),C["e"].Not.Function(e.render)&&C["a"].Throw.TypeError("Invalid `material`, a function expected."),t in Ra&&console.warn('Duplicated material name="'.concat(t,'". The original is replaced.')),Ra[t]=e},_a=function(t){return Ra[t]},Ba=new WeakMap,Va=function(t){return Ba.get(t)},Xa=function(t){Object(U["a"])(n,t);var e=Object(G["a"])(n);function n(t){var r;return Object(R["a"])(this,n),r=e.call(this,t),Ba.set(Object(Z["a"])(r),t),Object.freeze(Object(Z["a"])(r)),r}return Object(A["a"])(n,[{key:"name",get:function(){return Va(this).name}},{key:"surface",get:function(){return Va(this).surface}},{key:"width",get:function(){return Va(this).width}},{key:"offset",get:function(){return Va(this).offset}},{key:"materialName",get:function(){return Va(this).materialName}},{key:"flip",value:function(){Va(this).flip()}},{key:"toggleSurface",value:function(){Va(this).toggleSurface()}},{key:"setSurface",value:function(t){Va(this).setSurface(t)}},{key:"setMaterial",value:function(t){Va(this).setMaterial(t)}},{key:"setOffset",value:function(t){Va(this).setOffset(t)}},{key:"setWidth",value:function(t){Va(this).setWidth(t)}},{key:"remove",value:function(){Va(this).remove()}}]),n}(Ln),Ya=Vn({groupIndex:1100,interative:!0,hoverable:!0,focusable:!0,draggable:!0,state:function(){return{name:"Hollow",surface:null,offset:0,materialName:"",fliped:!1,width:0,listener:C["c"]}},getters:{name:function(){return this.$state.name},surface:function(){return this.$state.surface},width:function(){return this.$state.width},offset:function(){return this.$state.offset},materialName:function(){return this.$state.materialName}},created:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.$state.listener=function(){return n.$setDirty()},this.setMaterial(t),this.setSurface(e),this.setOffset(r),this.setWidth(_a(t).width)},destroy:function(){var t=this.$state.surface;t.off&&t.off("change",this.$state.listener)},render:function(t){var e=this.$state,n=e.surface,r=e.width,i=e.fliped,a=e.offset,s=e.materialName,c=this.$drawing.scale,l=n.corner,h=n.back.corner,f={width:r/c,height:n.wall.thickness/c,fliped:i,scale:c,hover:this.$hovering,focus:this.$focusing,hold:this.$holding};_a(s).render(t,f);var d=this.$toCanvas(l.x,l.y),v=this.$toCanvas(h.x,h.y),p=o.normalize.apply(o,Object(B["a"])(o.fromTwoPoint.apply(o,Object(B["a"])(d).concat(Object(B["a"])(v))))),g=Object(M["a"])(p,2),y=g[0],b=g[1],m=u.translate.apply(u,Object(B["a"])(d).concat(Object(B["a"])(o.multiply(y,b,a/c)))),w=Object(M["a"])(m,2);t.x=w[0],t.y=w[1],t.rotation=C["b"].atan2(b,y)},methods:{flip:function(){this.$state.fliped=!this.$state.fliped,this.$setDirty()},toggleSurface:function(){var t=this.$state.surface.corner,e=this.$state.surface.back.corner,n=o.getLength.apply(o,Object(B["a"])(o.fromTwoPoint(t.x,t.y,e.x,e.y)));this.setOffset(n-this.$state.offset),this.setSurface(this.$state.surface.back)},setSurface:function(t){var e=this.$state.surface;e&&e.off&&this.$state.surface.off("change",this.$state.listener),t&&t.on&&t.on("change",this.$state.listener),this.$state.surface=t,this.$setDirty()},setMaterial:function(t){this.$state.materialName=t,this.$setDirty()},setOffset:function(t){this.$state.offset=t,this.$setDirty()},setWidth:function(t){this.$state.width=t,this.$setDirty()},remove:function(){this.$destroy()}},proxy:function(){return new Xa(this)}},Da),za={id:"com.3dnest.spoke.wall",namespace:"wall",version:La["a"],plugin:Da,elements:{Hollow:Ya}},Ua=new WeakMap,Ga=function(t){return Ua.get(t)},Ka=function(t){Object(U["a"])(n,t);var e=Object(G["a"])(n);function n(t){var r;return Object(R["a"])(this,n),r=e.call(this,t),Ua.set(Object(Z["a"])(r),t),Object.freeze(Object(Z["a"])(r)),r}return Object(A["a"])(n,[{key:"createFurniture",value:function(t,e,n,r,i,a){return Ga(this).createFurniture(t,e,n,r,i,a)}}]),n}(Rn),qa=Bn({methods:{createFurniture:function(t,e,n,r,i,a){return this.$createElement("Furniture",t,e,n,r,i,a)}},proxy:function(){return new Ka(this)}}),Ja=(n("cb29"),{}),Qa=function(t,e){C["e"].Not.String(t)&&C["a"].Throw.TypeError("Invalid `name`, a string expected."),C["e"].Not.Function(e)&&C["a"].Throw.TypeError("Invalid `material`, a function expected."),t in Ja&&Ce["c"].Console.warn('Duplicated material name="'.concat(t,'". The original is replaced.')),Ja[t]=e},Za=function(){var t=Object(ja["a"])(regeneratorRuntime.mark((function t(e,n){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,S.Texture.fromURL(n);case 2:r=t.sent,Qa(e,(function(t,e){var n=e.width,i=e.height,a=n>0?n:r.width,o=i>0?i:r.height;t.beginTextureFill({texture:r,matrix:new S.Matrix(a/r.width,0,0,o/r.height,0,0)}).drawRect(0,0,a,o)}));case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),to=function(t){return t in Ja||Ce["c"].Console.warn('material name="'.concat(t,'" is not exist.')),Ja[t]},eo=new WeakMap,no=function(t){return eo.get(t)},ro=function(t){Object(U["a"])(n,t);var e=Object(G["a"])(n);function n(t){var r;return Object(R["a"])(this,n),r=e.call(this,t),eo.set(Object(Z["a"])(r),t),Object.freeze(Object(Z["a"])(r)),r}return Object(A["a"])(n,[{key:"width",get:function(){return no(this).width}},{key:"height",get:function(){return no(this).height}},{key:"rotation",get:function(){return no(this).rotation}},{key:"x",get:function(){return no(this).x}},{key:"y",get:function(){return no(this).y}},{key:"room",get:function(){return no(this).room}},{key:"setFill",value:function(t){no(this).setFill(t)}},{key:"setRoom",value:function(t){no(this).setRoom(t)}},{key:"setWidth",value:function(t){no(this).setWidth(t)}},{key:"setHeight",value:function(t){no(this).setHeight(t)}},{key:"setOffset",value:function(t,e){no(this).setOffet(t,e)}},{key:"setRotation",value:function(t){no(this).setRotation(t)}},{key:"setPosition",value:function(t,e){no(this).setPosition(t,e)}},{key:"remove",value:function(){no(this).remove()}}]),n}(Ln),io=Vn({groupIndex:1200,interative:!0,hoverable:!0,focusable:!0,draggable:!0,state:function(){return{fill:"",width:0,height:0,room:null,offsetX:0,offsetY:0,x:0,y:0,rotation:0,listener:C["c"]}},getters:{width:function(){return this.$state.width},height:function(){return this.$state.height},rotation:function(){return this.$state.rotation},x:function(){return this.$state.x},y:function(){return this.$state.y},room:function(){return this.$state.room}},created:function(t,e,n,r,i,a){this.setRoom(a),this.setWidth(t),this.setHeight(e),this.setFill(i),this.setPosition(n,r)},destroy:function(){var t=this.$state.room;t&&t.off&&t.off("dirty",this.$state.listener)},render:function(t){var e=this.$state,n=e.width,r=e.height,i=e.rotation,a=e.fill,o=this.$drawing.scale,s={width:n/o,height:r/o};t.drawRect(0,0,s.width,s.height),t.pivot.x=s.width/2,t.pivot.y=s.height/2;var u=to(a);u&&u(t,s);var c=this.$toCanvas(this.$state.x,this.$state.y),l=Object(M["a"])(c,2);t.x=l[0],t.y=l[1],t.rotation=i},methods:{setFill:function(t){this.$state.fill=t,this.$setDirty()},setRoom:function(t){var e=this;t!==this.$state.room&&(t?(this.$state.room=t,t.on("dirty",this.$state.listener=function(){return e.$setDirty()}),this.$setDirty()):this.$state.room=null)},setWidth:function(t){this.$state.width=t,this.$setDirty()},setHeight:function(t){this.$state.height=t,this.$setDirty()},setRotation:function(t){this.$state.rotation=t,this.$setDirty()},setPosition:function(t,e){var n=this.$state.room,r=n?this.$toGeometry(n.bounds.left,n.bounds.bottom):[0,0],i=Object(M["a"])(r,2),a=i[0],o=i[1];this.$state.x=t,this.$state.y=e,this.$state.offsetX=t-a,this.$state.offsetY=e-o,this.$setDirty()},setOffset:function(t,e){var n=this.$state.room,r=n?this.$toGeometry(n.bounds.left,n.bounds.bottom):[0,0],i=Object(M["a"])(r,2),a=i[0],o=i[1];this.$state.offsetX=t,this.$state.offsetY=e;var s=[a+t,o+e];this.$state.x=s[0],this.$state.y=s[1],this.$setDirty()},remove:function(){this.$destroy()}},proxy:function(){return new ro(this)}},qa),ao=n("9acd"),oo=Xn({id:"com.3dnest.spoke.room",namespace:"room",version:ao["a"],plugin:qa,elements:{Furniture:io}}),so=n("6271"),uo=new WeakMap,co=function(t){return uo.get(t)},lo=function(){function t(e){Object(R["a"])(this,t),uo.set(this,e),C["d"].freeze(this)}return Object(A["a"])(t,[{key:"show",value:function(){co(this).setShowing(!0)}},{key:"hide",value:function(){co(this).setShowing(!1)}}]),t}(),ho=Bn({data:function(){return{showing:!1,layerList:[]}},created:function(){var t=this.$createElement("RectangularGrid");this.$data.layerList.push(t)},methods:{setShowing:function(t){this.$data.showing=t,this.$forceUpdate()}},proxy:function(){return new lo(this)}}),fo=(n("6b93"),n("7db0"),new WeakMap),vo=Object(A["a"])((function t(e){Object(R["a"])(this,t),fo.set(this,e),C["d"].freeze(this)})),po=[5,2,1],go=50;function yo(t){return this>=t}var bo=function(t){var e=go*t,n=C["b"].pow(10,C["b"].floor(C["b"].log10(e)));return po.find(yo,C["b"].round(e/n))*n},mo=function(t,e,n){return t.moveTo(0,e).lineTo(n,e)},wo=function(t,e,n){return t.moveTo(e,0).lineTo(e,n)},$o=Vn({groupIndex:0,state:function(){return{active:!0}},render:function(t){var e=this.$drawing,n=e.width,r=e.height,i=e.scale,a=e.origin,o=Object(M["a"])(a,2),s=o[0],u=o[1],c=bo(i),l=function(t){return c*t/i};t.lineStyle(1,255,1,0);var h=0,f=0;for(h=1;(f=l(h))<s;h++)wo(t,C["b"].round(s-f),r);for(h=1;(f=l(h))<n-s;h++)wo(t,C["b"].round(s+f),r);for(h=1;(f=l(h))<u;h++)mo(t,C["b"].round(u-f),n);for(h=1;(f=l(h))<r-u;h++)mo(t,C["b"].round(u+f),n);t.lineStyle(1,16711680,1,0).moveTo(0,u).lineTo(n,u).moveTo(s,0).lineTo(s,r)},created:function(){var t=this;this.$drawing.registerSnap({name:"grid-point",priority:-1/0,get active(){return t.$state.active},handle:function(e,n,r){var i=bo(t.$drawing.scale),a=t.$toGeometry(e,n),o=a.map(Oo,i),s=t.$toCanvas.apply(t,Object(B["a"])(o));r.apply(void 0,Object(B["a"])(s))}})},proxy:function(){return new vo(this)}},ho);function Oo(t){return C["b"].round(t/this)*this}var xo=4,jo=Vn({groupIndex:1e4,created:function(){var t=this;this.$drawing.on("snap",(function(){return t.$setDirty()}))},render:function(t){t.lineStyle(1,13421772).moveTo(-xo,-xo).lineTo(xo,xo).moveTo(xo,-xo).lineTo(-xo,xo);var e=Object(M["a"])(this.$drawing.virtual,2);t.x=e[0],t.y=e[1]}},ho),ko=Xn({id:"com.3dnest.spoke.grid",namespace:"grid",version:so["a"],plugin:ho,elements:{RectangularGrid:$o,Crosshair:jo}}),To=n("33ba"),Eo=50,So=function(t,e){var n=t.corner,r=t.back.corner,i=o.normalize.apply(o,Object(B["a"])(o.fromTwoPoint(n.x,n.y,r.x,r.y))),a=Object(M["a"])(i,2),s=a[0],c=a[1],l=u.translate.apply(u,[n.x,n.y].concat(Object(B["a"])(o.multiply(s,c,e)))),h=Object(M["a"])(l,2),f=h[0],d=h[1];return[f,d]},Co=function(t,e,n){var r=t.corner,i=t.back.corner;return u.project.apply(u,[e,n].concat(Object(B["a"])(s.fromSegment(r.x,r.y,i.x,i.y))))},Fo=function(t,e,n){var r=t.corner,i=Co(t,e,n);return o.getLength.apply(o,Object(B["a"])(o.fromTwoPoint.apply(o,[r.x,r.y].concat(Object(B["a"])(i)))))},No=function(t,e,n,r,i){var a=null,s=null,c=0;if(t.forEach((function(t){var r=Co(t.thisSurface,e,n),i=Object(M["a"])(r,2),a=i[0],u=i[1],l=Math.min(t.thisSurface.corner.x,t.thatSurface.corner.x),h=Math.max(t.thisSurface.corner.x,t.thatSurface.corner.x),f=Math.min(t.thisSurface.corner.y,t.thatSurface.corner.y),d=Math.max(t.thisSurface.corner.y,t.thatSurface.corner.y);if(!(a<l||a>h||u<f||u>d)){var v=o.getLength.apply(o,Object(B["a"])(o.fromTwoPoint(e,n,a,u)));(!s||v<c)&&(s=t,c=v)}})),!s||c/r>Eo)i.corner.x=e,i.corner.y=n,i.back.corner.x=e+10,i.back.corner.y=n,a=i;else{var l=s.thisSurface,h=s.thatSurface;a=u.toLeftOfSegment(e,n,h.corner.x,h.corner.y,l.corner.x,l.corner.y)?h:l}return a},Po=function(t,e,n){this.name="virtual",this.corner={x:t,y:e},this.back={corner:{x:t+10,y:e}},this.wall={thickness:n}},Wo=new WeakMap,Lo=function(t){return Wo.get(t)},Ho=function(){function t(e){Object(R["a"])(this,t),Wo.set(this,e),Object.freeze(this)}return Object(A["a"])(t,[{key:"activate",value:function(){return Lo(this).activate()}},{key:"deactivate",value:function(){return Lo(this).deactivate()}},{key:"createHollow",value:function(t){return Lo(this).createHollow(t)}}]),t}(),Mo=Bn({created:function(){var t=this,e=this.$data.headHandler=this.$createElement("HeadHandler"),n=this.$data.rearHandler=this.$createElement("RearHandler");this.$drawing.wall.on("element-created",(function(r){t.bindHollow(r),r.on("focus",(function(e){t.$data.currentHollow=e.focusing,t.activate()})).on("blur",(function(r){var i=r.holding;i!==e.$proxy&&i!==n.$proxy&&t.deactivate()}))}))},data:function(){return{currentHollow:null,headHandler:null,rearHandler:null,virtualSurface:new Po(0,0,200),creatingHollow:null}},methods:{activate:function(){this.$data.headHandler.show(),this.$data.rearHandler.show()},deactivate:function(){this.$data.currentHollow=null,this.$data.headHandler.hide(),this.$data.rearHandler.hide()},bindHollow:function(t){var e=this;t.on("pointerdown",(function(n){e.$data.creatingHollow||e.hollowAdjust(t,n)}))},hollowAdjust:function(t,e){var n=this,r=this.$drawing,i=e?Fo.apply(void 0,[t.surface].concat(Object(B["a"])(this.$toGeometry(e.pointerX,e.pointerY))))-t.offset:0,a=t.surface,o=t.offset,s=r.structure.getAllWallList(),u=function(e){var r=n.$toGeometry(e.pointerX,e.pointerY),a=No.apply(void 0,[s].concat(Object(B["a"])(r),[n.$drawing.scale,n.$data.virtualSurface]));if("virtual"===a.name)return t.setSurface(a),void t.setOffset(0);var o=Fo.apply(void 0,[a].concat(Object(B["a"])(r)))-i,u=Fo.apply(void 0,[a].concat(Object(B["a"])(a.originSafe))),c=Fo.apply(void 0,[a].concat(Object(B["a"])(a.targetSafe))),l=Fo.apply(void 0,[a].concat(Object(B["a"])(a.back.originSafe))),h=Fo.apply(void 0,[a].concat(Object(B["a"])(a.back.targetSafe))),f=Math.max(u,h)+t.width/2,d=Math.min(c,l)-t.width/2,v=o<f?f:o>d?d:o;t.setSurface(a),t.setOffset(v)},c=function(){r.off("pointermove",u),window.removeEventListener("mouseup",l),window.removeEventListener("keydown",h),n.$data.creatingHollow=null},l=function(){"virtual"!==t.surface.name||n.$data.creatingHollow||(t.setSurface(a),t.setOffset(o)),c()},h=function(t){"Escape"===t.code&&n.$data.creatingHollow&&(n.$data.creatingHollow.remove(),c())};r.on("pointermove",u),window.addEventListener("mouseup",l),window.addEventListener("keydown",h)},createHollow:function(t){var e=this.$data.virtualSurface;e.corner.x=1e5,e.back.corner.x=100001;var n=this.$data.creatingHollow=this.$drawing.wall.createHollow(t,e);return n.setOffset(-n.$state.width),this.hollowAdjust(n.$proxy),n}},proxy:function(){return new Ho(this)}}),Io=new WeakMap,Do=function(t){return Io.get(t)},Ro=function(){function t(e){Object(R["a"])(this,t),Io.set(this,e),Object.freeze(this)}return Object(A["a"])(t,[{key:"show",value:function(){return Do(this).show()}},{key:"hide",value:function(){return Do(this).hide()}}]),t}(),Ao=Vn({groupIndex:1200,interative:!0,hoverable:!0,focusable:!0,draggable:!0,state:function(){return{surface:null,offset:0}},created:function(){var t=this;this.$on("pointerdown",(function(){return t.beginAdjust()})).$on("blur",(function(e){var n=t.$data,r=n.headHandler,i=n.rearHandler,a=e.focusing;a!==r.$proxy&&a!==i.$proxy&&t.$plugin.deactivate()}))},destroy:function(){},render:function(t){if(this.$data.currentHollow){var e=this.$state,n=e.surface,r=e.offset,i=this.$toCanvas.apply(this,Object(B["a"])(So(n,r))),a=Object(M["a"])(i,2),o=a[0],s=a[1];t.lineStyle(this.$hovering||this.$holding?2:1,this.$hovering||this.$holding?16777215:4096759).beginFill(4096759,.5).drawCircle(o,s,5)}},methods:{show:function(){var t=this,e=this.$data.currentHollow;e.on("dirty",(function(n){n.holding!==e&&n.focusing!==e||t.hollowChange(e)})),this.hollowChange(e)},hide:function(){this.setSurface(null),this.setOffset(0)},hollowChange:function(t){var e=t.surface,n=t.offset,r=t.width;this.setSurface(e),this.setOffset(n-r/2)},setSurface:function(t){this.$state.surface=t,this.$setDirty()},setOffset:function(t){this.$state.offset=t,this.$setDirty()},beginAdjust:function(){var t=this,e=this.$data.currentHollow,n=e.offset,r=e.width,i=function(i){var a=t.$toGeometry(i.pointerX,i.pointerY),o=Fo.apply(void 0,[t.$state.surface].concat(Object(B["a"])(a))),s=n-r/2-o;t.setOffset(o),e.setWidth(r+s),e.setOffset(n-s/2)},a=function e(){t.$drawing.off("pointermove",i),window.removeEventListener("mouseup",e)};this.$drawing.on("pointermove",i),window.addEventListener("mouseup",a)}},proxy:function(){return new Ro(this)}},Mo),_o=new WeakMap,Bo=function(t){return _o.get(t)},Vo=function(){function t(e){Object(R["a"])(this,t),_o.set(this,e),Object.freeze(this)}return Object(A["a"])(t,[{key:"show",value:function(){return Bo(this).show()}},{key:"hide",value:function(){return Bo(this).hide()}}]),t}(),Xo=Vn({groupIndex:1200,interative:!0,hoverable:!0,focusable:!0,draggable:!0,state:function(){return{surface:null,offset:0}},created:function(){var t=this;this.$on("pointerdown",(function(){return t.beginAdjust()})).$on("blur",(function(e){var n=t.$data,r=n.headHandler,i=n.rearHandler,a=e.focusing;a!==r.$proxy&&a!==i.$proxy&&t.$plugin.deactivate()}))},destroy:function(){},render:function(t){if(this.$data.currentHollow){var e=this.$state,n=e.surface,r=e.offset,i=this.$toCanvas.apply(this,Object(B["a"])(So(n,r))),a=Object(M["a"])(i,2),o=a[0],s=a[1];t.lineStyle(this.$hovering||this.$holding?2:1,this.$hovering||this.$holding?16777215:4096759).beginFill(4096759,.5).drawRect(o-5,s-5,10,10)}},methods:{show:function(){var t=this,e=this.$data.currentHollow;e.on("dirty",(function(n){n.holding!==e&&n.focusing!==e||t.hollowChange(e)})),this.hollowChange(e)},hide:function(){this.setSurface(null),this.setOffset(0)},hollowChange:function(t){var e=t.surface,n=t.offset,r=t.width;this.setSurface(e),this.setOffset(n+r/2)},setSurface:function(t){this.$state.surface=t,this.$setDirty()},setOffset:function(t){this.$state.offset=t,this.$setDirty()},beginAdjust:function(){var t=this,e=this.$data.currentHollow,n=e.offset,r=e.width,i=function(i){var a=t.$toGeometry(i.pointerX,i.pointerY),o=Fo.apply(void 0,[t.$state.surface].concat(Object(B["a"])(a))),s=o-n-r/2;t.setOffset(o),e.setWidth(r+s),e.setOffset(n+s/2)},a=function e(){t.$drawing.off("pointermove",i),window.removeEventListener("mouseup",e)};this.$drawing.on("pointermove",i),window.addEventListener("mouseup",a)}},proxy:function(){return new Vo(this)}},Mo),Yo=Xn({id:"com.3dnest.spoke.wall.tool",namespace:"wallTool",version:To["a"],plugin:Mo,elements:{HeadHandler:Ao,RearHandler:Xo}}),zo=n("dbc3"),Uo=new WeakMap,Go=function(t){return Uo.get(t)},Ko=function(t){Object(U["a"])(n,t);var e=Object(G["a"])(n);function n(t){var r;return Object(R["a"])(this,n),r=e.call(this,t),Uo.set(Object(Z["a"])(r),t),C["d"].freeze(Object(Z["a"])(r)),r}return Object(A["a"])(n,[{key:"WallBuilder",get:function(){return Go(this).$data.wallBuilder.$proxy}}]),n}(i.Plugin),qo=Bn({data:function(){return{wallBuilder:null,wallSpliter:null,cornerAdjuster:null}},created:function(){var t=this.$drawing.structure,e=this.$createElement("CornerAdjuster"),n=this.$createElement("WallBuilder"),r=this.$createElement("WallSpliter");C["d"].assign(this.$data,{cornerAdjuster:e,wallBuilder:n,wallSpliter:r}),t.on("corner-created",(function(t){return e.bindCorner(t)}))},methods:{some:function(){}},proxy:function(){return new Ko(this)},options:function(t){return t({},{cornerAdjuster:t({enabled:!1}),wallBuilder:t({enabled:!1}),wallSpliter:t({enabled:!1},{interaction:t({distance:50})})})}}),Jo=new WeakMap,Qo=function(t){return Jo.get(t)},Zo=function(t){Object(U["a"])(n,t);var e=Object(G["a"])(n);function n(t){var r;return Object(R["a"])(this,n),r=e.call(this,t),Jo.set(Object(Z["a"])(r),t),C["d"].freeze(Object(Z["a"])(r)),r}return Object(A["a"])(n,[{key:"from",get:function(){return Qo(this).$state.from.slice(0)}},{key:"to",get:function(){return Qo(this).$state.to.slice(0)}},{key:"stage",get:function(){return Qo(this).$state.stage}},{key:"begin",value:function(){return Qo(this).begin(),this}},{key:"cancel",value:function(){return Qo(this).cancel(),this}},{key:"setFrom",value:function(t,e){r.Point(t,e);var n=Qo(this);return n.moveFrom(t,e),n.setFrom(),this}},{key:"buildTo",value:function(t,e){r.Point(t,e);var n=Qo(this);return n.moveTo(t,e),n.build(),this}}]),n}(i.Element),ts=0,es=1,ns=8,rs=function(t){return[t.virtualX,t.virtualY]},is=5,as=65280,os=10,ss=Vn({groupIndex:1200,state:function(){return{stage:ts,from:[0,0],to:[100,100],thickness:200,listener:{moveFrom:C["c"],moveTo:C["c"],setFrom:C["c"],build:C["c"]}}},render:function(t){var e,n=this.$state,r=n.from,i=n.to,a=n.stage;if(a!==ts){var o=this.$toCanvas.apply(this,Object(B["a"])(r));if((e=t.beginFill(as)).drawCircle.apply(e,Object(B["a"])(o).concat([is])).endFill(),a===ns){var s,u,c,l=this.$toCanvas.apply(this,Object(B["a"])(i));(s=(u=(c=t.beginFill(as)).drawCircle.apply(c,Object(B["a"])(l).concat([is])).endFill().lineStyle(1,65535)).moveTo.apply(u,Object(B["a"])(o))).lineTo.apply(s,Object(B["a"])(l))}}},created:function(){var t=this;this.$hide();var e=this.$state,n=function(e){return t.moveFrom.apply(t,Object(B["a"])(t.$toGeometry.apply(t,Object(B["a"])(rs(e)))))},r=function(e){return t.moveTo.apply(t,Object(B["a"])(t.$toGeometry.apply(t,Object(B["a"])(rs(e)))))},i=function(){return t.setFrom()},a=function(){return t.build()};C["d"].assign(e.listener,{moveFrom:n,moveTo:r,setFrom:i,build:a})},methods:{emitEvent:function(t){return this.$emit(t,this.$proxy)},begin:function(){this.$state.stage!==ts&&C["a"].throwError("It MUST begin from STAGE.IDLE."),this.$show();var t=this.$state.listener,e=t.moveFrom,n=t.setFrom;this.$state.stage=es,this.$drawing.on("pointermove",e).on("pointerdown",n),this.emitEvent("begin")},setFrom:function(){this.$state.stage!==es&&C["a"].throwError("It MUST setFrom in STAGE.PICKING_FROM.");var t=this.$state.listener,e=t.moveTo,n=t.build;this.removeAllListener(),this.$state.stage=ns,this.$drawing.on("pointermove",e).on("pointerdown",n),this.emitEvent("from-set")},build:function(){this.$state.stage!==ns&&C["a"].throwError("It MUST setFrom in STAGE.PICKING_TO.");var t=this.$state,e=this.$drawing,n=e.structure,r=t.from,i=t.to,a=this.queryOrCreateCorner.apply(this,Object(B["a"])(r).concat([n])),o=this.queryOrCreateCorner.apply(this,Object(B["a"])(i).concat([n]));n.createWall(a,o),this.removeAllListener(),t.stage=ts,this.$hide(),this.emitEvent("end").emitEvent("build")},cancel:function(){this.removeAllListener(),this.$state.stage=ts,this.$hide(),this.emitEvent("end").emitEvent("cancel")},removeAllListener:function(){var t=this.$state.listener,e=t.setFrom,n=t.moveFrom,r=t.moveTo,i=t.build;this.$drawing.off("pointermove",n).off("pointermove",r).off("pointerdown",e).off("pointerdown",i)},moveFrom:function(t,e){this.$state.from=this.$state.to=[t,e],this.$setDirty()},moveTo:function(t,e){this.$state.to=[t,e],this.$setDirty()},queryOrCreateCorner:function(t,e){var n=this.$drawing.structure;return n.queryCorner(t,e,os)||n.createCorner(t,e)}},proxy:function(){return new Zo(this)}},qo),us=function(t){Object(U["a"])(n,t);var e=Object(G["a"])(n);function n(){return Object(R["a"])(this,n),e.apply(this,arguments)}return Object(A["a"])(n)}(i.Element),cs=Vn({groupIndex:1150,interative:!0,focusable:!0,state:function(){return{moving:!1,corner:null,point:[0,0],adjacentList:[]}},created:function(){var t=this,e=this.$drawing.structure;this.$on("pointerdown",(function(){t.$state.moving=!0;var n=function(e){t.$state.point=t.$toGeometry(e.virtualX,e.virtualY),t.$setDirty()},r=function r(){var i=t.$state,a=i.corner,o=i.point;t.$drawing.off("pointermove",n),Ce["a"].removeEventListener(Ce["c"].WINDOW,"mouseup",r);var s=e.queryCorner.apply(e,Object(B["a"])(o));if(C["e"].Not.Null(s)&&s!==a){var u=e.createWall(a,s);e.combine(u)}t.$state.moving=!1,a.move.apply(a,Object(B["a"])(o)),t.setCorner()};t.$drawing.on("pointermove",n),Ce["a"].addEventListener(Ce["c"].WINDOW,"mouseup",r)})).$on("pointerout",(function(){t.$state.moving||t.setCorner()}))},getters:{moving:function(){return this.$state.moving}},render:function(t){var e,n=this.$state,r=n.corner,i=n.adjacentList,a=n.point;if(!C["e"].isNull(r)){var o=this.$drawing.structure.options.corner.style.radius,s=this.$toCanvas.apply(this,Object(B["a"])(a));(e=t.beginFill(0)).drawCircle.apply(e,Object(B["a"])(s).concat([o])).lineStyle(2,0);var u,c=Object(I["a"])(i);try{for(c.s();!(u=c.n()).done;){var l,h,f,d=u.value,v=this.$toCanvas.apply(this,Object(B["a"])(d));(l=(h=(f=t.beginFill(16777215)).drawCircle.apply(f,Object(B["a"])(v).concat([o]))).moveTo.apply(h,Object(B["a"])(v))).lineTo.apply(l,Object(B["a"])(s))}}catch(p){c.e(p)}finally{c.f()}}},methods:{setCorner:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this.$state.corner=t,this.$setDirty(),C["e"].Not.Null(t)){var e=this.$state.point;e[0]=t.x,e[1]=t.y,this.$state.adjacentList=t.getAdjacentCornerList().map(ls)}},bindCorner:function(t){var e=this;t.on("pointerover",(function(){e.$plugin.$options.cornerAdjuster.enabled&&(e.moving||e.setCorner(t))}))}},proxy:function(){return new us(this)}},qo),ls=function(t){return[t.x,t.y]},hs=Vn({groupIndex:1210,state:function(){return{breakpoint:[0,0],segment:[0,0,0,0],wall:null}},render:function(t){var e,n=this.$state,r=n.wall,i=n.segment,a=n.breakpoint;if(!C["e"].isNull(r)){var o=Object(M["a"])(i,4),s=o[0],u=o[1],c=o[2],l=o[3];(e=t.lineStyle(1,0).moveTo(s,u).lineTo(c,l)).drawCircle.apply(e,Object(B["a"])(a).concat([5]))}},created:function(){this.bindDrawing()},methods:{getWallSegment:function(t){var e=t.thisSurface.corner,n=t.thatSurface.corner;return[].concat(Object(B["a"])(this.$toCanvas(e.x,e.y)),Object(B["a"])(this.$toCanvas(n.x,n.y)))},split:function(){var t,e=this.$state,n=e.breakpoint,r=e.wall;return(t=this.$drawing.structure).split.apply(t,[r].concat(Object(B["a"])(this.$toGeometry.apply(this,Object(B["a"])(n)))))},bindDrawing:function(){var t=this,e=this.$drawing.structure,n=this.$plugin.$options.wallSpliter,r=Date.now();this.$drawing.on("pointermove",(function(i){if(n.enabled){var a=Date.now();if(!(a-r<15)){r=a;var o,c=i.pointerX,l=i.pointerY,h=[c,l],f=Object(I["a"])(e.getAllWallList());try{for(f.s();!(o=f.n()).done;){var d=o.value,v=t.getWallSegment(d),p=u.distanceToSegment.apply(u,h.concat(Object(B["a"])(v)));if(p<n.interaction.distance){var g=u.project.apply(u,h.concat(Object(B["a"])(s.fromSegment.apply(s,Object(B["a"])(v)))));return t.$state.segment=v,t.$state.breakpoint=g,t.$state.wall=d,void t.$setDirty()}}}catch(y){f.e(y)}finally{f.f()}t.$state.wall=null,t.$setDirty()}}}))}}},qo),fs=Xn({id:"com.3dnest.spoke.tool.structure",namespace:"structureTool",version:zo["a"],plugin:qo,elements:{WallBuilder:ss,WallSpliter:hs,CornerAdjuster:cs}}),ds=n("4c9e"),vs=new WeakMap,ps=function(t){return vs.get(t)},gs=function(){function t(e){Object(R["a"])(this,t),vs.set(this,e),Object.freeze(this)}return Object(A["a"])(t,[{key:"activate",value:function(){return ps(this).activate()}},{key:"deactivate",value:function(){return ps(this).deactivate()}},{key:"createFurniture",value:function(t,e,n){return ps(this).createFurniture(t,e,n)}}]),t}(),ys=Bn({created:function(){var t=this;this.createHandler(0,1),this.createHandler(-1,1),this.createHandler(1,1),this.createHandler(-1,0),this.createHandler(1,0),this.createHandler(-1,-1),this.createHandler(0,-1),this.createHandler(1,-1);var e=this.$data.rotater=this.$createElement("Rotater"),n=this.$data.preview=this.$createElement("Preview");this.$drawing.room.on("element-created",(function(r){r.on("focus",(function(e){t.$data.currentFurniture=e.focusing,t.activate(),n.furnitureAdjust(e.focusing,e)})).on("blur",(function(r){var i=r.holding;t.$data.handlerList.includes(i)||i===e.$proxy||i===n.$proxy||t.deactivate()}))}))},data:function(){return{currentFurniture:null,handlerList:[],rotater:null,preview:null,creatingFurniture:null}},methods:{createHandler:function(t,e){this.$data.handlerList.push(this.$createElement("Handler",t,e).$proxy)},activate:function(){var t,e=Object(I["a"])(this.$data.handlerList);try{for(e.s();!(t=e.n()).done;){var n=t.value;n.show()}}catch(r){e.e(r)}finally{e.f()}this.$data.rotater.show(),this.$data.preview.show()},deactivate:function(){this.$data.currentFurniture=null;var t,e=Object(I["a"])(this.$data.handlerList);try{for(e.s();!(t=e.n()).done;){var n=t.value;n.hide()}}catch(r){e.e(r)}finally{e.f()}this.$data.rotater.hide(),this.$data.preview.hide()},createFurniture:function(t,e,n){var r=this.$data.creatingFurniture=this.$drawing.room.createFurniture(e,n,99999,99999,t);return this.$data.preview.furnitureCreate(),r}},proxy:function(){return new gs(this)}}),bs=function(t,e,n,r,i,a){return u.project.apply(u,[i,a].concat(Object(B["a"])(s.fromSegment(t,e,n,r))))},ms=function(t,e,n,r,i,a){var s=bs(t,e,n,r,i,a);return o.getLength.apply(o,Object(B["a"])(o.fromTwoPoint.apply(o,[t,e].concat(Object(B["a"])(s)))))},ws=function(t,e,n,r,i){var a=o.normalize.apply(o,Object(B["a"])(o.fromTwoPoint(t,e,n,r))),s=Object(M["a"])(a,2),c=s[0],l=s[1],h=u.translate.apply(u,[t,e].concat(Object(B["a"])(o.multiply(c,l,i)))),f=Object(M["a"])(h,2),d=f[0],v=f[1];return[d,v]},$s=new WeakMap,Os=function(t){return $s.get(t)},xs=function(){function t(e){Object(R["a"])(this,t),$s.set(this,e),Object.freeze(this)}return Object(A["a"])(t,[{key:"show",value:function(){return Os(this).show()}},{key:"hide",value:function(){return Os(this).hide()}}]),t}(),js=Vn({groupIndex:1300,interative:!0,hoverable:!0,focusable:!0,draggable:!0,state:function(){return{xStatus:0,yStatus:0,furniture:null,x:0,y:0,pivotX:0,pivotY:0,rotation:0,listener:C["c"]}},created:function(t,e){var n=this;this.$state.xStatus=t,this.$state.yStatus=e,this.$on("pointerdown",(function(){return n.beginAdjust()})).$on("blur",(function(t){var e=t.focusing;n.$data.handlerList.includes(e)||e===n.$data.rotater.$proxy||e===n.$data.preview.$proxy||n.$plugin.deactivate()}))},render:function(t){if(this.$data.currentFurniture){var e=this.$state,n=e.x,r=e.y,i=e.pivotX,a=e.pivotY,o=e.rotation,s=this.$drawing.scale;t.lineStyle(1,4096759).beginFill(16777215).drawRect(-5,-5,10,10),t.pivot.x=i/s,t.pivot.y=a/s;var u=this.$toCanvas(n,r),c=Object(M["a"])(u,2);t.x=c[0],t.y=c[1],t.rotation=o}},methods:{show:function(){var t=this,e=this.$state.furniture=this.$data.currentFurniture;e.on("dirty",this.$state.listener=function(){return t.furnitureChange(e)}),this.furnitureChange(e)},hide:function(){this.$state.furniture.off("dirty",this.$state.listener),this.$state.furniture=null,this.$state.listener=C["c"],this.$setDirty()},furnitureChange:function(t){var e=this.$state,n=e.xStatus,r=e.yStatus,i=t.width,a=t.height,o=t.x,s=t.y,u=t.rotation;this.setX(o),this.setY(s),this.setPivotX(-n*i/2),this.setPivotY(r*a/2),this.setRotation(u)},setX:function(t){this.$state.x=t,this.$setDirty()},setY:function(t){this.$state.y=t,this.$setDirty()},setPivotX:function(t){this.$state.pivotX=t,this.$setDirty()},setPivotY:function(t){this.$state.pivotY=t,this.$setDirty()},setRotation:function(t){this.$state.rotation=t,this.$setDirty()},beginAdjust:function(){var t=this,e=this.$data.currentFurniture,n=function(n){var r=t.$state,i=r.xStatus,a=r.yStatus,o=e.x,s=e.y,c=e.width,l=e.height,h=e.rotation,f=t.$toGeometry(n.pointerX,n.pointerY),d=o+i*c/2,v=s+a*l/2,p=u.rotate(d,v,-h,o,s),g=Object(M["a"])(p,2),y=g[0],b=g[1],m=ms(o,s,y,b,y,b),w=ms.apply(void 0,[o,s,y,b].concat(Object(B["a"])(f))),$=u.rotate.apply(u,Object(B["a"])(ws(o,s,y,b,w)).concat([h,o,s])),O=Object(M["a"])($,2),x=O[0],j=O[1],k=i*(x-d),T=a*(j-v);t.setPivotX(i*(x-o)),t.setPivotY(a*(j-s)),e.setHeight(l+T),e.setWidth(c+k),e.setPosition.apply(e,Object(B["a"])(ws(o,s,y,b,(w-m)/2)))},r=function e(){t.$drawing.off("pointermove",n),window.removeEventListener("mouseup",e)};this.$drawing.on("pointermove",n),window.addEventListener("mouseup",r)}},proxy:function(){return new xs(this)}},ys),ks=new WeakMap,Ts=function(t){return ks.get(t)},Es=function(){function t(e){Object(R["a"])(this,t),ks.set(this,e),Object.freeze(this)}return Object(A["a"])(t,[{key:"show",value:function(){return Ts(this).show()}},{key:"hide",value:function(){return Ts(this).hide()}}]),t}(),Ss=30,Cs=Vn({groupIndex:1300,interative:!0,hoverable:!0,focusable:!0,draggable:!0,state:function(){return{furniture:null,x:0,y:0,pivotX:0,pivotY:0,rotation:0,listener:C["c"]}},created:function(){var t=this;this.$on("pointerdown",(function(){return t.beginAdjust()})).$on("blur",(function(e){var n=e.focusing;t.$data.handlerList.includes(n)||n===t.$data.rotater.$proxy||n===t.$data.preview.$proxy||t.$plugin.deactivate()}))},render:function(t){if(this.$data.currentFurniture){var e=this.$state,n=e.x,r=e.y,i=e.pivotX,a=e.pivotY,o=e.rotation,s=this.$drawing.scale;t.lineStyle(1,4096759).beginFill(16777215).drawCircle(0,0,5).moveTo(0,5).lineTo(0,Ss-5),t.pivot.x=i/s,t.pivot.y=a/s;var u=this.$toCanvas(n,r),c=Object(M["a"])(u,2);t.x=c[0],t.y=c[1],t.rotation=o}},methods:{show:function(){var t=this,e=this.$state.furniture=this.$data.currentFurniture;e.on("dirty",this.$state.listener=function(){return t.furnitureChange(e)}),this.furnitureChange(e)},hide:function(){this.$state.furniture.off("dirty",this.$state.listener),this.$state.furniture=null,this.$state.listener=C["c"],this.$setDirty()},furnitureChange:function(t){var e=t.height,n=t.x,r=t.y,i=t.rotation;this.$state.x=n,this.$state.y=r,this.$state.pivotX=0,this.$state.pivotY=e/2+Ss*this.$drawing.scale,this.setRotation(i)},setRotation:function(t){this.$state.rotation=t,this.$setDirty()},beginAdjust:function(){var t=this,e=this.$data.currentFurniture,n=function(n){var r=e.x,i=e.y,a=t.$toGeometry(n.pointerX,n.pointerY),s=Math.atan2.apply(Math,Object(B["a"])(o.fromTwoPoint.apply(o,[r,i].concat(Object(B["a"])(a)))));t.setRotation(s),e.setRotation(s)},r=function e(){t.$drawing.off("pointermove",n),window.removeEventListener("mouseup",e)};this.$drawing.on("pointermove",n),window.addEventListener("mouseup",r)}},proxy:function(){return new Es(this)}},ys),Fs=new WeakMap,Ns=function(t){return Fs.get(t)},Ps=function(){function t(e){Object(R["a"])(this,t),Fs.set(this,e),Object.freeze(this)}return Object(A["a"])(t,[{key:"show",value:function(){return Ns(this).show()}},{key:"hide",value:function(){return Ns(this).hide()}},{key:"setPosition",value:function(t,e){return Ns(this).setPosition(t,e)}},{key:"furnitureCreate",value:function(){return Ns(this).furnitureCreate()}}]),t}(),Ws=Vn({groupIndex:1200,interative:!0,focusable:!0,draggable:!0,state:function(){return{x:0,y:0}},created:function(){var t=this;this.$on("pointerdown",(function(e){t.$data.currentFurniture&&t.furnitureAdjust(t.$data.currentFurniture,e)})).$on("blur",(function(e){var n=e.focusing;t.$data.handlerList.includes(n)||n===t.$data.rotater.$proxy||n===t.$data.preview.$proxy||t.$plugin.deactivate()}))},render:function(t){if(this.$data.currentFurniture){var e=this.$state,n=e.x,r=e.y,i=this.$data.currentFurniture,a=i.width,o=i.height,s=i.rotation,u=this.$drawing.scale,c=a/u,l=o/u;t.lineStyle(1,4096759).beginFill(16777215).drawCircle(0,0,5).endFill().beginFill(4096759,.2).drawRect(-c/2,-l/2,c,l).endFill(),t.pivot.x=0,t.pivot.y=0;var h=this.$toCanvas(n,r),f=Object(M["a"])(h,2);t.x=f[0],t.y=f[1],t.rotation=s}},methods:{show:function(){var t=this,e=this.$data.currentFurniture;this.setPosition(e.x,e.y),e.on("dirty",(function(){t.setPosition(e.x,e.y)}))},hide:function(){this.$setDirty()},setPosition:function(t,e){this.$state.x=t,this.$state.y=e,this.$setDirty()},furnitureCreate:function(){var t=this.$data.creatingFurniture;this.setPosition(t.x,t.y),this.furnitureAdjust(t)},furnitureAdjust:function(t,e){var n=this,r=this.$drawing,i=e?this.$toGeometry(e.pointerX,e.pointerY):[t.x,t.y],a=i[0]-t.x,o=i[1]-t.y,s=!0,u=r.structure.getAllRoomList(),c=u.map((function(t){return t.getOuterSurfaceList().map((function(t){return t.origin}))})),l=u.map((function(t){return t.getOuterSurfaceList().map((function(t){return t.back.origin}))})),h=function(e){var r=n.$toGeometry(e.pointerX,e.pointerY),i=r[0]-a,u=r[1]-o,h=n.$drawing.structure.getRoomByPoint(i,u);if(n.setPosition(i,u),n.$data.currentFurniture&&c.length){var f=Ls(n.$state.x,n.$state.y,t.width,t.height,t.rotation);s=Hs(f,c,l)}s&&(t.setPosition(i,u),t.setRoom(h))},f=function(){r.off("pointermove",h),window.removeEventListener("mouseup",d),window.removeEventListener("keydown",v)},d=function(){var t=n.$data.currentFurniture;t&&n.setPosition(t.x,t.y),f()},v=function(t){"Escape"===t.code&&n.$data.creatingFurniture&&(n.$data.creatingFurniture.remove(),f())};r.on("pointermove",h),window.addEventListener("mouseup",d),window.addEventListener("keydown",v)}},proxy:function(){return new Ps(this)}},ys),Ls=function(t,e,n,r,i){var a=[[t-n/2,e+r/2],[t+n/2,e+r/2],[t+n/2,e-r/2],[t-n/2,e-r/2]];return a.map((function(n){return u.rotate.apply(u,Object(B["a"])(n).concat([i,t,e])).slice(0)}))},Hs=function(t,e,n){var r=t.map((function(t){var r=e.find((function(e){return h.containsPoint(Ms(e),{x:t[0],y:t[1]})})),i=n.find((function(e){return h.containsPoint(Ms(e),{x:t[0],y:t[1]})}));return r||(i?"wall":"blank")}));return!r.find((function(t){return"wall"===t}))&&!r.some((function(t){return t!==r[0]}))},Ms=function(t){return t.map((function(t){return{x:t[0],y:t[1]}}))},Is=Xn({id:"com.3dnest.spoke.room.tool",namespace:"roomTool",version:ds["a"],plugin:ys,elements:{Handler:js,Rotater:Cs,Preview:Ws}}),Ds=new WeakMap,Rs=function(t){return Ds.get(t)},As=function(t){Object(U["a"])(n,t);var e=Object(G["a"])(n);function n(t){var r;return Object(R["a"])(this,n),r=e.call(this,t),Ds.set(Object(Z["a"])(r),t),Object.freeze(Object(Z["a"])(r)),r}return Object(A["a"])(n,[{key:"activate",value:function(t){return Rs(this).activate(t)}},{key:"deactivate",value:function(){return Rs(this).deactivate()}},{key:"createBitmap",value:function(t,e,n){return Rs(this).createBitmap(t,e,n)}}]),n}(Rn),_s=Bn({created:function(){this.createHandler(0,1),this.createHandler(-1,1),this.createHandler(1,1),this.createHandler(-1,0),this.createHandler(1,0),this.createHandler(-1,-1),this.createHandler(0,-1),this.createHandler(1,-1),this.$data.rotater=this.$createElement("Rotater"),this.$data.translater=this.$createElement("Translater")},data:function(){return{currentBitmap:null,handlerList:[],rotater:null,translater:null}},methods:{createHandler:function(t,e){this.$data.handlerList.push(this.$createElement("Handler",t,e).$proxy)},activate:function(t){this.$data.currentBitmap=t.$proxy;var e,n=Object(I["a"])(this.$data.handlerList);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.show()}}catch(i){n.e(i)}finally{n.f()}this.$data.rotater.show(),this.$data.translater.show()},deactivate:function(){this.$data.currentBitmap=null;var t,e=Object(I["a"])(this.$data.handlerList);try{for(e.s();!(t=e.n()).done;){var n=t.value;n.hide()}}catch(r){e.e(r)}finally{e.f()}this.$data.rotater.hide(),this.$data.translater.hide()},createBitmap:function(t,e,n){var r=this;return Object(ja["a"])(regeneratorRuntime.mark((function i(){var a,o;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,S.Texture.fromURL(t);case 2:return a=i.sent,o=r.$drawing.scale,i.abrupt("return",r.$createElement("Bitmap",a,e||a.width*o,n||a.height*o));case 5:case"end":return i.stop()}}),i)})))()}},proxy:function(){return new As(this)}}),Bs=new WeakMap,Vs=function(t){return Bs.get(t)},Xs=function(t){Object(U["a"])(n,t);var e=Object(G["a"])(n);function n(t){var r;return Object(R["a"])(this,n),r=e.call(this,t),Bs.set(Object(Z["a"])(r),t),Object.freeze(Object(Z["a"])(r)),r}return Object(A["a"])(n,[{key:"width",get:function(){return Vs(this).width}},{key:"height",get:function(){return Vs(this).height}},{key:"rotation",get:function(){return Vs(this).rotation}},{key:"x",get:function(){return Vs(this).x}},{key:"y",get:function(){return Vs(this).y}},{key:"alpha",get:function(){return Vs(this).alpha}},{key:"setWidth",value:function(t){Vs(this).setWidth(t)}},{key:"setHeight",value:function(t){Vs(this).setHeight(t)}},{key:"setRotation",value:function(t){Vs(this).setRotation(t)}},{key:"setPosition",value:function(t,e){Vs(this).setPosition(t,e)}},{key:"setAlpha",value:function(t){Vs(this).setAlpha(t)}},{key:"remove",value:function(){Vs(this).remove()}}]),n}(Ln),Ys=S,zs=Vn({groupIndex:-100,interative:!0,draggable:!0,state:function(){return{name:"Bitmap",texture:null,width:0,height:0,x:0,y:0,rotation:0,alpha:1}},getters:{width:function(){return this.$state.width},height:function(){return this.$state.height},rotation:function(){return this.$state.rotation},x:function(){return this.$state.x},y:function(){return this.$state.y},alpha:function(){return this.$state.alpha}},created:function(t,e,n){this.setTexture(t),this.setWidth(e),this.setHeight(n)},destroy:function(){},render:function(t){var e=this.$state,n=e.texture,r=e.width,i=e.height,a=e.x,o=e.y,s=e.rotation,u=e.alpha,c=this.$drawing.scale,l=r/c,h=i/c,f=l>0?l:n.width,d=h>0?h:n.height;t.pivot.x=l/2,t.pivot.y=h/2,t.beginTextureFill({texture:n,alpha:u,matrix:new Ys.Matrix(f/n.width,0,0,d/n.height,0,0)}).drawRect(0,0,f,d);var v=this.$toCanvas(a,o),p=Object(M["a"])(v,2);t.x=p[0],t.y=p[1],t.rotation=s},methods:{setTexture:function(t){this.$state.texture=t,this.$setDirty()},setWidth:function(t){this.$state.width=t,this.$setDirty()},setHeight:function(t){this.$state.height=t,this.$setDirty()},setRotation:function(t){this.$state.rotation=t,this.$setDirty()},setPosition:function(t,e){this.$state.x=t,this.$state.y=e,this.$setDirty()},setAlpha:function(t){this.$state.alpha=t,this.$setDirty()},remove:function(){this.$destroy()}},proxy:function(){return new Xs(this)}},_s),Us=function(t,e,n,r,i,a){return u.project.apply(u,[i,a].concat(Object(B["a"])(s.fromSegment(t,e,n,r))))},Gs=function(t,e,n,r,i,a){var s=Us(t,e,n,r,i,a);return o.getLength.apply(o,Object(B["a"])(o.fromTwoPoint.apply(o,[t,e].concat(Object(B["a"])(s)))))},Ks=function(t,e,n,r,i){var a=o.normalize.apply(o,Object(B["a"])(o.fromTwoPoint(t,e,n,r))),s=Object(M["a"])(a,2),c=s[0],l=s[1],h=u.translate.apply(u,[t,e].concat(Object(B["a"])(o.multiply(c,l,i)))),f=Object(M["a"])(h,2),d=f[0],v=f[1];return[d,v]},qs=new WeakMap,Js=function(t){return qs.get(t)},Qs=function(){function t(e){Object(R["a"])(this,t),qs.set(this,e),Object.freeze(this)}return Object(A["a"])(t,[{key:"show",value:function(){return Js(this).show()}},{key:"hide",value:function(){return Js(this).hide()}}]),t}(),Zs=Vn({groupIndex:700,interative:!0,hoverable:!0,focusable:!0,draggable:!0,state:function(){return{xStatus:0,yStatus:0,bitmap:null,x:0,y:0,pivotX:0,pivotY:0,rotation:0,listener:C["c"]}},created:function(t,e){var n=this;this.$state.xStatus=t,this.$state.yStatus=e,this.$on("pointerdown",(function(){return n.beginAdjust()}))},render:function(t){if(this.$data.currentBitmap){var e=this.$state,n=e.x,r=e.y,i=e.pivotX,a=e.pivotY,o=e.rotation,s=this.$drawing.scale;t.lineStyle(1,4096759).beginFill(16777215).drawRect(-5,-5,10,10),t.pivot.x=i/s,t.pivot.y=a/s;var u=this.$toCanvas(n,r),c=Object(M["a"])(u,2);t.x=c[0],t.y=c[1],t.rotation=o}},methods:{show:function(){var t=this,e=this.$state.bitmap=this.$data.currentBitmap;e.on("dirty",this.$state.listener=function(){return t.bitmapChange(e)}),this.bitmapChange(e)},hide:function(){this.$state.bitmap.off("dirty",this.$state.listener),this.$state.bitmap=null,this.$state.listener=C["c"],this.$setDirty()},bitmapChange:function(t){var e=this.$state,n=e.xStatus,r=e.yStatus,i=t.width,a=t.height,o=t.x,s=t.y,u=t.rotation;this.setX(o),this.setY(s),this.setPivotX(-n*i/2),this.setPivotY(r*a/2),this.setRotation(u)},setX:function(t){this.$state.x=t,this.$setDirty()},setY:function(t){this.$state.y=t,this.$setDirty()},setPivotX:function(t){this.$state.pivotX=t,this.$setDirty()},setPivotY:function(t){this.$state.pivotY=t,this.$setDirty()},setRotation:function(t){this.$state.rotation=t,this.$setDirty()},beginAdjust:function(){var t=this,e=this.$data.currentBitmap,n=function(n){var r=t.$state,i=r.xStatus,a=r.yStatus,o=e.x,s=e.y,c=e.width,l=e.height,h=e.rotation,f=t.$toGeometry(n.pointerX,n.pointerY),d=o+i*c/2,v=s+a*l/2,p=u.rotate(d,v,-h,o,s),g=Object(M["a"])(p,2),y=g[0],b=g[1],m=Gs(o,s,y,b,y,b),w=Gs.apply(void 0,[o,s,y,b].concat(Object(B["a"])(f))),$=u.rotate.apply(u,Object(B["a"])(Ks(o,s,y,b,w)).concat([h,o,s])),O=Object(M["a"])($,2),x=O[0],j=O[1],k=i*(x-d),T=a*(j-v);t.setPivotX(i*(x-o)),t.setPivotY(a*(j-s)),e.setHeight(l+T),e.setWidth(c+k),e.setPosition.apply(e,Object(B["a"])(Ks(o,s,y,b,(w-m)/2)))},r=function e(){t.$drawing.off("pointermove",n),window.removeEventListener("mouseup",e)};this.$drawing.on("pointermove",n),window.addEventListener("mouseup",r)}},proxy:function(){return new Qs(this)}},_s),tu=new WeakMap,eu=function(t){return tu.get(t)},nu=function(){function t(e){Object(R["a"])(this,t),tu.set(this,e),Object.freeze(this)}return Object(A["a"])(t,[{key:"show",value:function(){return eu(this).show()}},{key:"hide",value:function(){return eu(this).hide()}}]),t}(),ru=30,iu=Vn({groupIndex:700,interative:!0,hoverable:!0,focusable:!0,draggable:!0,state:function(){return{bitmap:null,x:0,y:0,pivotX:0,pivotY:0,rotation:0,listener:C["c"]}},created:function(){var t=this;this.$on("pointerdown",(function(){return t.beginAdjust()}))},render:function(t){if(this.$data.currentBitmap){var e=this.$state,n=e.x,r=e.y,i=e.pivotX,a=e.pivotY,o=e.rotation,s=this.$drawing.scale;t.lineStyle(1,4096759).beginFill(16777215).drawCircle(0,0,5).moveTo(0,5).lineTo(0,ru-5),t.pivot.x=i/s,t.pivot.y=a/s;var u=this.$toCanvas(n,r),c=Object(M["a"])(u,2);t.x=c[0],t.y=c[1],t.rotation=o}},methods:{show:function(){var t=this,e=this.$state.bitmap=this.$data.currentBitmap;e.on("dirty",this.$state.listener=function(){return t.bitmapChange(e)}),this.bitmapChange(e)},hide:function(){this.$state.bitmap.off("dirty",this.$state.listener),this.$state.bitmap=null,this.$state.listener=C["c"],this.$setDirty()},bitmapChange:function(t){var e=t.height,n=t.x,r=t.y,i=t.rotation;this.$state.x=n,this.$state.y=r,this.$state.pivotX=0,this.$state.pivotY=e/2+ru*this.$drawing.scale,this.setRotation(i)},setRotation:function(t){this.$state.rotation=t,this.$setDirty()},beginAdjust:function(){var t=this,e=this.$data.currentBitmap,n=function(n){var r=e.x,i=e.y,a=t.$toGeometry(n.pointerX,n.pointerY),s=Math.atan2.apply(Math,Object(B["a"])(o.fromTwoPoint.apply(o,[r,i].concat(Object(B["a"])(a)))));t.setRotation(s),e.setRotation(s)},r=function e(){t.$drawing.off("pointermove",n),window.removeEventListener("mouseup",e)};this.$drawing.on("pointermove",n),window.addEventListener("mouseup",r)}},proxy:function(){return new nu(this)}},_s),au=new WeakMap,ou=function(t){return au.get(t)},su=function(){function t(e){Object(R["a"])(this,t),au.set(this,e),Object.freeze(this)}return Object(A["a"])(t,[{key:"show",value:function(){return ou(this).show()}},{key:"hide",value:function(){return ou(this).hide()}}]),t}(),uu=Vn({groupIndex:650,interative:!0,focusable:!0,state:function(){return{listener:C["c"]}},created:function(){var t=this;this.$on("pointerdown",this.$state.listener=function(e){t.bitmapAdjust(e)})},destroy:function(){this.$off("pointerdown",this.$state.listener)},render:function(t){if(this.$data.currentBitmap){var e=this.$data.currentBitmap,n=e.width,r=e.height,i=e.rotation,a=e.x,o=e.y,s=this.$drawing.scale,u=n/s,c=r/s;t.lineStyle(1,4096759).beginFill(16777215).drawCircle(0,0,5).endFill().beginFill(4096759,.2).drawRect(-u/2,-c/2,u,c).endFill(),t.pivot.x=0,t.pivot.y=0;var l=this.$toCanvas(a,o),h=Object(M["a"])(l,2);t.x=h[0],t.y=h[1],t.rotation=i}},methods:{show:function(){var t=this,e=this.$data.currentBitmap;e.on("dirty",(function(){t.$setDirty()})),this.$setDirty()},hide:function(){this.$setDirty()},bitmapAdjust:function(t){var e=this,n=this.$data.currentBitmap,r=n.x,i=n.y,a=this.$drawing,o=t?this.$toGeometry(t.pointerX,t.pointerY):[r,i],s=o[0]-r,u=o[1]-i,c=function(t){var r=e.$toGeometry(t.pointerX,t.pointerY);n.setPosition(r[0]-s,r[1]-u)},l=function t(){a.off("pointermove",c),window.removeEventListener("mouseup",t)};a.on("pointermove",c),window.addEventListener("mouseup",l)}},proxy:function(){return new su(this)}},_s),cu=n("6b9e"),lu=Xn({id:"com.3dnest.spoke.negative",namespace:"negative",version:cu["a"],plugin:_s,elements:{Bitmap:zs,Handler:Zs,Rotater:iu,Translater:uu}});[Wa,za,oo,fs,Yo,Is,ko,lu].forEach((function(t){return rn(t)}));var hu=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("b-table",{staticClass:"mb-0",attrs:{small:"",bordered:"","head-variant":"dark",items:t.items,fields:t.fieldList,hover:""}})],1)},fu=[],du=(n("b680"),100),vu={name:"CoreState",props:["drawing"],data:function(){return{width:0,height:0,scale:0,origin:[0,0],pointer:[0,0],virtual:[0,0],geometry:[0,0]}},computed:{items:function(){return[{key:"width",value:this.width,unit:"px"},{key:"height",value:this.height,unit:"px"},{key:"scale",value:this.scale,unit:"mm/px"},{key:"originX",value:this.origin[0],unit:"px"},{key:"originY",value:this.origin[1],unit:"px"},{key:"pointerX",value:this.pointer[0].toFixed(2),unit:"px"},{key:"pointerY",value:this.pointer[1].toFixed(2),unit:"px"},{key:"virtualX",value:this.virtual[0].toFixed(2),unit:"px"},{key:"virtualY",value:this.virtual[1].toFixed(2),unit:"px"},{key:"geometryX",value:this.geometry[0].toFixed(2),unit:"mm"},{key:"geometryY",value:this.geometry[1].toFixed(2),unit:"mm"}]},fieldList:function(){return[{key:"key",label:"Key"},{key:"value",label:"Value",class:"col-short-number"},{key:"unit",label:"Unit",class:"col-tiny-string"}]}},mounted:function(){var t=this;this._interval=setInterval((function(){return t.flush()}),du)},destroyed:function(){clearInterval(this._interval)},methods:{flush:function(){this.width=this.drawing.width,this.height=this.drawing.height,this.scale=this.drawing.scale,this.origin=this.drawing.origin,this.pointer=this.drawing.pointer,this.virtual=this.drawing.virtual}}},pu=vu,gu=n("0c7c"),yu=Object(gu["a"])(pu,hu,fu,!1,null,null,null),bu=yu.exports,mu=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"p-1"},[n("b-button",{staticClass:"text-nowrap",attrs:{variant:"info"},on:{click:function(e){return t.example()}}},[t._v("example")])],1)},wu=[],$u=100,Ou=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$u;return new Promise((function(e){return setTimeout(e,t)}))},xu={name:"CoreTool",props:["drawing"],methods:{example:function(){var t=this;return Object(ja["a"])(regeneratorRuntime.mark((function e(){var n,r,i,a,o,s,u,c,l,h;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.drawing,r=n.structure.createCorner(-2e3,3e3),i=n.structure.createCorner(5e3,3e3),a=n.structure.createCorner(5e3,-1500),o=n.structure.createCorner(-2e3,-1500),s=n.structure.createWall(r,i),e.next=8,Ou();case 8:return u=n.structure.createWall(i,a),e.next=11,Ou();case 11:return c=n.structure.createWall(a,o),e.next=14,Ou();case 14:return l=n.structure.createWall(o,r),e.next=17,Ou();case 17:return n.setOrigin(500,500),e.next=20,Ou();case 20:return n.setScale(15),e.next=23,Ou();case 23:return n.wall.createHollow("singleDoor",s.thisSurface,1500),e.next=26,Ou();case 26:return n.wall.createHollow("boilerWindow",u.thisSurface,2e3),e.next=29,Ou();case 29:return n.wall.createHollow("singleDoor",c.thisSurface,1500),e.next=32,Ou();case 32:return n.wall.createHollow("basicWindow",l.thisSurface,1500),e.next=35,Ou();case 35:return h=window.room=s.thatSurface.room,n.room.createFurniture(2e3,2e3,2e3,1e3,"bed",h),e.next=39,Ou();case 39:case"end":return e.stop()}}),e)})))()}}},ju=xu,ku=Object(gu["a"])(ju,mu,wu,!1,null,null,null),Tu=ku.exports,Eu=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t._v(" PluginStateGrid ")])},Su=[],Cu={name:"PluginStateGrid"},Fu=Cu,Nu=Object(gu["a"])(Fu,Eu,Su,!1,null,null,null),Pu=Nu.exports,Wu=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t._v(" PluginStateRoom ")])},Lu=[],Hu={name:"PluginStateRoom"},Mu=Hu,Iu=Object(gu["a"])(Mu,Wu,Lu,!1,null,null,null),Du=Iu.exports,Ru=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t._v(" PluginStateRoomTool ")])},Au=[],_u={name:"PluginStateRoomTool"},Bu=_u,Vu=Object(gu["a"])(Bu,Ru,Au,!1,null,null,null),Xu=Vu.exports,Yu=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t._v(" PluginStateStructure ")])},zu=[],Uu={nameL:"PluginStateStructure"},Gu=Uu,Ku=Object(gu["a"])(Gu,Yu,zu,!1,null,null,null),qu=Ku.exports,Ju=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t._v(" PluginStateStructureTool ")])},Qu=[],Zu={name:"PluginStateStructureTool"},tc=Zu,ec=Object(gu["a"])(tc,Ju,Qu,!1,null,null,null),nc=ec.exports,rc=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t._v(" PluginStateWall ")])},ic=[],ac={name:"PluginStateWall"},oc=ac,sc=Object(gu["a"])(oc,rc,ic,!1,null,null,null),uc=sc.exports,cc=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t._v(" PluginStateWallTool ")])},lc=[],hc={name:"PluginStateWallTool"},fc=hc,dc=Object(gu["a"])(fc,cc,lc,!1,null,null,null),vc=dc.exports,pc=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t._v(" PluginStateNegative ")])},gc=[],yc={name:"PluginStateNegative"},bc=yc,mc=Object(gu["a"])(bc,pc,gc,!1,null,null,null),wc=mc.exports,$c=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"p-1"},[t._v(" PluginToolGrid ")])},Oc=[],xc={name:"PluginToolGrid",props:["drawing"],data:function(){return{showing:!0}},methods:{toggle:function(){var t=this.drawing;this.showing=!this.showing,this.showing?t.grid.hide():t.grid.show()}}},jc=xc,kc=Object(gu["a"])(jc,$c,Oc,!1,null,null,null),Tc=kc.exports,Ec=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"p-1"},[t._v(" PluginToolRoom ")])},Sc=[],Cc={name:"PluginToolRoom"},Fc=Cc,Nc=Object(gu["a"])(Fc,Ec,Sc,!1,null,null,null),Pc=Nc.exports,Wc=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"p-1"},[n("b-button-toolbar",{staticClass:"flex-nowrap"},[n("b-form-select",{staticClass:"mr-1 w-100",attrs:{options:t.materialList},model:{value:t.selectedMaterial,callback:function(e){t.selectedMaterial=e},expression:"selectedMaterial"}}),n("b-input-group",{staticClass:"mr-1 flex-nowrap",attrs:{prepend:"W"}},[n("b-form-input",{staticStyle:{width:"4em"},model:{value:t.width,callback:function(e){t.width=e},expression:"width"}})],1),n("b-input-group",{staticClass:"mr-1 flex-nowrap",attrs:{prepend:"H"}},[n("b-form-input",{staticStyle:{width:"4em"},model:{value:t.height,callback:function(e){t.height=e},expression:"height"}})],1),n("b-button",{staticClass:"text-nowrap",attrs:{variant:"info"},on:{click:function(e){return t.createFurniture()}}},[t._v("创建")])],1)],1)},Lc=[],Hc=Math.PI,Mc=60,Ic=15,Dc=10,Rc={stateless:{line:0,arcLine:14145753,fill:16777215,windowFill:13421772},hover:{line:8053503,arcLine:15464441,fill:16777215,windowFill:13421772},select:{line:4096759,arcLine:15068665,fill:16777215,windowFill:13421772}},Ac=function(t){var e=t.hover,n=t.focus,r=t.select;return r||n?Rc.select:e?Rc.hover:Rc.stateless},_c={width:800,render:function(t,e){var n=e.width,r=e.height,i=e.fliped,a=e.scale,o=i?1:0,s=Ic/a,u=Mc/a,c=Ac(e);return t.lineStyle(s,c.arcLine).beginFill(c.fill,.1).arc(n*o,r/2,n,-Hc/2*o-Hc/2,-Hc*o/2).lineTo(n*o,r/2).lineTo(0,r/2-n+o*n).endFill().beginFill(c.fill).lineStyle(s,c.fill).drawRect(0,0,n,r).lineStyle(s,c.line).moveTo(0,0).lineTo(0,r).moveTo(n,0).lineTo(n,r).lineStyle(s,c.line).drawRect((n-u)*o,r/2,u,-n),t.pivot.x=n/2,t.pivot.y=r/2,t}},Bc={width:1500,render:function(t,e){var n=e.width,r=e.height,i=e.scale,a=Ic/i,o=Mc/i,s=Ac(e);return t.lineStyle(a,s.arcLine).beginFill(s.fill,.1).arc(0,r/2,n/2,-Hc/2,0).lineTo(0,r/2).lineTo(0,(r-n)/2).endFill().beginFill(s.fill,.1).lineStyle(a,s.arcLine).arc(n,r/2,n/2,Hc,-Hc/2).lineTo(n,r/2).lineTo(n/2,r/2).endFill().beginFill(s.fill).lineStyle(a,s.fill).drawRect(0,0,n,r).lineStyle(a,s.line).moveTo(0,0).lineTo(0,r).moveTo(n,0).lineTo(n,r).drawRect(0,r/2,o,-n/2).drawRect(n,r/2,-o,-n/2),t.pivot.x=n/2,t.pivot.y=r/2,t}},Vc={width:1500,render:function(t,e){var n=e.width,r=e.height,i=e.scale,a=e.fliped,o=a?-1:1,s=Ic/i,u=Dc/i,c=Ac(e);return t.lineStyle(s,c.line).beginFill(c.fill).drawRect(0,0,n,r).drawRect(0+s+u,r/2,2*n/3,r/4*o).drawRect(n-s-u,r/2,-2*n/3,-r/4*o),t.pivot.x=n/2,t.pivot.y=r/2,t}},Xc={width:1450,render:function(t,e){var n=e.width,r=e.height,i=e.fliped,a=e.scale,o=i?1:0,s=Ic/a,u=Ac(e);return t.lineStyle(s,u.line).beginFill(u.fill).drawRect(0,0,n,r).moveTo(0,r/3).lineTo(n,r/3).moveTo(0,2*r/3).lineTo(n,2*r/3).moveTo(n/4+o*n/2,r/3).lineTo(n/4+o*n/2,2*r/3).endFill(),t.pivot.x=n/2,t.pivot.y=r/2,t}},Yc={width:2e3,render:function(t,e){var n=e.width,r=e.height,i=e.scale,a=Ic/i,o=Ac(e);return t.lineStyle(a,o.fill).beginFill(o.fill).drawRect(0,0,n,r).endFill().lineStyle(a,o.line).drawRect(0,0,n,r/3).drawRect(0,2*r/3,n,r/3),t.pivot.x=n/2,t.pivot.y=r/2,t}},zc={width:800,render:function(t,e){var n=e.width,r=e.height,i=e.scale,a=Ic/i,o=Ac(e);return t.lineStyle(a,o.line).beginFill(o.fill).drawRect(0,0,n,r).moveTo(0,r/2).lineTo(n,r/2).endFill(),t.pivot.x=n/2,t.pivot.y=r/2,t}},Uc={width:1500,render:function(t,e){var n=e.width,r=e.scale,i=e.sillThickness,a=void 0===i?500/r:i,o=e.height,s=Ic/r,u=o,c=Ac(e);return t.lineStyle(s,c.line).beginFill(c.windowFill).drawRect(0,-a,n,a).endFill().beginFill(c.fill).moveTo(0,-o).lineTo(0,-a).lineTo(n,-a).lineTo(n,-o).lineTo(n+u,-o).lineTo(n+u,-(a+u)).lineTo(-u,-(a+u)).lineTo(-u,-o).lineTo(0,-o).endFill().moveTo(-u/2,-o).lineTo(-u/2,-(a+u/2)).lineTo(n+u/2,-(a+u/2)).lineTo(n+u/2,-o),t.pivot.x=n/2,t.pivot.y=-o/2,t}},Gc={width:1500,render:function(t,e){var n=e.width,r=e.height,i=e.scale,a=Ic/i,o=Ac(e);return t.lineStyle(a,o.line).beginFill(o.fill).drawRect(0,0,n,r).endFill().moveTo(0,r/2).lineTo(n,r/2).moveTo(0,r/3).lineTo(n,r/3).moveTo(0,2*r/3).lineTo(n,2*r/3).moveTo(n/2,r/3).lineTo(n/2,2*r/3),t.pivot.x=n/2,t.pivot.y=r/2,t}},Kc={render:function(t,e){var n=e.leftWidth,r=e.rightWidth,i=e.leftWallThickness,a=e.rightWallThickness,o=e.scale,s=Ic/o,u=Ac(e);return t.lineStyle(s,u.line).beginFill(u.fill).moveTo(0,0).lineTo(r,0).lineTo(r,a).lineTo(i,a).lineTo(i,n).lineTo(0,n).lineTo(0,0).endFill().moveTo(i/2,n).lineTo(i/2,a/2).lineTo(r,a/2),t.pivot.x=r/2,t.pivot.y=a/2,t}},qc={render:function(t,e){var n=e.leftWidth,r=e.centerWidtn,i=e.rightWidth,a=e.leftWallThickness,o=e.centerWallThickness,s=e.rightWallThickness,u=e.scale,c=Ic/u,l=Ac(e);return t.lineStyle(c,l.line).beginFill(l.fill).moveTo(0,0).lineTo(r,0).lineTo(r,i).lineTo(r-s,i).lineTo(r-s,o).lineTo(a,o).lineTo(a,n).lineTo(0,n).lineTo(0,0).endFill().moveTo(a/2,n).lineTo(a/2,o/2).lineTo(r-s/2,o/2).lineTo(r-s/2,i),t.pivot.x=r/2,t.pivot.y=o/2,t}},Jc={render:function(t,e){var n=e.leftWidth,r=e.rightWidth,i=e.leftWindowThickness,a=e.rightWindowThickness,o=e.leftWallThickness,s=e.rightWallThickness,u=e.scale,c=Ic/u,l=Ac(e);return t.lineStyle(c,l.line).beginFill(l.windowFill).moveTo(o,s).lineTo(r,s).lineTo(r,s-a).lineTo(o-i,s-a).lineTo(o-i,n).lineTo(o,n).lineTo(o,s).endFill().beginFill(l.fill).moveTo(o-i,s-a).lineTo(r,s-a).lineTo(r,0).lineTo(r+s,0).lineTo(r+s,-a).lineTo(-i,-a).lineTo(-i,n+o).lineTo(0,n+o).lineTo(0,n).lineTo(o-i,n).lineTo(o-i,s-a).endFill().moveTo(0,n+o/2).lineTo(o/2-i,n+o/2).lineTo(o/2-i,s/2-a).lineTo(r+s/2,s/2-a).lineTo(r+s/2,0),t.pivot.x=r/2,t.pivot.y=s/2,t}},Qc={render:function(t,e){var n=e.leftWidth,r=e.centerWidtn,i=e.rightWidth,a=e.leftWindowThinkness,o=e.centerWindowThinkness,s=e.rightWindowThinkness,u=e.leftWallThickness,c=e.centerWallThickness,l=e.rightWallThickness,h=e.scale,f=Ic/h,d=Ac(e);return t.lineStyle(f,d.line).beginFill(d.windowFill).moveTo(u,c).lineTo(r-l,c).lineTo(r-l,i).lineTo(r-l+s,i).lineTo(r-l+s,c-o).lineTo(u-a,c-o).lineTo(u-a,n).lineTo(u,n).lineTo(u,c).endFill().beginFill(d.fill).moveTo(u-a,c-o).lineTo(r+s-l,c-o).lineTo(r+s-l,i).lineTo(r,i).lineTo(r,i+l).lineTo(r+s,i+l).lineTo(r+s,-o).lineTo(-a,-o).lineTo(-a,n+u).lineTo(0,n+u).lineTo(0,n).lineTo(u-a,n).lineTo(u-a,c-o).endFill().moveTo(0,n+u/2).lineTo(u/2-a,n+u/2).lineTo(u/2-a,c/2-o).lineTo(r+s-l/2,c/2-o).lineTo(r+s-l/2,i+l/2).lineTo(r,i+l/2),t.pivot.x=r/2,t.pivot.y=c/2,t}},Zc=[{text:"门",value:"singleDoor",content:$.SingleDoor},{text:"双开门",value:"doubleDoor",content:$.DoubleDoor},{text:"移门",value:"slidingDoor",content:$.SlidingDoor},{text:"子母门",value:"parentDoor",content:$.ParentDoor},{text:"垭口",value:"bealock",content:$.Bealock},{text:"窗",value:"basicWindow",content:O.BasicWindow},{text:"飘窗",value:"boilerWindow",content:O.BoilerWindow},{text:"落地窗",value:"floorWindow",content:O.FloorWindow}],tl=[{text:"床",value:"bed",url:"https://qhyxpicoss.kujiale.com/r/2020/03/30/L4D1111ENDDVAXSVUGEJKFNNVCQD3WKVY8_199x225.png"},{text:"沙发",value:"sofa",url:"https://qhrenderpicoss.kujiale.com/r/2021/04/15/L4D1111ENDDV7Y72IBEJKVNWMVXL3WKVY8_303x104.png"}],el={name:"PluginToolRoomTool",props:["drawing"],data:function(){return{selectedMaterial:tl[0].value,width:1e3,height:1e3}},computed:{materialList:function(){return tl}},mounted:function(){this.init()},methods:{init:function(){var t,e=Object(I["a"])(tl);try{for(e.s();!(t=e.n()).done;){var n=t.value;y.registerUrl(n.value,n.url)}}catch(r){e.e(r)}finally{e.f()}},createFurniture:function(){this.drawing.roomTool.createFurniture(this.selectedMaterial,this.width,this.height)}}},nl=el,rl=Object(gu["a"])(nl,Wc,Lc,!1,null,null,null),il=rl.exports,al=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"p-1"},[n("b-button-toolbar",{staticClass:"flex-nowrap mb-1"},[n("b-input-group",{staticClass:"mr-1 flex-nowrap",attrs:{prepend:"F"}},[n("b-form-input",{model:{value:t.fromX,callback:function(e){t.fromX=e},expression:"fromX"}}),n("b-form-input",{model:{value:t.fromY,callback:function(e){t.fromY=e},expression:"fromY"}})],1),n("b-input-group",{staticClass:"mr-1 flex-nowrap",attrs:{prepend:"T"}},[n("b-form-input",{model:{value:t.toX,callback:function(e){t.toX=e},expression:"toX"}}),n("b-form-input",{model:{value:t.toY,callback:function(e){t.toY=e},expression:"toY"}})],1),n("b-button",{staticClass:"text-nowrap",attrs:{variant:"info"},on:{click:function(e){return t.createWall()}}},[t._v("创建")])],1)],1)},ol=[],sl={name:"PluginToolStructure",props:["drawing"],data:function(){return{fromX:0,fromY:0,toX:0,toY:0}},methods:{createWall:function(){var t=this.fromX,e=this.fromY,n=this.toX,r=this.toY;if(t!==n||e!==r){var i=this.drawing,a=i.structure.queryCorner(Number(t),Number(e))||i.structure.createCorner(Number(t),Number(e)),o=i.structure.queryCorner(Number(n),Number(r))||i.structure.createCorner(Number(n),Number(r));return i.structure.createWall(a,o)}console.log("from and to can not be same")}}},ul=sl,cl=Object(gu["a"])(ul,al,ol,!1,null,null,null),ll=cl.exports,hl=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"p-1"},[n("b-button",{attrs:{variant:"info"},on:{click:function(e){return t.createWall()}}},[t._v("Create Wall")]),n("b-form-radio-group",{attrs:{options:t.radiosOptionsList,buttons:"",stacked:"","button-variant":"outline-primary"},model:{value:t.enabled,callback:function(e){t.enabled=e},expression:"enabled"}})],1)},fl=[],dl={WALL_BUILDER:0,WALL_SPLITER:1,CORNER_ADJUSTER:2},vl={name:"PluginToolStructureTool",props:["drawing"],data:function(){return{enabled:null}},computed:{radiosOptionsList:function(){return[{text:"Idle",value:null},{text:"WallBuilder",value:dl.WALL_BUILDER},{text:"WallSpliter",value:dl.WALL_SPLITER},{text:"CornerAdjuster",value:dl.CORNER_ADJUSTER}]}},methods:{createWall:function(){var t=this,e=this.drawing,n=e.structureTool.WallBuilder;n.begin();var r=function(t){var e,n=t.to;(e=t.begin()).setFrom.apply(e,Object(B["a"])(n))};n.on("build",r);var i=function(){t.$nextTick((function(){n.cancel().begin()}))};e.structure.on("room-created",i);var a=function t(a){"Escape"===a.code&&(n.cancel(),n.off("build",r),e.structure.off("room-created",i),window.removeEventListener("keydown",t))};window.addEventListener("keydown",a)}}},pl=vl,gl=Object(gu["a"])(pl,hl,fl,!1,null,null,null),yl=gl.exports,bl=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"p-1"},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.hollow,expression:"hollow"}],staticClass:"mt-1"},[n("b-button-toolbar",{staticClass:"flex-nowrap"},[n("b-form-select",{staticClass:"mr-1 w-100",attrs:{options:t.materialList},on:{change:t.changeHollowMaterial},model:{value:t.hollowInfo.materialName,callback:function(e){t.$set(t.hollowInfo,"materialName",e)},expression:"hollowInfo.materialName"}}),n("b-input-group",{staticClass:"mr-1 flex-nowrap",attrs:{prepend:"width"}},[n("b-form-input",{staticStyle:{width:"5em"},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.changeHollowWidth.apply(null,arguments)}},model:{value:t.hollowInfo.width,callback:function(e){t.$set(t.hollowInfo,"width",e)},expression:"hollowInfo.width"}})],1),n("b-button",{staticClass:"mr-1 text-nowrap",attrs:{variant:"info"},on:{click:function(e){return t.flipHollow()}}},[t._v("flip")])],1)],1),n("div",{directives:[{name:"show",rawName:"v-show",value:!t.hollow,expression:"!hollow"}]},[t._v("No Focusing Hollow")])])},ml=[],wl=(n("9129"),100),$l={name:"CoreTool",props:["drawing"],data:function(){return{hollow:null,hollowInfo:{width:0,widthClone:0,materialName:""}}},computed:{materialList:function(){return Zc}},mounted:function(){var t=this;this._interval=setInterval((function(){t.flush()}),wl)},destroyed:function(){clearInterval(this._interval)},methods:{flush:function(){this.drawing&&this.drawing.focusing&&"Hollow"===this.drawing.focusing.name?(this.hollow=this.drawing.focusing,this.initHollow()):this.hollow=null},initHollow:function(){var t=this.hollow,e=Math.round(t.width);e!==this.hollowInfo.widthClone&&(this.hollowInfo.width=e),this.hollowInfo.materialName=t.materialName,this.hollowInfo.widthClone=e},flipHollow:function(){this.hollow.flip()},changeHollowWidth:function(){var t=Number(this.hollowInfo.width);Number.isNaN(t)||this.hollow.setWidth(t)},changeHollowMaterial:function(){this.hollow.setMaterial(this.hollowInfo.materialName)}}},Ol=$l,xl=Object(gu["a"])(Ol,bl,ml,!1,null,null,null),jl=xl.exports,kl=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"p-1"},[n("b-button-toolbar",{staticClass:"flex-nowrap"},[n("b-form-select",{staticClass:"mr-1 w-100",attrs:{options:t.materialList},model:{value:t.selectedMaterial,callback:function(e){t.selectedMaterial=e},expression:"selectedMaterial"}}),n("b-button",{staticClass:"text-nowrap",attrs:{variant:"info"},on:{click:function(e){return t.createHollow()}}},[t._v("创建")])],1)],1)},Tl=[],El={name:"PluginToolWallTool",props:["drawing"],data:function(){return{selectedMaterial:Zc[0].value}},computed:{materialList:function(){return Zc}},mounted:function(){this.init()},methods:{init:function(){var t,e=Object(I["a"])(Zc);try{for(e.s();!(t=e.n()).done;){var n=t.value;g.register(n.value,n.content)}}catch(r){e.e(r)}finally{e.f()}},createHollow:function(){var t=this.drawing;t.wallTool.createHollow(this.selectedMaterial)}}},Sl=El,Cl=Object(gu["a"])(Sl,kl,Tl,!1,null,null,null),Fl=Cl.exports,Nl=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"p-1"},[n("b-button-toolbar",{directives:[{name:"show",rawName:"v-show",value:t.bitmapList.length>0,expression:"bitmapList.length > 0"}],staticClass:"flex-nowrap mb-1"},[n("b-button",{staticClass:"text-nowrap mr-1",staticStyle:{width:"100px"},attrs:{variant:"info"},on:{click:t.createBitmap}},[t._v("New")]),n("b-form-select",{staticClass:"w-100",attrs:{options:t.bitmapList},on:{change:t.bitmapSelectChange},model:{value:t.currentBitmap,callback:function(e){t.currentBitmap=e},expression:"currentBitmap"}})],1),n("b-button-toolbar",{directives:[{name:"show",rawName:"v-show",value:t.currentBitmap,expression:"currentBitmap"}],staticClass:"flex-nowrap mb-1"},[n("b-form-input",{staticStyle:{width:"75px"},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.alphaChange.apply(null,arguments)}},model:{value:t.alpha,callback:function(e){t.alpha=e},expression:"alpha"}}),n("b-form-input",{attrs:{type:"range",min:"0",max:"1",step:"0.1"},on:{change:t.alphaChange},model:{value:t.alpha,callback:function(e){t.alpha=e},expression:"alpha"}})],1)],1)},Pl=[],Wl={name:"PluginToolNegative",props:["drawing"],data:function(){return{bitmapList:[{text:"no selected",value:null}],currentBitmap:null,alpha:1}},methods:{createBitmap:function(){var t=this;return Object(ja["a"])(regeneratorRuntime.mark((function e(){var n,r,i,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.drawing,r="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fpic.to8to.com%2Fcase%2F2006%2F23%2F20200623_6a750511c8d76b01310a6wvonv822qh0.jpg&refer=http%3A%2F%2Fpic.to8to.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1645100826&t=0437dfdfef1405d8c159efd7c130d5ec",e.next=4,n.negative.createBitmap(r);case 4:i=e.sent,a=t.bitmapList,a.push({text:"bitmap"+a.length,value:i});case 7:case"end":return e.stop()}}),e)})))()},bitmapSelectChange:function(t){console.log(t),t?this.activate(t):this.deactivate()},alphaChange:function(){this.currentBitmap.setAlpha(this.alpha)},activate:function(){var t=this.currentBitmap;this.drawing.negative.activate(t),this.alpha=t.alpha},deactivate:function(){this.drawing.negative.deactivate()}}},Ll=Wl,Hl=Object(gu["a"])(Ll,Nl,Pl,!1,null,null,null),Ml=Hl.exports,Il=[{stateComponent:Pu,toolComponent:Tc,title:"Grid"},{stateComponent:qu,toolComponent:ll,title:"Structure"},{stateComponent:nc,toolComponent:yl,title:"StructureTool"},{stateComponent:uc,toolComponent:jl,title:"Wall"},{stateComponent:vc,toolComponent:Fl,title:"WallTool"},{stateComponent:Du,toolComponent:Pc,title:"Room"},{stateComponent:Xu,toolComponent:il,title:"RoomTool"},{stateComponent:wc,toolComponent:Ml,title:"Negative"}],Dl="https://qhcmsoss.kujiale.com/ttex/L2HNXEIKN4FT2AABAAAAAAY8.jpg",Rl={name:"Framework",components:{CoreState:bu,CoreTool:Tu},data:function(){return{spoke:null,drawing:null,bitmap:null,stateShowingList:Il.map((function(){return!1})),toolShowingList:Il.map((function(){return!1}))}},mounted:function(){this.spoke=w,this.init()},computed:{componentList:function(){return Il}},methods:{init:function(){var t=window.d=this.drawing=new Nn;t.mount(this.$refs["drawing"]),t.on("pointerdown",(function(e){if(null===e.focusing){var n=t.origin,r=[e.pointerX,e.pointerY],i=function(e){var i=[e.pointerX-r[0],e.pointerY-r[1]];t.setOrigin(n[0]+i[0],n[1]+i[1])},a=function e(){t.off("pointermove",i),window.removeEventListener("mouseup",e)};t.on("pointermove",i),window.addEventListener("mouseup",a)}})),window.addEventListener("wheel",(function(e){e.deltaY>0?t.setScaleInMode(t.scale+1,1):t.setScaleInMode(t.scale-1,1)})),t.structure.on("room-created",(function(t){t.setFloor(Dl)}))},toggleState:function(t){this.$set(this.stateShowingList,t,!this.stateShowingList[t])},toggleTool:function(t){this.$set(this.toolShowingList,t,!this.toolShowingList[t])},createWall:function(){this.drawing.structureTool.buildWall()}}},Al=Rl,_l=Object(gu["a"])(Al,T,E,!1,null,null,null),Bl=_l.exports,Vl={components:{Framework:Bl}},Xl=Vl,Yl=Object(gu["a"])(Xl,j,k,!1,null,null,null),zl=Yl.exports,Ul=n("5f5b"),Gl=n("8f9c");window.PIXI=S,x["default"].use(Ul["a"],Gl),x["default"].config.productionTip=!1,new x["default"]({render:function(t){return t(zl)}}).$mount("#app")},6271:function(t){t.exports=JSON.parse('{"a":"0.0.0"}')},"6b9e":function(t){t.exports=JSON.parse('{"a":"0.0.0"}')},"8f9c":function(t){t.exports=JSON.parse('{"breakpoints":["xs","sm","md","lg","xl","xxl"],"formControls":{"size":"sm"},"BButton":{"variant":"secondary","size":"sm"},"BToast":{"toaster":"b-toaster-top-center","autoHideDelay":3000,"variant":"primary","toastClass":null,"headerClass":null,"bodyClass":null},"BModal":{"cancelVariant":"secondary","okVariant":"primary"},"BFormGroup":{"size":"sm"},"BInputGroup":{"size":"sm"}}')},"9acd":function(t){t.exports=JSON.parse('{"a":"0.0.0"}')},dbc3:function(t){t.exports=JSON.parse('{"a":"0.0.0"}')},f8cf:function(t){t.exports=JSON.parse('{"a":"0.0.0"}')}});