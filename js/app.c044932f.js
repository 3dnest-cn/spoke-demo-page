(function(t){function e(e){for(var r,a,s=e[0],c=e[1],u=e[2],h=0,f=[];h<s.length;h++)a=s[h],Object.prototype.hasOwnProperty.call(i,a)&&i[a]&&f.push(i[a][0]),i[a]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);l&&l(e);while(f.length)f.shift()();return o.push.apply(o,u||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],r=!0,s=1;s<n.length;s++){var c=n[s];0!==i[c]&&(r=!1)}r&&(o.splice(e--,1),t=a(a.s=n[0]))}return t}var r={},i={app:0},o=[];function a(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=t,a.c=r,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)a.d(n,r,function(e){return t[e]}.bind(null,r));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var u=0;u<s.length;u++)e(s[u]);var l=c;o.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"0aa2":function(t){t.exports=JSON.parse('{"a":"0.0.0"}')},1227:function(t,e,n){},"2bbc":function(t){t.exports=JSON.parse('{"a":"0.0.0"}')},"2c55":function(t){t.exports=JSON.parse('{"a":"0.0.0"}')},"3d04":function(t){t.exports=JSON.parse('{"a":"0.0.0"}')},"3d1c":function(t){t.exports=JSON.parse('{"a":"0.0.0"}')},"49a4":function(t){t.exports=JSON.parse('{"a":"0.0.0"}')},"56d7":function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"PI",(function(){return vt})),n.d(r,"ROUND",(function(){return yt}));var i={};n.r(i),n.d(i,"Line",(function(){return bt})),n.d(i,"Vector",(function(){return wt})),n.d(i,"Segment",(function(){return xt})),n.d(i,"Point",(function(){return jt}));var o={};n.r(o),n.d(o,"fromBothPoint",(function(){return kt})),n.d(o,"fromSegment",(function(){return Et})),n.d(o,"from",(function(){return St})),n.d(o,"dot",(function(){return Ct})),n.d(o,"multiply",(function(){return Pt})),n.d(o,"cross",(function(){return Lt})),n.d(o,"length",(function(){return Ft})),n.d(o,"rotate90",(function(){return Dt})),n.d(o,"normalize",(function(){return Nt})),n.d(o,"invert",(function(){return Wt})),n.d(o,"rotate",(function(){return At})),n.d(o,"project",(function(){return It}));var a={};n.r(a),n.d(a,"setTolerance",(function(){return Rt})),n.d(a,"EQ_0",(function(){return Ht})),n.d(a,"EQ",(function(){return Bt})),n.d(a,"GT",(function(){return _t})),n.d(a,"GE",(function(){return Vt})),n.d(a,"LT",(function(){return zt})),n.d(a,"LE",(function(){return Ut}));var s={};n.r(s),n.d(s,"fromSegment",(function(){return Jt})),n.d(s,"toStandard",(function(){return ne})),n.d(s,"intersectLine",(function(){return ie}));var c={};n.r(c),n.d(c,"translate",(function(){return Tt})),n.d(c,"toLeftOfSegment",(function(){return Yt})),n.d(c,"rotate",(function(){return Gt})),n.d(c,"project",(function(){return Kt})),n.d(c,"distanceToPoint",(function(){return Xt})),n.d(c,"distanceToLine",(function(){return qt})),n.d(c,"distanceToSegment",(function(){return oe})),n.d(c,"equal",(function(){return ae}));var u={};n.r(u),n.d(u,"differ",(function(){return se}));var l={};n.r(l),n.d(l,"intersectSegment",(function(){return ue})),n.d(l,"translate",(function(){return le})),n.d(l,"middle",(function(){return he}));var h={};n.r(h),n.d(h,"containsPoint",(function(){return fe})),n.d(h,"area",(function(){return de}));var f={};n.r(f),n.d(f,"Vertex",(function(){return pe})),n.d(f,"HalfEdge",(function(){return ve})),n.d(f,"Face",(function(){return ye}));var d={};n.r(d),n.d(d,"allHalfEdgeOfVertex",(function(){return me})),n.d(d,"allHalfEdgeOfPath",(function(){return $e}));var p={};n.r(p),n.d(p,"Struct",(function(){return f})),n.d(p,"Iterator",(function(){return d})),n.d(p,"createVertex",(function(){return xe})),n.d(p,"getVertexHalfEdgeList",(function(){return Oe})),n.d(p,"hasNoHalfEdge",(function(){return je})),n.d(p,"hasOnlyHalfEdge",(function(){return Te})),n.d(p,"getAngleOfHalfEdge",(function(){return ke})),n.d(p,"isPathContainsHalfEdge",(function(){return Ee})),n.d(p,"isPathContainsVertex",(function(){return Se})),n.d(p,"isTwinInSamePath",(function(){return Ce})),n.d(p,"getPathOfHalfEdge",(function(){return Pe})),n.d(p,"isOuterPath",(function(){return Fe})),n.d(p,"isInnerPath",(function(){return De})),n.d(p,"splitHalfEdgeByVertex",(function(){return Ne})),n.d(p,"getPolygonFromFaceOuter",(function(){return Ae})),n.d(p,"getFaceOfPoint",(function(){return Re})),n.d(p,"createGlobalFace",(function(){return He})),n.d(p,"queryChildFaceList",(function(){return Me}));var v={};n.r(v),n.d(v,"EventType",(function(){return Be})),n.d(v,"EventListener",(function(){return _e})),n.d(v,"PointAxis",(function(){return Ve})),n.d(v,"Point",(function(){return ze}));var y={};n.r(y),n.d(y,"_",(function(){return Ye})),n.d(y,"Element",(function(){return qe})),n.d(y,"Plugin",(function(){return Je})),n.d(y,"Emitter",(function(){return Ge})),n.d(y,"Tool",(function(){return Qe})),n.d(y,"ToolProvider",(function(){return Ze})),n.d(y,"Creator",(function(){return tn}));var g={};n.r(g),n.d(g,"define",(function(){return rn}));var b={};n.r(b),n.d(b,"Assert",(function(){return v})),n.d(b,"Proxy",(function(){return y})),n.d(b,"Options",(function(){return g}));var m={};n.r(m),n.d(m,"CENTER",(function(){return Pr})),n.d(m,"CURRENT_POINTER",(function(){return Lr}));var w={};n.r(w),n.d(w,"define",(function(){return Ar}));var $={};n.r($),n.d($,"READY",(function(){return Mn})),n.d($,"define",(function(){return Ir}));var x={};n.r(x),n.d(x,"Element",(function(){return w})),n.d(x,"Tool",(function(){return $})),n.d(x,"define",(function(){return Mr}));var O={};n.r(O),n.d(O,"define",(function(){return Rr}));var j={};n.r(j),n.d(j,"Drawing",(function(){return Wr})),n.d(j,"SCALE_MODE",(function(){return m})),n.d(j,"use",(function(){return or})),n.d(j,"PIXI",(function(){return cn})),n.d(j,"Installer",(function(){return O})),n.d(j,"Plugin",(function(){return x})),n.d(j,"Utils",(function(){return b})),n.d(j,"_",(function(){return Hr}));var T={};n.r(T),n.d(T,"register",(function(){return Yr})),n.d(T,"HollowProxy",(function(){return Kr})),n.d(T,"default",(function(){return Jr}));var k={};n.r(k),n.d(k,"register",(function(){return ti})),n.d(k,"registerUrl",(function(){return ei})),n.d(k,"StuffProxy",(function(){return ai})),n.d(k,"default",(function(){return ui}));var E={};n.r(E),n.d(E,"PICKUP_FROM",(function(){return is})),n.d(E,"PICKUP_TO",(function(){return os}));var S={};n.r(S),n.d(S,"Indicator",(function(){return rs})),n.d(S,"Tool",(function(){return cs})),n.d(S,"STATE",(function(){return E}));var C={};n.r(C),n.d(C,"WAITING",(function(){return Ls})),n.d(C,"ACTIVE",(function(){return Fs}));var P={};n.r(P),n.d(P,"Indicator",(function(){return Ps})),n.d(P,"Tool",(function(){return Ns})),n.d(P,"STATE",(function(){return C}));var L={};n.r(L),n.d(L,"WAITING",(function(){return As})),n.d(L,"ACTIVE",(function(){return Is}));var F={};n.r(F),n.d(F,"Indicator",(function(){return Ws})),n.d(F,"Tool",(function(){return _s})),n.d(F,"STATE",(function(){return L}));var D={};n.r(D),n.d(D,"DETECTING",(function(){return Us})),n.d(D,"DETECTED",(function(){return Ys}));var N={};n.r(N),n.d(N,"Indicator",(function(){return zs})),n.d(N,"Tool",(function(){return qs})),n.d(N,"STATE",(function(){return D}));var W={};n.r(W),n.d(W,"PICKUP_FROM",(function(){return Qs})),n.d(W,"PICKUP_TO",(function(){return Zs}));var A={};n.r(A),n.d(A,"Indicator",(function(){return Js})),n.d(A,"Tool",(function(){return ic})),n.d(A,"STATE",(function(){return W}));var I={};n.r(I),n.d(I,"Builder",(function(){return E})),n.d(I,"Extender",(function(){return C})),n.d(I,"Mover",(function(){return L})),n.d(I,"Spliter",(function(){return D})),n.d(I,"Chamber",(function(){return W}));var M={};n.r(M),n.d(M,"STATE",(function(){return I})),n.d(M,"default",(function(){return oc}));var R={};n.r(R),n.d(R,"BitmapProxy",(function(){return uc})),n.d(R,"default",(function(){return dc}));var H={};n.r(H),n.d(H,"BaseAdaptor",(function(){return xu})),n.d(H,"is",(function(){return ju}));var B={};n.r(B),n.d(B,"TextLabeler",(function(){return Qu})),n.d(B,"LineLabeler",(function(){return Gu}));var _={};n.r(_),n.d(_,"STATE",(function(){return B})),n.d(_,"default",(function(){return el}));var V={};n.r(V),n.d(V,"Windoor",(function(){return T})),n.d(V,"Furniture",(function(){return k})),n.d(V,"Negative",(function(){return R})),n.d(V,"Bricklayer",(function(){return M})),n.d(V,"Label",(function(){return _}));var z={};n.r(z),n.d(z,"SingleDoor",(function(){return cl})),n.d(z,"DoubleDoor",(function(){return ul})),n.d(z,"SlidingDoor",(function(){return ll})),n.d(z,"ParentDoor",(function(){return hl})),n.d(z,"Bealock",(function(){return fl}));var U={};n.r(U),n.d(U,"BasicWindow",(function(){return dl})),n.d(U,"BoilerWindow",(function(){return pl})),n.d(U,"FloorWindow",(function(){return vl})),n.d(U,"LWindow",(function(){return yl})),n.d(U,"UWindow",(function(){return gl})),n.d(U,"LBoilerWindow",(function(){return bl})),n.d(U,"UBoilerWindow",(function(){return ml}));var Y={};n.r(Y),n.d(Y,"wallMaterialList",(function(){return wl})),n.d(Y,"windoorRegistry",(function(){return $l}));var G={};n.r(G),n.d(G,"PreventDefaultContextMenu",(function(){return xl})),n.d(G,"AdjustViewportByPointerButton",(function(){return Ol})),n.d(G,"AdjustZoomByWheel",(function(){return jl})),n.d(G,"SetDefaultFloor",(function(){return Tl}));var K={};n.r(K),n.d(K,"TRANSFORMER",(function(){return kl})),n.d(K,"SELECTOR",(function(){return El})),n.d(K,"WALL_BUILDER",(function(){return Sl})),n.d(K,"SPLITER",(function(){return Cl})),n.d(K,"CHAMBER",(function(){return Pl})),n.d(K,"VIEWPORT",(function(){return Ll})),n.d(K,"LABEL",(function(){return Fl}));var X={};n.r(X),n.d(X,"Symbol",(function(){return K})),n.d(X,"Constructor",(function(){return Nl}));var q={};n.r(q),n.d(q,"Provider",(function(){return Al}));var J={};n.r(J),n.d(J,"Provider",(function(){return Il}));var Q={};n.r(Q),n.d(Q,"MovingByWASD",(function(){return Rl}));var Z={};n.r(Z),n.d(Z,"all",(function(){return _l}));var tt={};n.r(tt),n.d(tt,"Surface",(function(){return Z}));var et={};n.r(et),n.d(et,"Provider",(function(){return Ql}));var nt={};n.r(nt),n.d(nt,"Editor",(function(){return nh}));n("e260"),n("e6cf"),n("cca6"),n("a79d"),n("1227");var rt=n("2b0e"),it=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("framework",{staticClass:"h-100"})},ot=[],at=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"d-flex flex-column h-100",staticStyle:{"font-size":"12px","user-select":"none"}},[n("div",{staticClass:"border-bottom p-1 text-monospace",staticStyle:{"min-height":"32px"}},[n("keep-alive",[n(t.currentToolDetail,{tag:"component",model:{value:t.floorState,callback:function(e){t.floorState=e},expression:"floorState"}})],1)],1),n("div",{staticClass:"d-flex text-monospace flex-grow-1"},[n("b-button-toolbar",{staticClass:"flex-column flex-nowrap justify-content-between"},[n("panel",{on:{changeTool:t.changeToolDetail}}),n("div",[n("example"),n("persistence",{model:{value:t.floorState,callback:function(e){t.floorState=e},expression:"floorState"}})],1)],1),n("div",{ref:"drawing",staticClass:"overflow-hidden",staticStyle:{flex:"1","line-height":"0"}})],1),n("div",{staticClass:"position-absolute m-2",staticStyle:{right:"0",bottom:"0","background-color":"#FFF"}},[n("state")],1)])},st=[],ct=n("0402"),ut=(n("d81d"),n("d3b7"),n("159b"),n("ac84")),lt=n("2d58"),ht=n("2fe6"),ft=n("0bd7"),dt=(n("99af"),n("dca8"),n("caad"),n("2532"),n("07ac"),n("3338")),pt=Math,vt=pt.PI,yt=2*vt,gt=[0,0,1,0],bt=function(t,e,n,r){return gt[0]=t,gt[1]=e,gt[2]=n,gt[3]=r,gt},mt=[0,0],wt=function(t,e){return mt[0]=t,mt[1]=e,mt},$t=[0,0,0,0],xt=function(t,e,n,r){return $t[0]=t,$t[1]=e,$t[2]=n,$t[3]=r,$t},Ot=[0,0],jt=function(t,e){return Ot[0]=t,Ot[1]=e,Ot},Tt=function(t,e,n,r){return jt(t+n,e+r)},kt=function(t,e,n,r){return wt(n-t,r-e)},Et=kt,St=kt,Ct=function(t,e,n,r){return t*n+e*r},Pt=function(t,e,n){return wt(t*n,e*n)},Lt=function(t,e,n,r){return t*r-e*n},Ft=function(t,e){return dt["c"].sqrt(Ct(t,e,t,e))},Dt=function(t,e){return wt(-e,t)},Nt=function(t,e){var n=Ft(t,e);return 0===n&&dt["b"].throwError("Zero Vector CAN NOT be normalized."),wt(t/n,e/n)},Wt=function(t,e){return wt(-t,-e)},At=function(t,e,n){var r=dt["c"].cos(n),i=dt["c"].sin(n);return wt(t*r-e*i,t*i+e*r)},It=function(t,e,n,r){var i=Nt(n,r);return Pt.apply(void 0,Object(ft["a"])(i).concat([Ct.apply(void 0,[t,e].concat(Object(ft["a"])(i)))]))},Mt=1e-6,Rt=function(t){Mt=t},Ht=function(t){return t<Mt&&t>-Mt},Bt=function(t,e){var n=t-e;return n<Mt&&n>-Mt},_t=function(t,e){return t-e>Mt},Vt=function(t,e){return t-e>-Mt},zt=function(t,e){return t-e<-Mt},Ut=function(t,e){return t-e<Mt},Yt=function(t,e,n,r,i,a){return _t(Lt.apply(o,Object(ft["a"])(kt(n,r,i,a)).concat(Object(ft["a"])(kt(i,a,t,e)))),0)},Gt=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=kt(r,i,t,e);return Tt.apply(void 0,Object(ft["a"])(At.apply(o,Object(ft["a"])(a).concat([n]))).concat([r,i]))},Kt=function(t,e,n,r,i,a){if(ae(t,e,n,r))return jt(t,e);var s=kt(t,e,n,r);return Ht(Lt.apply(o,Object(ft["a"])(s).concat([i,a])))?jt(n,r):Tt.apply(void 0,[t,e].concat(Object(ft["a"])(It.apply(o,Object(ft["a"])(s).concat([i,a])))))},Xt=function(t,e,n,r){return Ft.apply(o,Object(ft["a"])(kt(t,e,n,r)))},qt=function(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return Xt.apply(void 0,[t,e].concat(Object(ft["a"])(Kt.apply(void 0,[t,e].concat(r)))))},Jt=function(t,e,n,r){var a=Et(t,e,n,r),s=Dt.apply(o,Object(ft["a"])(Nt.apply(o,Object(ft["a"])(a)))),c=Ct.apply(o,Object(ft["a"])(s).concat([t,e])),u=zt(c,0)?s:Wt.apply(o,Object(ft["a"])(s));return bt.apply(i,[t,e].concat(Object(ft["a"])(u)))},Qt=[0,0,0],Zt=0,te=1,ee=2,ne=function(t,e,n,r){return Qt[Zt]=n,Qt[te]=r,Qt[ee]=Ct(n,r,t,e),Qt},re=n("26a3"),ie=function(t,e,n,r,i,o,a,s){var c=ne(t,e,n,r),u=Object(re["a"])(c,3),l=u[0],h=u[1],f=u[2],d=ne(i,o,a,s),p=Object(re["a"])(d,3),v=p[0],y=p[1],g=p[2],b=l*y-h*v,m=f*y-h*g,w=l*g-f*v;return Ht(b)?null:Ht(h)?bt(f/l,w/b):Ht(y)?bt(g/v,w/b):Ht(l)?bt(m/b,f/h):Ht(v)?bt(m/b,g/y):bt(m/b,w/b)},oe=function(t,e,n,r,i,o){return qt.apply(void 0,[t,e].concat(Object(ft["a"])(Jt(n,r,i,o))))},ae=function(t,e,n,r){return Bt(t,n)&&Bt(e,r)},se=function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=(n?1:-1)*(t-e);return r>=0?r:r+yt},ce=function(t,e,n,r,i,o){return(t-i)*(r-o)-(e-o)*(n-i)},ue=function(t,e,n,r,i,o,a,s){var c=ce(t,e,n,r,i,o),u=ce(t,e,n,r,a,s);if(Vt(c*u))return null;var l=ce(i,o,a,s,t,e),h=l+c-u;if(Vt(l*h,0))return null;var f=l/(u-c);return jt(t+f*(n-t),e+f*(r-e))},le=function(t,e,n,r,i,o){return xt(t+i,e+o,n+i,r+o)},he=function(t,e,n,r){return jt((t+n)/2,(e+r)/2)},fe=function(t,e){for(var n=!1,r=t.length,i=0,o=r-1;i<r;o=i++){var a=t[i],s=t[o],c=a.y>e.y!==s.y>e.y&&e.x<(e.y-a.y)/(s.y-a.y)*(s.x-a.x)+a.x;c&&(n=!n)}return n},de=function(){for(var t=arguments.length/2,e=0,n=0;n<t;n++){var r=(n+1)%t;e+=Lt(2*n<0||arguments.length<=2*n?void 0:arguments[2*n],2*n+1<0||arguments.length<=2*n+1?void 0:arguments[2*n+1],2*r<0||arguments.length<=2*r?void 0:arguments[2*r],2*r+1<0||arguments.length<=2*r+1?void 0:arguments[2*r+1])}return e/2},pe=Object(lt["a"])((function t(e,n){Object(ut["a"])(this,t),this.x=e,this.y=n,this.incidentEdge=null})),ve=Object(lt["a"])((function t(){Object(ut["a"])(this,t),this.origin=null,this.twin=null,this.incidentFace=null,this.next=null,this.previous=null})),ye=Object(lt["a"])((function t(){Object(ut["a"])(this,t),this.outerComponent=null,this.innerComponents=[]})),ge=(n("96cf"),9999),be=regeneratorRuntime.mark(me);function me(t){var e,n,r;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(e=t.incidentEdge,!dt["g"].Not.Null(e)){i.next=8;break}n=e,r=0;case 3:return i.next=5,n;case 5:n=n.twin.next,r++;case 7:if(n!==e&&r<ge){i.next=3;break}case 8:case"end":return i.stop()}}),be)}var we=regeneratorRuntime.mark($e);function $e(t){var e,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:e=t,n=0;case 1:return r.next=3,e;case 3:e=e.next,n++;case 5:if(e!==t&&n<ge){r.next=1;break}case 6:case"end":return r.stop()}}),we)}var xe=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new pe(t,e)},Oe=function(t){var e,n=[],r=Object(ct["a"])(me(t));try{for(r.s();!(e=r.n()).done;){var i=e.value;n.push(i)}}catch(o){r.e(o)}finally{r.f()}return n},je=function(t){return dt["g"].isNull(t.incidentEdge)},Te=function(t){return!je(t)&&t.incidentEdge===t.incidentEdge.twin.next},ke=function(t){var e=t.origin,n=e.x,r=e.y,i=t.twin.origin,o=i.x,a=i.y;return Math.atan2(a-r,o-n)},Ee=function(t,e){var n,r=Object(ct["a"])($e(t));try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i===e)return!0}}catch(o){r.e(o)}finally{r.f()}return!1},Se=function(t,e){var n,r=Object(ct["a"])($e(t));try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.origin===e)return!0}}catch(o){r.e(o)}finally{r.f()}return!1},Ce=function(t){return Ee(t,t.twin)},Pe=function(t){var e,n=[],r=Object(ct["a"])($e(t));try{for(r.s();!(e=r.n()).done;){var i=e.value;n.push(i)}}catch(o){r.e(o)}finally{r.f()}return n},Le=(n("aff5"),n("a9e3"),function(t){var e,n,r=null,i=-1/0;e=n=Number.MAX_SAFE_INTEGER;var o,a=Object(ct["a"])($e(t));try{for(a.s();!(o=a.n()).done;){var s=o.value,c=s.origin,u=c.x,l=c.y,h=s.next.origin,f=h.x,d=h.y,p=(d-l)/(f-u);(u<e||u===e&&l<n||u===e&&l===n&&p>i)&&(e=u,n=l,i=p,r=s)}}catch(v){a.e(v)}finally{a.f()}return r}),Fe=function(t){var e=Le(t),n=e.previous.twin;return n!==e&&se(ke(n),ke(e))<Math.PI},De=function(t){return!Fe(t)},Ne=function(t,e){var n=t,r=n.twin,i=new ve,o=new ve;e.incidentEdge=i,i.origin=o.origin=e,i.incidentFace=n.incidentFace,o.incidentFace=r.incidentFace,i.twin=r,r.twin=i,o.twin=n,n.twin=o;var a=n.next,s=r.next;return i.next=a,n.next=i,i.previous=n,a.previous=i,o.next=s,r.next=o,o.previous=r,s.previous=o,i},We=function(t){return t.origin},Ae=function(t){var e=t.outerComponent;return dt["g"].isNull(e)?[]:Pe(e).map(We)},Ie=(n("a434"),function(t,e,n){var r=t.twin.incidentFace;e.includes(r)||(e.push(r),n.push(r))}),Me=function(t){var e,n=[t],r=[],i=Object(ct["a"])(t.innerComponents);try{for(i.s();!(e=i.n()).done;){var o,a=e.value,s=Object(ct["a"])($e(a));try{for(s.s();!(o=s.n()).done;){var c=o.value;Ie(c,n,r)}}catch(v){s.e(v)}finally{s.f()}while(r.length){var u,l=Object(ct["a"])(r.splice(0));try{for(l.s();!(u=l.n()).done;){var h,f=u.value,d=Object(ct["a"])($e(f.outerComponent));try{for(d.s();!(h=d.n()).done;){var p=h.value;Ie(p,n,r)}}catch(v){d.e(v)}finally{d.f()}}}catch(v){l.e(v)}finally{l.f()}}}}catch(v){i.e(v)}finally{i.f()}return n.shift(),n},Re=function t(e,n){var r=!!dt["g"].isNull(e.outerComponent)||fe(Ae(e),n);if(r){var i,o=Object(ct["a"])(Me(e));try{for(o.s();!(i=o.n()).done;){var a=i.value,s=t(a,n);if(dt["g"].Not.Null(s))return s}}catch(c){o.e(c)}finally{o.f()}return e}return null},He=function(){return new ye},Be=function(t){dt["g"].Not.String(t)&&dt["b"].Throw.TypeError("Invalid event `type`, a string expected.")},_e=function(t){dt["g"].Not.Function(t)&&dt["b"].Throw.TypeError("In valid event `listener`, a function expected.")},Ve=function(t,e){dt["g"].Not.Number(t)&&dt["b"].Throw.TypeError("Invalid `".concat(e,"`, a number excepted."))},ze=function(t,e){Ve(t),Ve(e)},Ue=(n("3ca3"),n("10d1"),n("ddb0"),new WeakMap),Ye=function(t){return Ue.get(t)},Ge=function(){function t(e){Object(ut["a"])(this,t),Ue.set(this,e)}return Object(lt["a"])(t,[{key:"on",value:function(t,e){return Be(t),_e(e),Ye(this).$on(t,e),this}},{key:"off",value:function(t,e){return Be(t),_e(e),Ye(this).$off(t,e),this}}]),t}(),Ke=n("a007"),Xe=n("e3fc"),qe=function(t){Object(Ke["a"])(n,t);var e=Object(Xe["a"])(n);function n(t){return Object(ut["a"])(this,n),e.call(this,t)}return Object(lt["a"])(n,[{key:"$bounds",get:function(){return Ye(this).$getBounds()}}]),n}(Ge),Je=function(t){Object(Ke["a"])(n,t);var e=Object(Xe["a"])(n);function n(){return Object(ut["a"])(this,n),e.apply(this,arguments)}return Object(lt["a"])(n,[{key:"options",get:function(){return Ye(this).$options}},{key:"setOptions",value:function(){}}]),n}(Ge),Qe=function(t){Object(Ke["a"])(n,t);var e=Object(Xe["a"])(n);function n(){return Object(ut["a"])(this,n),e.apply(this,arguments)}return Object(lt["a"])(n,[{key:"$reset",value:function(){Ye(this).$reset()}},{key:"$state",get:function(){return Ye(this).$state}}]),n}(Ge),Ze=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=function(t){Object(Ke["a"])(n,t);var e=Object(Xe["a"])(n);function n(){return Object(ut["a"])(this,n),e.apply(this,arguments)}return Object(lt["a"])(n)}(Qe),r=Object(ct["a"])(e);try{var i=function(){var e=t.value;n.prototype[e]=function(){return Ye(this)[e](),this}};for(r.s();!(t=r.n()).done;)i()}catch(o){r.e(o)}finally{r.f()}return n},tn=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function(){var n=new t(this);return e?Object.freeze(n):n}},en=n("a34f");function nn(){this.forceUpdateAll()}var rn=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return en["a"](t,e,nn)},on=n("c20e"),an=(n("4ec9"),n("4743")),sn=n("dcb4"),cn=(n("b0c0"),n("4e82"),n("3a02")),un=n("493b"),ln=(n("6062"),n("af93"),g.define()),hn=g.define({capture:!0,autoResizing:!0},{snap:g.define({enable:!0,interval:20}),scale:g.define({max:100,min:1}),style:g.define({backgroundColor:{value:15790320,set:function(t){this.application.renderer.backgroundColor=t}},backgroundOpacity:{value:1,set:function(t){this.application.renderer.backgroundAlpha=t}},fontSize:12}),plugin:ln}),fn=function(t,e){var n=function(n){Object.defineProperty(t,n,{get:function(){return e[n].call(this)}})};for(var r in e)n(r)},dn=function(t,e){var n=function(n){var r=e[n];t[n]=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.call.apply(r,[this].concat(e))}};for(var r in e)n(r)},pn=new WeakMap,vn=function(t){return pn.get(t)},yn=function(t){Object(Ke["a"])(n,t);var e=Object(Xe["a"])(n);function n(t){var r;return Object(ut["a"])(this,n),r=e.call(this),r.context=null,r.drawing=t,r.elementCollectionMap={},r}return Object(lt["a"])(n,[{key:"forceUpdate",value:function(){for(var t in this.elementCollectionMap){var e,n=Object(ct["a"])(this.elementCollectionMap[t]);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.setDirty()}}catch(i){n.e(i)}finally{n.f()}}}}]),n}(sn["a"].Emitter),gn=yn,bn=(n("a630"),function(t){return t.context}),mn=function(t){dt["g"].Not.String(t)&&dt["b"].Throw.TypeError("Invalid `className`, a string excepted.")},wn=function(){function t(e,n){Object(ut["a"])(this,t),this.$id=e,this.$version=n,this.$proxy=this,this.$data=dt["e"].freeze({})}return Object(lt["a"])(t,[{key:"$drawing",get:function(){return vn(this).drawing.proxy}},{key:"$getElementList",value:function(t){mn(t);var e=vn(this).elementCollectionMap[t];return dt["g"].isUndefined(e)&&dt["b"].throwError("The Element named `".concat(t,"` is NOT existed in this Plugin.")),Array.from(e.values()).map(bn)}},{key:"$hideElement",value:function(t){mn(t);var e=vn(this).elementCollectionMap;if(t in e){var n,r=Object(ct["a"])(e[t]);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.hide()}}catch(o){r.e(o)}finally{r.f()}}}},{key:"$showElement",value:function(t){mn(t);var e=vn(this).elementCollectionMap;if(t in e){var n,r=Object(ct["a"])(e[t]);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.show()}}catch(o){r.e(o)}finally{r.f()}}}},{key:"$hideAll",value:function(){for(var t in vn(this).elementCollectionMap)this.$hideElement(t)}},{key:"$showAll",value:function(){for(var t in vn(this).elementCollectionMap)this.$showElement(t)}},{key:"$forceUpdate",value:function(){vn(this).forceUpdate()}},{key:"$toCanvas",value:function(t,e){return v.Point(t,e),vn(this).drawing.coordinate.toCanvas(t,e)}},{key:"$toGeometry",value:function(t,e){return v.Point(t,e),vn(this).drawing.coordinate.toGeometry(t,e)}},{key:"$on",value:function(t,e){return v.EventType(t),v.EventListener(e),vn(this).on(t,e),this}},{key:"$off",value:function(t,e){return v.EventType(t),v.EventListener(e),vn(this).off(t,e),this}},{key:"$emit",value:function(t){var e;v.EventType(t);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return(e=vn(this)).emit.apply(e,[t].concat(r)),this}}]),t}(),$n=function(t,e,n,r,i){ln.appendChild(t,n.options);var o=function(t){Object(Ke["a"])(n,t);var e=Object(Xe["a"])(n);function n(t){var i;for(var o in Object(ut["a"])(this,n),i=e.call(this,t),r)i.elementCollectionMap[o]=new Set;return pn.set(i.context=new a,Object(on["a"])(i)),i}return Object(lt["a"])(n)}(gn),a=function(o){Object(Ke["a"])(s,o);var a=Object(Xe["a"])(s);function s(){var r;return Object(ut["a"])(this,s),r=a.call(this,t,e),r.$proxy=n.proxy.call(Object(on["a"])(r)),r.$data=dt["e"].seal(n.data()),dt["e"].freeze(Object(on["a"])(r)),r}return Object(lt["a"])(s,[{key:"$options",get:function(){return this.$drawing.options.plugin[t]}},{key:"$createElement",value:function(t){mn(t);var e=r[t].Element;dt["g"].isUndefined(e)&&dt["b"].throwError("The Element named `".concat(t,"` is NOT existed."));for(var n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];var a=Object(un["a"])(e,[vn(this)].concat(i)).context;return this.$emit("element-created",a.$proxy,t),a}},{key:"$createTool",value:function(t){var e=i[t];dt["g"].isUndefined(e)&&dt["b"].throwError("The Element named `".concat(t,"` is NOT existed."));var n=new e(this),r=n.context;return r.$proxy}}]),s}(wn);return dn(a.prototype,n.methods),fn(a.prototype,n.getters),o},xn=n("e5cd"),On=n("0384"),jn=new Set,Tn=new cn["Container"],kn=new WeakMap,En=function(t){return kn.get(t)},Sn=function(t){Object(Ke["a"])(n,t);var e=Object(Xe["a"])(n);function n(t){var r;return Object(ut["a"])(this,n),r=e.call(this),r.plugin=t,r.context=null,r.graphics=null,r.isDirty=!1,r._update=dt["d"],r.destroyed=!1,r.collection.add(Object(on["a"])(r)),r}return Object(lt["a"])(n,[{key:"renderable",get:function(){return!1}},{key:"interactive",get:function(){return!1}},{key:"hoverable",get:function(){return!1}},{key:"focusable",get:function(){return!1}},{key:"selectable",get:function(){return!1}},{key:"draggable",get:function(){return!1}},{key:"drawing",get:function(){return this.plugin.drawing}},{key:"selecting",get:function(){return this.drawing.state.selecting===this}},{key:"hovering",get:function(){return this.drawing.state.hovering===this}},{key:"holding",get:function(){return this.drawing.state.holding===this}},{key:"focusing",get:function(){return this.drawing.state.focusing===this}},{key:"hover",value:function(){dt["g"].isNull(this.drawing.state.holding)&&(this.drawing.setHovering(this),this.setDirty())}},{key:"cancelHover",value:function(){this.drawing.setHovering(),this.setDirty()}},{key:"focus",value:function(){var t=this.drawing.state.focusing;t!==this&&(this.drawing.setFocusing(this),Cn(this,"focus"),this.setDirty())}},{key:"emitBlur",value:function(){Cn(this,"blur"),this.setDirty()}},{key:"hold",value:function(){this.drawing.setHolding(this),this.setDirty()}},{key:"release",value:function(){this.drawing.setHolding(),this.setDirty()}},{key:"group",get:function(){return Tn}},{key:"application",get:function(){return this.drawing.application}},{key:"collection",get:function(){return jn}},{key:"show",value:function(){this.graphics.visible=!0,this.setDirty()}},{key:"hide",value:function(){this.graphics.visible=!1,this.setDirty()}},{key:"setDirty",value:function(){this.destroyed||this.isDirty||(this.isDirty=!0,Cn(this,"dirty"))}},{key:"getBounds",value:function(){return this.graphics.getBounds()}},{key:"update",value:function(){this.isDirty&&(this.isDirty=!1,this.graphics.clear(),this.graphics.visible&&(this._update(this.graphics),Cn(this,"render")))}},{key:"destroy",value:function(){dt["g"].Not.Null(this.graphics)&&(this.hovering&&this.drawing.setHovering(),this.focusing&&this.drawing.setFocusing(),this.holding&&this.drawing.setHolding(),this.graphics.destroy(),this.application.ticker.remove(this.observer)),this.collection.delete(this),this.destroyed=!0,Cn(this,"destroy"),sn["a"].destroy(this)}}]),n}(sn["a"].Emitter),Cn=function(t,e){t.emit(e,t.drawing.globalEvent.accessor)},Pn=Sn,Ln=dt["e"].freeze({}),Fn=function(){function t(){Object(ut["a"])(this,t),this.$proxy=this,this.$state=Ln}return Object(lt["a"])(t,[{key:"$graphics",get:function(){return En(this).graphics}},{key:"$data",get:function(){return En(this).plugin.context.$data}},{key:"$drawing",get:function(){return En(this).drawing.proxy}},{key:"$selecting",get:function(){return En(this).selecting}},{key:"$focusing",get:function(){return En(this).focusing}},{key:"$hovering",get:function(){return En(this).hovering}},{key:"$holding",get:function(){return En(this).holding}},{key:"$visible",get:function(){return En(this).graphics.visible}},{key:"$isDirty",get:function(){return En(this).isDirty}},{key:"$getBounds",value:function(){return En(this).getBounds()}},{key:"$show",value:function(){En(this).show()}},{key:"$hide",value:function(){En(this).hide()}},{key:"$setDirty",value:function(){En(this).setDirty()}},{key:"$destroy",value:function(){En(this).destroy()}},{key:"$on",value:function(t,e){return v.EventType(t),v.EventListener(e),En(this).on(t,e),this}},{key:"$off",value:function(t,e){return v.EventType(t),v.EventListener(e),En(this).off(t,e),this}},{key:"$emit",value:function(t){for(var e,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return(e=En(this)).emit.apply(e,[t].concat(r)),this}},{key:"$focus",value:function(){var t=En(this);t.focusable&&t.focus()}},{key:"$toCanvas",value:function(t,e){return v.Point(t,e),En(this).drawing.coordinate.toCanvas(t,e)}},{key:"$toGeometry",value:function(t,e){return v.Point(t,e),En(this).drawing.coordinate.toGeometry(t,e)}}]),t}(),Dn=Fn,Nn=["pointermove","pointerdown","pointerup","pointerover","pointerout"],Wn=function(t,e){var n=dt["g"].Not.Null(e.render),r=function(r){Object(Ke["a"])(a,r);var o=Object(Xe["a"])(a);function a(r){var s,c;Object(ut["a"])(this,a),c=o.call(this,r);var u=new i;if(n){var l=new cn["Graphics"];c.observer=function(){return c.update()},c.application.ticker.add(c.observer),c.group.addChild(l),c.graphics=l,c.graphics.name=t,c.graphics.interactive=e.interative,e.interative&&(Nn.forEach((function(t){l.on("".concat(t),(function(t){c.drawing.globalEvent.current=t}))})),l.on("pointermove",(function(){return Cn(Object(on["a"])(c),"pointermove")})).on("pointerover",(function(){return Cn(Object(on["a"])(c),"pointerover")})).on("pointerout",(function(){return Cn(Object(on["a"])(c),"pointerout")})).on("pointerdown",(function(){return Cn(Object(on["a"])(c),"pointerdown")})).on("pointerup",(function(){return Cn(Object(on["a"])(c),"pointerup")})),e.hoverable&&l.on("pointerover",(function(){return c.hover()})).on("pointerout",(function(){return c.cancelHover()})),e.draggable&&l.on("pointerdown",(function(){return c.hold()})).on("pointerup",(function(){return c.release()})),e.focusable&&l.on("pointerdown",(function(){return c.focus()}))),c._update=e.render.bind(u)}c.context=u,kn.set(u,Object(on["a"])(c));for(var h=arguments.length,f=new Array(h>1?h-1:0),d=1;d<h;d++)f[d-1]=arguments[d];return(s=e.created).call.apply(s,[u].concat(f)),c.setDirty(),c}return Object(lt["a"])(a,[{key:"renderable",get:function(){return n}},{key:"interactive",get:function(){return this.renderable&&e.interative}},{key:"hoverable",get:function(){return this.interactive&&e.hoverable}},{key:"focusable",get:function(){return this.interactive&&e.focusable}},{key:"selectable",get:function(){return this.interactive&&e.selectable}},{key:"draggable",get:function(){return this.interactive&&e.draggable}},{key:"group",get:function(){return this.plugin.drawing.groupMap.get(a)}},{key:"collection",get:function(){return this.plugin.elementCollectionMap[t]}}]),a}(Pn),i=function(n){Object(Ke["a"])(i,n);var r=Object(Xe["a"])(i);function i(){var t;return Object(ut["a"])(this,i),t=r.call(this),t.$proxy=e.proxy.call(Object(on["a"])(t)),t.$state=dt["e"].seal(e.state.call(Object(on["a"])(t))),dt["e"].freeze(Object(on["a"])(t)),t}return Object(lt["a"])(i,[{key:"$name",get:function(){return t}},{key:"$data",get:function(){return this.$plugin.$data}},{key:"$plugin",get:function(){return En(this).plugin.context}},{key:"$destroy",value:function(){Object(xn["a"])(Object(On["a"])(i.prototype),"$destroy",this).call(this),e.destroy.call(this)}}]),i}(Dn);return fn(i.prototype,e.getters),dn(i.prototype,e.methods),r},An=(n("a4d3"),n("e01a"),new WeakMap),In=function(t){return An.get(t)},Mn=Symbol("TOOL_READY"),Rn=function(t){Object(Ke["a"])(n,t);var e=Object(Xe["a"])(n);function n(){var t;return Object(ut["a"])(this,n),t=e.call(this),t.plugin=null,t.context=null,t.busy=!1,t.state=Mn,t.eventQueue=[],t}return Object(lt["a"])(n,[{key:"reset",value:function(){this.context.$reset(),this.emit("reset"),this.setIdle(Mn)}},{key:"setBusy",value:function(){this.busy=!0}},{key:"setIdle",value:function(t){this.busy=!1,this.state=t;var e=this.eventQueue;while(e.length){var r;(r=Object(xn["a"])(Object(On["a"])(n.prototype),"emit",this)).call.apply(r,[this].concat(Object(ft["a"])(e.pop())))}}},{key:"emit",value:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var i;this.busy?this.eventQueue.push(e):(i=Object(xn["a"])(Object(On["a"])(n.prototype),"emit",this)).call.apply(i,[this].concat(e));return this}}]),n}(sn["a"].Emitter),Hn=Rn,Bn=function(){function t(){Object(ut["a"])(this,t)}return Object(lt["a"])(t,[{key:"$state",get:function(){return In(this).state}},{key:"$plugin",get:function(){return In(this).plugin}},{key:"$on",value:function(t,e){return v.EventType(t),v.EventListener(e),In(this).on(t,e),this}},{key:"$off",value:function(t,e){return v.EventType(t),v.EventListener(e),In(this).off(t,e),this}},{key:"$emit",value:function(t){for(var e,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return(e=In(this)).emit.apply(e,[t].concat(r)),this}}]),t}(),_n=function(t,e){var n=e.data,r=e.actions,i=e.states,o=function(t){Object(Ke["a"])(n,t);var e=Object(Xe["a"])(n);function n(t){var r;return Object(ut["a"])(this,n),r=e.call(this,t),r.plugin=t,r.context=new a(Object(on["a"])(r)),t.$drawing.appendTool(Object(on["a"])(r)),r}return Object(lt["a"])(n)}(Hn),a=function(r){Object(Ke["a"])(o,r);var i=Object(Xe["a"])(o);function o(t){var r;return Object(ut["a"])(this,o),r=i.call(this),An.set(Object(on["a"])(r),t),r.$proxy=e.proxy.call(Object(on["a"])(r)),r.$data=dt["e"].seal(n.call(Object(on["a"])(r),t.plugin)),dt["e"].freeze(Object(on["a"])(r)),r}return Object(lt["a"])(o,[{key:"$name",get:function(){return t}},{key:"$reset",value:function(){e.reset.call(this),In(this).state=Mn}}]),o}(Bn),s=function(t){var e,n=r[t],o={},s=Object(ct["a"])(n);try{for(s.s();!(e=s.n()).done;){var c=Object(re["a"])(e.value,3),u=c[0],l=c[1],h=c[2];o[u]={handler:l,target:h,source:u}}}catch(f){s.e(f)}finally{s.f()}a.prototype[t]=function(){var e=In(this);e.busy&&dt["b"].throwError("It could NOT call an action during another action.");var n=o[this.$state];dt["g"].isUndefined(n)&&dt["b"].throwError(".".concat(t," can NOT be called from state(=").concat(String(this.$state),")."));var r=n.handler,a=n.target,s=n.source;return i[s].leave.call(this),e.setBusy(),r.call(this),i[a].entry.call(this),e.setIdle(a),this}};for(var c in r)s(c);var u=function(t){var n=e.methods[t];a.prototype[t]=function(){for(var t=this.$state,e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];var o=n.call.apply(n,[this].concat(r));return this.$state!==t&&dt["b"].throwError("A normal method could NOT be used to transit state."),o}};for(var l in e.methods)u(l);return o},Vn=function(){return{}},zn=function(t){var e={data:Vn,created:dt["d"],methods:{},getters:{},proxy:function(){return this},options:g.define()},n=t.data,r=void 0===n?e.data:n,i=t.created,o=void 0===i?e.created:i,a=t.methods,s=void 0===a?e.methods:a,c=t.getters,u=void 0===c?e.getters:c,l=t.proxy,h=void 0===l?e.proxy:l,f=t.options,d=void 0===f?e.options:f;for(var p in dt["g"].Not.Function(r)&&dt["b"].Throw.TypeError("Invalid `.data`, a function as constructor expected."),dt["g"].Not.Function(o)&&dt["b"].Throw.TypeError("Invalid `.created`, a function expected."),dt["g"].Not.Object(s)&&dt["b"].Throw.TypeError("Invalid `.methods`, an object expected."),s)dt["g"].Not.Function(s[p])&&dt["b"].Throw.TypeError("Invalid `.methods.".concat(p,"`, a function expected."));for(var v in dt["g"].Not.Object(u)&&dt["b"].Throw.TypeError("Invalid `.getters`, an object expected."),u)dt["g"].Not.Function(u[v])&&dt["b"].Throw.TypeError("Invalid `.getters.".concat(v,"`, a function expected."));return dt["g"].Not.Function(h)&&dt["b"].Throw.TypeError("Invalid `.proxy`, a function as constructor expected."),e.data=r,e.created=o,e.methods=s,e.getters=u,e.proxy=h,e.options=d,e},Un=function(){return{}},Yn=function(t){var e={groupIndex:0,interative:!1,hoverable:!1,focusable:!1,selectable:!1,draggable:!1,state:Un,render:null,created:dt["d"],destroy:dt["d"],methods:{},getters:{},proxy:function(){return this}},n=t.groupIndex,r=void 0===n?e.groupIndex:n,i=t.interative,o=void 0===i?e.interative:i,a=t.hoverable,s=void 0===a?e.hoverable:a,c=t.focusable,u=void 0===c?e.focusable:c,l=t.selectable,h=void 0===l?e.selectable:l,f=t.draggable,d=void 0===f?e.draggable:f,p=t.state,v=void 0===p?e.state:p,y=t.render,g=void 0===y?e.render:y,b=t.created,m=void 0===b?e.created:b,w=t.destroy,$=void 0===w?e.destroy:w,x=t.methods,O=void 0===x?e.methods:x,j=t.getters,T=void 0===j?e.getters:j,k=t.proxy,E=void 0===k?e.proxy:k;for(var S in dt["g"].Not.Number(r)&&dt["b"].Throw.TypeError("Invalid `.elements[].groupIndex`, a number expected."),dt["g"].Not.Boolean(o)&&dt["b"].Throw.TypeError("Invalid `.elements[].interative`, a boolean expected."),dt["g"].Not.Boolean(s)&&dt["b"].Throw.TypeError("Invalid `.elements[].hoverable`, a boolean expected."),dt["g"].Not.Boolean(u)&&dt["b"].Throw.TypeError("Invalid `.elements[].focusable`, a boolean expected."),dt["g"].Not.Boolean(h)&&dt["b"].Throw.TypeError("Invalid `.elements[].selectable`, a boolean expected."),dt["g"].Not.Boolean(d)&&dt["b"].Throw.TypeError("Invalid `.elements[].draggable`, a boolean expected."),dt["g"].Not.Function(v)&&dt["b"].Throw.TypeError("Invalid `.elements[].state`, a function expected."),dt["g"].Not.Function(g)&&dt["g"].Not.Null(g)&&dt["b"].Throw.TypeError("Invalid `.elements[].render`, a function or null expected."),dt["g"].Not.Function(m)&&dt["b"].Throw.TypeError("Invalid `.elements[].created`, a function expected."),dt["g"].Not.Function($)&&dt["b"].Throw.TypeError("Invalid `.elements[].destroy`, a function expected."),dt["g"].Not.Object(O)&&dt["b"].Throw.TypeError("Invalid `.elements[].methods`, an object as function map expected"),O)dt["g"].Not.Function(O[S])&&dt["b"].Throw.TypeError("Invalid `.elements[].methods.".concat(S,"`, a function expected."));for(var C in dt["g"].Not.Object(T)&&dt["b"].Throw.TypeError("Invalid `.elements[].getters`, an object as function map expected"),T)dt["g"].Not.Function(T[C])&&dt["b"].Throw.TypeError("Invalid `.elements[].getters.".concat(C,"`, a function expected."));return dt["g"].Not.Function(E)&&dt["b"].Throw.TypeError("Invalid `.proxy`, a function as constructor expected."),e.groupIndex=r,e.interative=o,e.hoverable=s,e.focusable=u,e.selectable=h,e.draggable=d,e.state=v,e.render=g,e.created=m,e.destroy=$,e.methods=O,e.getters=T,e.proxy=E,e},Gn=(n("1bf2"),function(){return{}}),Kn=[0,function(){return dt["b"].throwError("Not implemented.")},0],Xn=function(t){dt["g"].isArray(t)&&3===t.length&&dt["g"].isFunction(t[1])||dt["b"].Throw.TypeError("Invalid transition, a [source, function, target] expected.")},qn=function(t){if(dt["g"].Not.Array(t)&&dt["b"].Throw.TypeError("Invalid action transition, an array expected."),0===t.length)return[Kn];if(dt["g"].Not.Array(t[0]))return Xn(t),[t];var e,n=[],r=Object(ct["a"])(t);try{for(r.s();!(e=r.n()).done;){var i=e.value;Xn(i),n.push(i)}}catch(o){r.e(o)}finally{r.f()}return n},Jn=function(t){var e={};for(var n in dt["g"].Not.Object(t)&&dt["b"].Throw.TypeError("Invalid tool actions, a plain object expected."),t)e[n]=qn(t[n]);return e},Qn=Object.freeze({entry:dt["d"],leave:dt["d"]}),Zn=function(t){var e={entry:dt["d"],leave:dt["d"]},n=t.entry,r=void 0===n?e.entry:n,i=t.leave,o=void 0===i?e.leave:i;return dt["g"].Not.Function(r)&&dt["b"].Throw.TypeError("Invalid operation.entry, a function expected."),dt["g"].Not.Function(o)&&dt["b"].Throw.TypeError("Invalid operation.leave, a function expected."),e.entry=r,e.leave=o,e},tr=function(t,e){var n={};for(var r in e){var i=e[r];if(dt["g"].isArray(i[0])){var o,a=Object(ct["a"])(i);try{for(a.s();!(o=a.n()).done;){var s=o.value;n[s[0]]=n[s[2]]=Qn}}catch(f){a.e(f)}finally{a.f()}}else n[i[0]]=n[i[2]]=Qn}var c,u=Object(ct["a"])(dt["f"].ownKeys(t));try{for(u.s();!(c=u.n()).done;){var l=c.value,h=t[l];if(dt["g"].isUndefined(h))return;dt["g"].isObject(h)?n[l]=Zn(h):dt["g"].isFunction(h)?n[l]=Zn({entry:h}):dt["b"].Throw.TypeError("Invalid state operation, a function or expected.")}}catch(f){u.e(f)}finally{u.f()}return n},er=function(t){var e={states:{},actions:{},data:Gn,reset:dt["d"],methods:{},proxy:function(){return this}},n=t.states,r=void 0===n?e.states:n,i=t.actions,o=void 0===i?e.actions:i,a=t.data,s=void 0===a?e.data:a,c=t.reset,u=void 0===c?e.reset:c,l=t.methods,h=void 0===l?e.methods:l,f=t.proxy,d=void 0===f?e.proxy:f;for(var p in dt["g"].Not.Function(s)&&dt["b"].Throw.TypeError("Invalid `.tools[].data`, a function expected."),dt["g"].Not.Function(u)&&dt["b"].Throw.TypeError("Invalid `.tools[].reset`, a function expected."),dt["g"].Not.Function(d)&&dt["b"].Throw.TypeError("Invalid `.tools[].proxy`, a function expected."),h)dt["g"].Not.Function(h[p])&&dt["b"].Throw.TypeError("Invalid `.tools[].methods.".concat(p,"`, a function expected."));return e.actions=Jn(o),e.states=tr(r,o),e.data=s,e.reset=u,e.methods=h,e.proxy=d,e},nr=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e={namespace:null,version:null,dependencies:[],plugin:{},elements:{},tools:{}},n=t.id,r=t.version,i=t.namespace,o=void 0===i?e.namespace:i,a=t.dependencies,s=void 0===a?e.dependencies:a,c=t.plugin,u=void 0===c?e.plugin:c,l=t.elements,h=void 0===l?e.elements:l,f=t.tools,d=void 0===f?e.tools:f;if(dt["g"].Not.String(n)&&dt["b"].Throw.TypeError("Invalid `.id`, a string expected."),dt["g"].Not.String(r)&&dt["b"].Throw.TypeError("Invalid `.version`, string expected."),dt["g"].Not.String(o)&&dt["g"].Not.Null(o)&&dt["b"].Throw.TypeError("Invalid `.namespace`, a string or null expected."),dt["g"].Not.Array(s))dt["b"].Throw.TypeError("Invalid `.dependencies`, an array expected.");else{var p,v=Object(ct["a"])(s);try{for(v.s();!(p=v.n()).done;){var y=Object(re["a"])(p.value,2),g=y[0],b=y[1];dt["g"].Not.String(g)&&dt["b"].Throw.TypeError("Invalid `.dependencies[".concat(b,"]`, a string expected."))}}catch($){v.e($)}finally{v.f()}}for(var m in dt["g"].Not.Object(h)&&dt["b"].Throw.TypeError("Invalid `.elements`, an object as map expected."),e.id=n,e.version=r,e.namespace=o,e.dependencies=s,e.plugin=zn(u),h)e.elements[m]=Yn(h[m]);for(var w in d)e.tools[w]=er(d[w]);return e},rr=new Map,ir=[],or=function(t){var e=nr(t),n=e.id,r=e.namespace,i=e.version,o=e.plugin,a=e.elements,s=e.tools;ir.some((function(t){return t.id===n}))&&dt["b"].throwError("A Plugin id=".concat(n," is used."));var c={},u={};for(var l in a)c[l]={index:a[l].groupIndex,Element:Wn(l,a[l])};for(var h in s)u[h]=_n(h,s[h]);var f=$n(n,i,o,c,u);rr.set(f,o.created),ir.push({id:n,namespace:r,Plugin:f,Elements:Object.freeze(c)})},ar=function(t){var e,n=[],r=Object(ct["a"])(ir);try{for(r.s();!(e=r.n()).done;){var i=e.value,o=i.id,a=i.namespace,s=i.Plugin,c=i.Elements,u=new s(t),l=t.Plugin.Proxy[o]=u.context.$proxy;for(var h in t.Plugin.Context[o]=u.context,dt["g"].isString(a)&&(dt["g"].isUndefined(t.proxy[a])?t.proxy[a]=l:console.warn('Registering namespace "'.concat(a,'" is duplicated.'))),c){var f=new cn["Container"],d=c[h];f.name="".concat(h,"-group"),t.groupMap.set(d.Element,f),n.push({container:f,index:d.index})}n.sort((function(t,e){return t.index-e.index}));var p,v=Object(ct["a"])(n);try{for(v.s();!(p=v.n()).done;){var y=p.value;t.application.stage.addChild(y.container)}}catch(g){v.e(g)}finally{v.f()}rr.get(s).call(u.context)}}catch(g){r.e(g)}finally{r.f()}Object.freeze(t.Plugin.Proxy)},sr={button:0,buttons:0,ctrlKey:!1,shiftKey:!1,altKey:!1,metaKey:!1},cr=function(t){return dt["g"].isNull(t)?null:t.context.$proxy};function ur(t,e){var n=null,r=dt["e"].freeze({get drawing(){return t.proxy},get button(){return sr.button},get buttons(){return sr.buttons},get ctrlKey(){return sr.ctrlKey},get shiftKey(){return sr.shiftKey},get altKey(){return sr.altKey},get metaKey(){return sr.metaKey},get pointerX(){return e.pointer.x},get pointerY(){return e.pointer.y},get virtualX(){return e.virtual.x},get virtualY(){return e.virtual.y},get hovering(){return cr(e.hovering)},get focusing(){return cr(e.focusing)},get selecting(){return cr(e.selecting)},get holding(){return cr(e.holding)},stopPropagation:function(){n.stopPropagation()},preventDefault:function(){n.data.originalEvent.preventDefault()}});return{get current(){return n},set current(t){n=t},accessor:r}}["mousedown","mouseup","pointerdown","pointerup"].forEach((function(t){an["a"].DOCUMENT.addEventListener(t,(function(t){sr.button=t.button,sr.buttons=t.buttons}),{capture:!0})})),["keydown","keyup"].forEach((function(t){an["a"].addEventListener(an["c"].WINDOW,t,(function(t){sr.ctrlKey=t.ctrlKey,sr.shiftKey=t.shiftKey,sr.altKey=t.altKey,sr.metaKey=t.metaKey}))}));var lr=25,hr=100,fr=100,dr=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:hr,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:fr;Object(ut["a"])(this,t),this.scale=lr,this.originX=e,this.originY=n}return Object(lt["a"])(t,[{key:"setScale",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:lr;this.scale=t}},{key:"move",value:function(t,e){this.originX=dt["c"].round(t),this.originY=dt["c"].round(e)}},{key:"toGeometry",value:function(t,e){var n=this.scale,r=this.originX,i=this.originY;return[(t-r)*n,(i-e)*n]}},{key:"toCanvas",value:function(t,e){var n=this.scale,r=this.originX,i=this.originY;return[r+t/n,i-e/n]}}]),t}(),pr=function(){return{x:0,y:0}},vr=function(){return{capturedAt:null,pointer:pr(),virtual:pr(),hovering:null,focusing:null,selecting:null,holding:null}},yr=["pointermove","pointerdown","pointerup"];function gr(t,e,n){var r=new cn["Application"]({antialias:!0,backgroundColor:n.style.backgroundColor,backgroundAlpha:n.style.backgroundOpacity});return r.stage.interactive=!0,r.stage.hitArea=new cn["Rectangle"],r.ticker.add((function(){return t.watchSnap()})).add((function(){return t.watchSize()})),yr.forEach((function(e){r.stage.on("".concat(e),(function(e){t.globalEvent.current=e}))})),r.stage.on("pointerdown",(function(n){br(t,"pointerdown");var r=n.target,i=e.focusing;dt["g"].Not.Null(i)&&r!==i.graphics&&t.setFocusing()})).on("pointerup",(function(){br(t,"pointerup"),t.setHolding()})).on("pointermove",(function(r){if(n.capture){var i=r.data.global,o=i.x,a=i.y,s=e.pointer;s.x===o&&s.y===a||t.setPointer(o,a)}})),r}var br=function(t,e){t.emit(e,t.globalEvent.accessor)},mr=(n("4de4"),function(){function t(){Object(ut["a"])(this,t),this.store=new Set}return Object(lt["a"])(t,[{key:"register",value:function(t){this.store.add(t)}},{key:"remove",value:function(t){this.store.has(t)&&this.store.delete(t)}},{key:"from",value:function(t,e){var n=!1,r=[t,e],i=Array.from(this.store).filter($r).sort(wr),o=function(t,e){v.Point(t,e),r[0]=t,r[1]=e,n=!0};while(!n&&i.length>0)i.pop().handle(t,e,o);return r}}]),t}()),wr=function(t,e){return t.priority-e.priority},$r=function(t){return t.active},xr=function(){function t(){Object(ut["a"])(this,t),this.registry=new Set}return Object(lt["a"])(t,[{key:"append",value:function(t){this.registry.add(t)}},{key:"reset",value:function(){var t,e=Object(ct["a"])(this.registry);try{for(e.s();!(t=e.n()).done;){var n=t.value;n.reset()}}catch(r){e.e(r)}finally{e.f()}}}]),t}(),Or=new WeakMap,jr=function(t){return Or.get(t)},Tr=["keydown","keyup"];function kr(t){an["a"].addEventListener(an["c"].WINDOW,t,this.keyboardEventListener)}function Er(t){an["a"].removeEventListener(an["c"].WINDOW,t,this.keyboardEventListener)}for(var Sr,Cr=function(t){Object(Ke["a"])(n,t);var e=Object(Xe["a"])(n);function n(t){var r;Object(ut["a"])(this,n),r=e.call(this,t),Or.set(t,Object(on["a"])(r));var i=r.state=vr(),o=r.options=new hn(Object(on["a"])(r));return r.destroyed=!1,r.proxy=t,r.containerElement=null,r.keyboardEventListener=function(t){return br(Object(on["a"])(r),t.type)},r.application=gr(Object(on["a"])(r),i,o),r.globalEvent=ur(Object(on["a"])(r),i),r.coordinate=new dr,r.snapManager=new mr,r.toolManager=new xr,r.groupMap=new Map,r.Plugin={Proxy:{},Context:{}},ar(Object(on["a"])(r)),Tr.forEach(kr,Object(on["a"])(r)),r}return Object(lt["a"])(n,[{key:"canvasElement",get:function(){return this.application.view}},{key:"watchSize",value:function(){if(this.options.autoResizing){var t=this.application.view,e=t.parentElement,n=e.offsetHeight,r=e.offsetWidth;t.height===n&&t.width===r||this.resize()}}},{key:"watchSnap",value:function(){if(this.options.snap.enable){var t=this.state,e=t.capturedAt,n=t.virtual,r=t.pointer;if(!dt["g"].isNull(e)){var i=Date.now();if(i-e>this.options.snap.interval){var o=this.snapManager.from(r.x,r.y),a=Object(re["a"])(o,2);n.x=a[0],n.y=a[1],br(this,"pointermove"),br(this,"snap"),this.state.capturedAt=null}}}}},{key:"mount",value:function(t){an["a"].appendChild(t,this.canvasElement),this.containerElement=t,br(this,"mount"),this.resize()}},{key:"destroy",value:function(){Tr.forEach(Er,this),this.keyboardEventListener=null,an["a"].removeFromParent(this.canvasElement),sn["a"].destroy(this),this.destroyed=!0}},{key:"resize",value:function(){var t=this.application,e=t.stage,n=t.view,r=this.containerElement,i=r.offsetWidth,o=r.offsetHeight;e.hitArea.width=n.width=i,e.hitArea.height=n.height=o,this.application.renderer.resize(i,o),this.forceUpdateAll(),br(this,"resize")}},{key:"setPointer",value:function(t,e){this.state.pointer.x=this.state.virtual.x=t,this.state.pointer.y=this.state.virtual.y=e,this.state.capturedAt=Date.now(),br(this,"pointermove")}},{key:"setHovering",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.state.hovering=t}},{key:"setFocusing",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.state.focusing;this.state.focusing=t,dt["g"].Not.Null(e)&&(e.emitBlur(),this.emit("element-blur",e.context.$proxy)),dt["g"].Not.Null(t)&&this.emit("element-focus",t.context.$proxy)}},{key:"setHolding",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.state.holding=t}},{key:"forceUpdateAll",value:function(){for(var t in this.Plugin.Context)this.Plugin.Context[t].$forceUpdate()}}]),n}(sn["a"].Emitter),Pr=0,Lr=1,Fr=function(t){return dt["g"].isNull(t)?null:t.context.$proxy},Dr=function(t){return[t.x,t.y]},Nr=(Sr={},Object(ht["a"])(Sr,Pr,(function(t,e){t.setScale(e)})),Object(ht["a"])(Sr,Lr,(function(t,e){t.setScaleByReference.apply(t,[e].concat(Object(ft["a"])(t.pointer)))})),Sr),Wr=function(){function t(){Object(ut["a"])(this,t),new Cr(this),dt["e"].freeze(this)}return Object(lt["a"])(t,[{key:"options",get:function(){return jr(this).options}},{key:"canvasElement",get:function(){return jr(this).canvasElement}},{key:"hovering",get:function(){return Fr(jr(this).state.hovering)}},{key:"selecting",get:function(){return Fr(jr(this).state.selecting)}},{key:"focusing",get:function(){return Fr(jr(this).state.focusing)}},{key:"holding",get:function(){return Fr(jr(this).state.holding)}},{key:"plugins",get:function(){return jr(this).Plugin.Proxy}},{key:"pointer",get:function(){return Dr(jr(this).state.pointer)}},{key:"virtual",get:function(){return Dr(jr(this).state.virtual)}},{key:"origin",get:function(){var t=jr(this).coordinate,e=t.originX,n=t.originY;return[e,n]}},{key:"scale",get:function(){return jr(this).coordinate.scale}},{key:"width",get:function(){return jr(this).application.view.width}},{key:"height",get:function(){return jr(this).application.view.height}},{key:"mount",value:function(t){dt["b"].instanceOf(t,HTMLElement)||dt["b"].Throw.TypeError("Invalid `element`, a HTMLElement expected."),jr(this).mount(t)}},{key:"resize",value:function(){jr(this).resize()}},{key:"destroy",value:function(){jr(this).destroy()}},{key:"setOrigin",value:function(t,e){v.Point(t,e);var n=jr(this);n.coordinate.move(t,e),n.forceUpdateAll()}},{key:"setScale",value:function(t){dt["g"].Not.Number(t)&&dt["b"].Throw.TypeError("Invalid scale, a number expected.");var e=jr(this),n=this.options.scale,r=n.min,i=n.max,o=dt["c"].max(r,dt["c"].min(i,t));e.coordinate.setScale(o),e.forceUpdateAll()}},{key:"setScaleByReference",value:function(t,e,n){var r,i;v.Point(e,n);var a=jr(this),s=this.origin,u=a.coordinate.toGeometry(e,n);this.setScale(t);var l=(r=a.coordinate).toCanvas.apply(r,Object(ft["a"])(u)),h=o.fromBothPoint.apply(o,Object(ft["a"])(l).concat([e,n]));(i=a.coordinate).move.apply(i,Object(ft["a"])(c.translate.apply(c,Object(ft["a"])(s).concat(Object(ft["a"])(h))))),a.forceUpdateAll()}},{key:"setScaleInMode",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Pr;dt["e"].values(m).includes(e)?Nr[e](this,t):dt["b"].Throw.TypeError("Invalid `mode`, a value of SCALE_MODE expected.")}},{key:"on",value:function(t,e){return jr(this).on(t,e),this}},{key:"off",value:function(t,e){return jr(this).off(t,e),this}},{key:"registerSnap",value:function(t){jr(this).snapManager.register(t)}},{key:"appendTool",value:function(t){jr(this).toolManager.append(t)}},{key:"resetAllTool",value:function(){jr(this).toolManager.reset()}}]),t}(),Ar=function(t){return Yn(t)},Ir=function(t,e,n){return er(dt["e"].assign(n,{states:t,actions:e}))},Mr=function(t){return zn(t)},Rr=function(t){return nr(t)},Hr=y._,Br=n("49a4"),_r=function(t){return t.$proxy},Vr=function(t){Object(Ke["a"])(n,t);var e=Object(Xe["a"])(n);function n(){return Object(ut["a"])(this,n),e.apply(this,arguments)}return Object(lt["a"])(n,[{key:"createHollow",value:function(t,e,n){return Hr(this).createHollow(t,e,n)}},{key:"createMovingHollow",value:function(t){return Hr(this).createMovingHollow(t)}},{key:"getAllHollowList",value:function(){return Hr(this).$getElementList("Hollow").map(_r)}}]),n}(b.Proxy.Plugin),zr=x.define({proxy:b.Proxy.Creator(Vr),methods:{createHollow:function(t,e,n){return this.$createElement("Hollow",t,e,n)},createMovingHollow:function(t){var e=this.$createElement("Hollow",t);return this.$drawing.hammer.adjuster.moveElement(e),e}}}),Ur={},Yr=function(t,e){dt["g"].Not.String(t)&&dt["b"].Throw.TypeError("Invalid `name`, a string expected."),dt["g"].Not.Function(e.render)&&dt["b"].Throw.TypeError("Invalid `material`, a function expected."),t in Ur&&dt["a"].warn('Duplicated material name="'.concat(t,'". The original is replaced.')),Ur[t]=e},Gr=function(t){return Ur[t]},Kr=function(t){Object(Ke["a"])(n,t);var e=Object(Xe["a"])(n);function n(){return Object(ut["a"])(this,n),e.apply(this,arguments)}return Object(lt["a"])(n,[{key:"surface",get:function(){return Hr(this).surface}},{key:"virtualSurface",get:function(){return Hr(this).virtualSurface}},{key:"width",get:function(){return Hr(this).width}},{key:"offset",get:function(){return Hr(this).offset}},{key:"materialName",get:function(){return Hr(this).materialName}},{key:"fliped",get:function(){return Hr(this).fliped}},{key:"flip",value:function(){Hr(this).flip()}},{key:"toggleSurface",value:function(){Hr(this).toggleSurface()}},{key:"setSurface",value:function(t){Hr(this).setSurface(t)}},{key:"setMaterial",value:function(t){Hr(this).setMaterial(t)}},{key:"setOffset",value:function(t){Hr(this).setOffset(t)}},{key:"setWidth",value:function(t){Hr(this).setWidth(t)}},{key:"remove",value:function(){Hr(this).remove()}}]),n}(b.Proxy.Element),Xr=Object(lt["a"])((function t(e,n,r){Object(ut["a"])(this,t),this.name="virtual",this.corner={x:e,y:n},this.back={corner:{x:e+10,y:n}},this.wall={thickness:r}})),qr=x.Element.define({groupIndex:1100,interative:!0,hoverable:!0,focusable:!0,draggable:!0,state:function(){return{surface:null,virtualSurface:null,offset:0,materialName:"",fliped:!1,width:0,listener:dt["d"]}},getters:{surface:function(){return this.$state.surface},virtualSurface:function(){return this.$state.virtualSurface},width:function(){return this.$state.width},offset:function(){return this.$state.offset},materialName:function(){return this.$state.materialName},fliped:function(){return this.$state.fliped}},created:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.$state.listener=function(){return n.$setDirty()},this.$state.virtualSurface=new Xr(1e4,10001,200),this.setMaterial(t),this.setSurface(e||this.$state.virtualSurface),this.setOffset(r),this.setWidth(Gr(t).width)},destroy:function(){var t=this.$state.surface;t.off&&t.off("change",this.$state.listener)},render:function(t){var e=this.$state,n=e.surface,r=e.width,i=e.fliped,a=e.offset,s=e.materialName,u=this.$drawing.scale,l=n.corner,h=n.back.corner,f={width:r/u,height:n.wall.thickness/u,fliped:i,scale:u,hover:this.$hovering,focus:this.$focusing,hold:this.$holding};Gr(s).render(t,f);var d=this.$toCanvas(l.x,l.y),p=this.$toCanvas(h.x,h.y),v=o.normalize.apply(o,Object(ft["a"])(o.fromBothPoint.apply(o,Object(ft["a"])(d).concat(Object(ft["a"])(p))))),y=Object(re["a"])(v,2),g=y[0],b=y[1],m=c.translate.apply(c,Object(ft["a"])(d).concat(Object(ft["a"])(o.multiply(g,b,a/u)))),w=Object(re["a"])(m,2);t.x=w[0],t.y=w[1],t.rotation=dt["c"].atan2(b,g)},methods:{flip:function(){this.$state.fliped=!this.$state.fliped,this.$emit("update",this.$state),this.$setDirty()},toggleSurface:function(){var t=this.$state.surface.corner,e=this.$state.surface.back.corner,n=o.length.apply(o,Object(ft["a"])(o.fromBothPoint(t.x,t.y,e.x,e.y)));this.setOffset(n-this.$state.offset),this.setSurface(this.$state.surface.back)},setSurface:function(t){var e=this.$state.surface;e&&e.off&&this.$state.surface.off("change",this.$state.listener),t&&t.on&&t.on("change",this.$state.listener),this.$state.surface=t,this.$setDirty()},setMaterial:function(t){this.$state.materialName=t,this.$emit("update",this.$state),this.$setDirty()},setOffset:function(t){this.$state.offset=t,this.$setDirty()},setWidth:function(t){this.$state.width=t,this.$emit("update",this.$state),this.$setDirty()},remove:function(){this.$destroy()}},proxy:function(){return new Kr(this)}},zr),Jr=O.define({id:"com.3dnest.spoke.windoor",namespace:"windoor",version:Br["a"],plugin:zr,elements:{Hollow:qr}}),Qr=n("7580"),Zr={},ti=function(t,e){dt["g"].Not.String(t)&&dt["b"].Throw.TypeError("Invalid `name`, a string expected."),dt["g"].Not.Function(e.render)&&dt["b"].Throw.TypeError("Invalid `material`, a function expected."),t in Zr&&dt["a"].warn('Duplicated material name="'.concat(t,'". The original is replaced.')),Zr[t]=e},ei=function(){var t=Object(Qr["a"])(regeneratorRuntime.mark((function t(e,n){var r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,cn.Texture.fromURL(n);case 2:r=t.sent,i={texture:r,render:function(t,e){var n=e.width,i=e.height,o=n>0?n:r.width,a=i>0?i:r.height;t.beginTextureFill({texture:r,matrix:new cn.Matrix(o/r.width,0,0,a/r.height,0,0)}).drawRect(0,0,o,a)}},ti(e,i);case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),ni=function(t){return t in Zr||dt["a"].warn('material name="'.concat(t,'" is not exist.')),Zr[t]},ri=function(t){return t.$proxy},ii=function(t){Object(Ke["a"])(n,t);var e=Object(Xe["a"])(n);function n(){return Object(ut["a"])(this,n),e.apply(this,arguments)}return Object(lt["a"])(n,[{key:"createStuff",value:function(t,e,n,r,i){return Hr(this).createStuff(t,e,n,r,i)}},{key:"createMovingStuff",value:function(t,e,n){return Hr(this).createMovingStuff(t,e,n)}},{key:"getAllStuffList",value:function(){return Hr(this).$getElementList("Stuff").map(ri)}}]),n}(b.Proxy.Plugin),oi=x.define({proxy:b.Proxy.Creator(ii),methods:{createStuff:function(t,e,n,r,i){var o=ni(t).texture,a=this.$drawing.scale;return this.$createElement("Stuff",t,e,n,r||o.width*a,i||o.height*a).$proxy},createMovingStuff:function(t,e,n){var r=this.createStuff(t,1e4,1e4,e,n);this.$drawing.common.transformer.moveElement(r)}}}),ai=(n("cb29"),function(t){Object(Ke["a"])(n,t);var e=Object(Xe["a"])(n);function n(){return Object(ut["a"])(this,n),e.apply(this,arguments)}return Object(lt["a"])(n,[{key:"fill",get:function(){return Hr(this).fill}},{key:"width",get:function(){return Hr(this).width}},{key:"height",get:function(){return Hr(this).height}},{key:"rotation",get:function(){return Hr(this).rotation}},{key:"x",get:function(){return Hr(this).x}},{key:"y",get:function(){return Hr(this).y}},{key:"room",get:function(){return Hr(this).room}},{key:"setFill",value:function(t){Hr(this).setFill(t)}},{key:"setRoom",value:function(t){Hr(this).setRoom(t)}},{key:"setWidth",value:function(t){Hr(this).setWidth(t)}},{key:"setHeight",value:function(t){Hr(this).setHeight(t)}},{key:"setOffset",value:function(t,e){Hr(this).setOffet(t,e)}},{key:"setRotation",value:function(t){Hr(this).setRotation(t)}},{key:"setPosition",value:function(t,e){Hr(this).setPosition(t,e)}},{key:"remove",value:function(){Hr(this).remove()}}]),n}(b.Proxy.Element)),si=x.Element.define({proxy:b.Proxy.Creator(ai),groupIndex:1200,interative:!0,focusable:!0,draggable:!0,state:function(){return{fill:"",width:0,height:0,room:null,offsetX:0,offsetY:0,x:0,y:0,rotation:0,listener:dt["d"]}},getters:{fill:function(){return this.$state.fill},width:function(){return this.$state.width},height:function(){return this.$state.height},rotation:function(){return this.$state.rotation},x:function(){return this.$state.x},y:function(){return this.$state.y},room:function(){return this.$state.room}},created:function(t,e,n,r,i){this.setWidth(r),this.setHeight(i),this.setFill(t),this.setPosition(e,n)},destroy:function(){var t=this.$state.room;t&&t.off&&t.off("dirty",this.$state.listener)},render:function(t){var e=this.$state,n=e.width,r=e.height,i=e.rotation,o=e.fill,a=this.$drawing.scale,s={width:n/a,height:r/a};t.drawRect(0,0,s.width,s.height),t.pivot.x=s.width/2,t.pivot.y=s.height/2;var c=ni(o);c&&c.render(t,s);var u=this.$toCanvas(this.$state.x,this.$state.y),l=Object(re["a"])(u,2);t.x=l[0],t.y=l[1],t.rotation=i},methods:{setFill:function(t){this.$state.fill=t,this.$setDirty()},setRoom:function(t){var e=this;t!==this.$state.room&&(t?(this.$state.room=t,t.on("dirty",this.$state.listener=function(){return e.$setDirty()}),this.$setDirty()):this.$state.room=null)},setWidth:function(t){this.$state.width=t,this.$emit("update",this.$state),this.$setDirty()},setHeight:function(t){this.$state.height=t,this.$emit("update",this.$state),this.$setDirty()},setRotation:function(t){this.$state.rotation=t,this.$emit("update",this.$state),this.$setDirty()},setPosition:function(t,e){var n=this.$state.room,r=n?this.$toGeometry(n.bounds.left,n.bounds.bottom):[0,0],i=Object(re["a"])(r,2),o=i[0],a=i[1];this.$state.x=t,this.$state.y=e,this.$state.offsetX=t-o,this.$state.offsetY=e-a,this.$setDirty()},setOffset:function(t,e){var n=this.$state.room,r=n?this.$toGeometry(n.bounds.left,n.bounds.bottom):[0,0],i=Object(re["a"])(r,2),o=i[0],a=i[1];this.$state.offsetX=t,this.$state.offsetY=e;var s=[o+t,a+e];this.$state.x=s[0],this.$state.y=s[1],this.$setDirty()},remove:function(){this.$destroy()}}},oi),ci=n("e07e"),ui=O.define({id:"com.3dnest.spoke.furniture",namespace:"furniture",version:ci["a"],plugin:oi,elements:{Stuff:si}}),li=n("3d04"),hi=n("5d77"),fi=(n("9911"),n("ac1f"),n("1276"),[0,0]),di=function(t){Object(Ke["a"])(n,t);var e=Object(Xe["a"])(n);function n(){return Object(ut["a"])(this,n),e.apply(this,arguments)}return Object(lt["a"])(n,[{key:"x",get:function(){return Hr(this).x}},{key:"y",get:function(){return Hr(this).y}},{key:"size",get:function(){return Hr(this).size}},{key:"point",get:function(){var t=Hr(this),e=t.x,n=t.y;return fi[0]=e,fi[1]=n,fi}},{key:"move",value:function(t,e){return b.Assert.Point(t,e),Hr(this).move(t,e),this}},{key:"remove",value:function(){return Hr(this).remove(),this}},{key:"getAdjacentCornerList",value:function(){return Hr(this).getAdjacentCornerList().map(pi)}},{key:"surfaces",value:regeneratorRuntime.mark((function t(){var e,n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(ct["a"])(Hr(this).surfaces()),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return r=n.value,t.next=7,r.$proxy;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))},{key:"getWallByToCorner",value:function(t){dt["b"].instanceOf(t,n)||dt["b"].Throw.TypeError("Invalid corner, a CornerProxy expected.");var e=Hr(this).getWallByToCorner(Hr(t));return dt["g"].isNull(e)?null:e.$proxy}}]),n}(b.Proxy.Element),pi=function(t){return t.$proxy},vi=function(t){Object(Ke["a"])(n,t);var e=Object(Xe["a"])(n);function n(){return Object(ut["a"])(this,n),e.apply(this,arguments)}return Object(lt["a"])(n,[{key:"thickness",get:function(){return Hr(this).$state.thickness}},{key:"thisSurface",get:function(){return Hr(this).thisSurface.$proxy}},{key:"thatSurface",get:function(){return Hr(this).thatSurface.$proxy}},{key:"setThickness",value:function(t){(dt["g"].Not.Number(t)||t<=0)&&dt["b"].Throw.TypeError("Invalid `thickness`, a number >0 expected."),Hr(this).setThickness(t)}},{key:"remove",value:function(){Hr(this).remove()}},{key:"drawPolygon",value:function(t){dt["b"].instanceOf(t,cn.Graphics)||dt["b"].Throw.TypeError("Invalid `graphics`, a `PIXI.Graphics` expected."),Hr(this).drawPolygon(t)}}]),n}(b.Proxy.Element),yi=function(t){Object(Ke["a"])(n,t);var e=Object(Xe["a"])(n);function n(){return Object(ut["a"])(this,n),e.apply(this,arguments)}return Object(lt["a"])(n,[{key:"getOptions",value:function(){return Hr(this).$data.optionsGetter}},{key:"createCorner",value:function(t,e){return b.Assert.Point(t,e),Hr(this).createCorner(t,e).$proxy}},{key:"removeCorner",value:function(t){return dt["b"].instanceOf(t,di)||dt["b"].Throw.TypeError("Invalid `corner`, a CornerProxy expected."),Hr(this).removeCorner(Hr(t))}},{key:"createWall",value:function(t,e){return mi(t,e),Hr(this).createWall(Hr(t),Hr(e)).$proxy}},{key:"removeWall",value:function(t){return dt["b"].instanceOf(t,vi)||dt["b"].Throw.TypeError("Invalid `wall`, a WallProxy expected."),Hr(this).removeWall(Hr(t))}},{key:"removeWallSimple",value:function(t){return dt["b"].instanceOf(t,vi)||dt["b"].Throw.TypeError("Invalid `wall`, a WallProxy expected."),Hr(this).removeWallSimple(Hr(t))}},{key:"split",value:function(t,e,n){return b.Assert.Point(e,n),dt["b"].instanceOf(t,vi)||dt["b"].Throw.TypeError("Invalid `wall`, a WallProxy expected."),Hr(this).split(Hr(t),e,n).$proxy}},{key:"merge",value:function(t){return dt["b"].instanceOf(t,di)||dt["b"].Throw.TypeError("Invalid `corner`, a CornerProxy expected."),2!==t.size&&dt["b"].throwError("The Wall number of this Corner is NOT 2."),Hr(this).merge(Hr(t)).$proxy}},{key:"combine",value:function(t){dt["b"].instanceOf(t,vi)||dt["b"].Throw.TypeError("Invalid `wall`, a WallProxy expected.");var e=Hr(t);return Hr(this).combine(e).$proxy}},{key:"removeRoom",value:function(){}},{key:"getAllCornerList",value:function(){return Hr(this).$getElementList("Corner").map(gi)}},{key:"getAllWallList",value:function(){return Hr(this).$getElementList("Wall").map(gi)}},{key:"getAllRoomList",value:function(){return Hr(this).$getElementList("Room").map(gi)}},{key:"getRoomByPoint",value:function(t,e){b.Assert.Point(t,e);var n=Hr(this).getRoomOfPoint(t,e);return n?n.$proxy:null}},{key:"queryCorner",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;b.Assert.Point(t,e),(dt["g"].Not.Number(n)||n<=0)&&dt["b"].Throw.TypeError("Invalid `range`, a number >0 expected.");var r=Hr(this).queryCorner(t,e,n);return dt["g"].isNull(r)?null:r.$proxy}},{key:"mergeAll",value:function(){}},{key:"clearEmplyCorner",value:function(){}}]),n}(b.Proxy.Plugin),gi=function(t){return t.$proxy},bi=["from","to"],mi=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r in bi)dt["b"].instanceOf(e[r],di)||dt["b"].Throw.TypeError("Invalid `".concat(bi[r],"`, a CornerProxy excepted."))},wi=b.Options.define,$i=wi({show:!0},{snap:wi({},{corner:wi({active:!0,priority:0,maxDistance:40})}),corner:wi({show:!0,render:null},{style:wi({color:16777215,opacity:.75,radius:5},{hover:wi({color:0,opacity:.75,radius:5})})}),wall:wi({show:!0},{style:wi({opacity:1,color:10066329,hoverColor:13421772}),midline:wi({show:!0,color:16711680,width:1})}),room:wi({show:!0,defaultTexture:null}),surface:wi({opacity:1,borderColor:0,borderWidth:2})}),xi=function(t,e){var n,i=null,o=r.ROUND,a=Object(ct["a"])(p.Iterator.allHalfEdgeOfVertex(t));try{for(a.s();!(n=a.n()).done;){var s=n.value,c=u.differ(e,p.getAngleOfHalfEdge(s),!1);c<o&&(o=c,i=s)}}catch(l){a.e(l)}finally{a.f()}return i},Oi=function(t,e,n){if(dt["g"].Not.Null(t.incidentEdge)){var r=t.x,i=t.y,o=n.x,a=n.y,s=Math.atan2(a-i,o-r),c=xi(t,s),u=c.twin;e.previous=u,e.twin.next=u.next,u.next.previous=e.twin,u.next=e}e.origin=t,t.incidentEdge=e},ji=function(t,e){var n,r=Object(ct["a"])(p.Iterator.allHalfEdgeOfPath(t));try{for(r.s();!(n=r.n()).done;){var i=n.value;i.incidentFace=e}}catch(o){r.e(o)}finally{r.f()}},Ti=function(t,e){t.twin=e,e.twin=t,t.next=e,e.next=t,t.previous=e,e.previous=t},ki=function(t,e,n){var r=dt["g"].isNull(t.incidentEdge)&&dt["g"].isNull(e.incidentEdge),i=new p.Struct.HalfEdge,o=new p.Struct.HalfEdge;Ti(i,o),Oi(t,i,e),Oi(e,o,t);var a=r?p.getFaceOfPoint(n,t):i.previous.incidentFace||i.next.incidentFace,s=a.outerComponent,c=a.innerComponents;if(p.isTwinInSamePath(i)){i.incidentFace=o.incidentFace=a;var u=c.splice(0);p.isPathContainsHalfEdge(i,s)?a.outerComponent=i:c.push(i);var l,h=Object(ct["a"])(u);try{for(h.s();!(l=h.n()).done;){var f=l.value;p.isPathContainsHalfEdge(i,f)||c.push(f)}}catch(T){h.e(T)}finally{h.f()}}else{var d=new p.Struct.Face,v=p.isOuterPath(o),y=p.isOuterPath(i),g=v?i:o,b=g.twin;ji(b,d),g.incidentFace=a,d.outerComponent=b;var m=a.innerComponents.splice(0);y===v?a.outerComponent=g:a.innerComponents.push(g);var w,$=Object(ct["a"])(m);try{for($.s();!(w=$.n()).done;){var x=w.value,O=x.origin;if(!p.isPathContainsVertex(g,O)&&!p.isPathContainsHalfEdge(b,x)){var j=p.getFaceOfPoint(d,O)?d:a;x.incidentFace!==j&&ji(x,j),j.innerComponents.push(x)}}}catch(T){$.e(T)}finally{$.f()}}return i},Ei=function(t){t.origin=null,t.twin=null,t.previous=null,t.next=null,t.incidentFace=null},Si=function(t){return t.outerComponent=null,t.innerComponents.length=0,t},Ci=function(t){var e=t.twin,n=t.previous,r=t.origin,i=null;return e===n?r.incidentEdge=null:(n.next=r.incidentEdge=e.next,i=e.next.previous=n),i},Pi=function(t){var e=t.incidentFace,n=t.twin,r=p.isTwinInSamePath(t),i=p.isOuterPath(t),o=Ci(t),a=Ci(n);if(r){var s,c=e.innerComponents,u=c.splice(0),l=[o,a].filter(dt["g"].Not.Null).filter((function(t){var n=p.isOuterPath(t);return n?e.outerComponent=t:c.push(t),!n})),h=Object(ct["a"])(u);try{var f=function(){var e=s.value;e!==t&&e!==n&&l.every((function(t){return!p.isPathContainsHalfEdge(t,e)}))&&c.push(e)};for(h.s();!(s=h.n()).done;)f()}catch(O){h.e(O)}finally{h.f()}}else{var d,v,y=o.incidentFace,g=a.incidentFace;if(i?(d=g,v=y):(d=y,v=g),p.isOuterPath(o))d.outerComponent=o;else{var b=d.innerComponents,m=d.innerComponents.splice(0).concat(v.innerComponents);b.push(o);var w,$=Object(ct["a"])(m);try{for($.s();!(w=$.n()).done;){var x=w.value;x===t||x===n||p.isPathContainsHalfEdge(o,x)||b.push(x)}}catch(O){$.e(O)}finally{$.f()}}ji(o,d),Si(v)}Ei(t),Ei(n)},Li=function(t){return p.getVertexHalfEdgeList(t).forEach(Pi),t.incidentEdge=null,t},Fi=function(t){t.incidentEdge=null,t.x=0,t.y=0},Di=function(t){var e=t.incidentEdge.twin,n=e.next.twin,r=e.next.next,i=n.next.next;return Ei(e.twin),Ei(n.twin),Fi(t),e.twin=n,n.twin=e,e.next=r,n.next=i,r.previous=e,i.previous=n,e},Ni=function(t){var e=t.incidentFace;if(e.outerComponent===t)e.outerComponent=t.next;else{var n=e.innerComponents,r=n.indexOf(t);-1!==r&&(n[r]=t.next)}},Wi=function(t){var e=t.twin,n=t.origin,r=e.origin,i=p.hasOnlyHalfEdge(n),o=p.hasOnlyHalfEdge(r);Ni(t),Ni(e);var a=n;if(i)if(o)Pi(t);else{var s=[n.x,n.y];r.x=s[0],r.y=s[1],Li(n),a=r}else if(o)Li(r);else{var c,u=Object(ct["a"])(p.Iterator.allHalfEdgeOfVertex(r));try{for(u.s();!(c=u.n()).done;){var l=c.value;l.origin=n}}catch(f){u.e(f)}finally{u.f()}n.incidentEdge=t.next,t.previous.next=t.next,t.next.previous=t.previous;var h=t.twin;h.previous.next=h.next,h.next.previous=h.previous,Ei(t),Ei(h),Fi(r)}return a},Ai="c",Ii="d",Mi="D",Ri="Rg",Hi="_D",Bi="_Rg",_i=new WeakMap,Vi=function(t){return _i.get(t)},zi=function(t,e,n,r,i){function o(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Object(ut["a"])(this,o),_i.set(t,this),this[Ai]=e}return Object(lt["a"])(o,[{key:t,get:function(){return dt["g"].isNull(this[Ai])}},{key:e,value:function(){this[Ai]=null,this[Hi]()}},{key:n,value:function(){this[Bi]()}},{key:r,value:function(){}},{key:i,value:function(){}}]),o}(Ii,Mi,Ri,Hi,Bi),Ui=function(){function t(){Object(ut["a"])(this,t)}return Object(lt["a"])(t,[{key:"mesh",get:function(){var t=Vi(this);return t[Ii]?null:t[Ai].$}},{key:"destroyed",get:function(){return Vi(this)[Ii]}}]),t}(),Yi="v",Gi="s",Ki="Hs",Xi="F",qi="H",Ji="E",Qi="M",Zi="e",to="v",eo="f",no="g",ro="mv",io="mf",oo="mh",ao="CV",so="M",co="L",uo="S",lo="G",ho="C",fo="LV",po="RV",vo="RE",yo="HV",go="HE",bo="HF",mo="TV",wo="TH",$o="TF",xo="PF",Oo="AE",jo="AV",To="AF",ko="FV",Eo="FE",So="FF",Co="l",Po="VC",Lo="VD",Fo="EC",Do="ED",No="FC",Wo="FD",Ao="HC",Io="HD",Mo="t",Ro="he",Ho="v",Bo="e",_o="f",Vo="n",zo="p",Uo="b",Yo=new WeakMap,Go=function(t){return Yo.get(t)},Ko=function(t){return t[Bo]},Xo=function(t,e,n,r,i,o,a,s,c){Object(Ke["a"])(l,t);var u=Object(Xe["a"])(l);function l(t,e,n,r){var i;return Object(ut["a"])(this,l),i=u.call(this,t,e),Yo.set(t,Object(on["a"])(i)),i.$=t,i[Yi]=p.createVertex(n,r),i[Ri](),i}return Object(lt["a"])(l,[{key:e,get:function(){var t,e=0,n=Object(ct["a"])(p.Iterator.allHalfEdgeOfVertex(this[Yi]));try{for(n.s();!(t=n.n()).done;){t.value;e++}}catch(r){n.e(r)}finally{n.f()}return e}},{key:n,value:regeneratorRuntime.mark((function t(){var e,n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(ct["a"])(p.Iterator.allHalfEdgeOfVertex(this[Yi])),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return r=n.value,t.next=7,this[Ai][wo](r);case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))},{key:r,value:function(){var t=this[Ai];t[to].add(this),t[ro].set(this[Yi],this)}},{key:i,value:function(){this[Yi]=null}},{key:o,value:function(){return p.getVertexHalfEdgeList(this[Yi]).map(this[Ai][wo])}},{key:a,value:function(){return this[qi]().map(Ko)}},{key:s,value:function(){var t,e=new Set,n=Object(ct["a"])(p.Iterator.allHalfEdgeOfVertex(this[Yi]));try{for(n.s();!(t=n.n()).done;){var r=t.value;e.add(r.incidentFace)}}catch(i){n.e(i)}finally{n.f()}return Array.from(e).map(this[Ai][$o])}},{key:c,value:function(t,e){this[Yi].x=t,this[Yi].y=e}}]),l}(zi,Gi,Ki,Bi,Hi,qi,Ji,Xi,Qi),qo=function(t){return t.$},Jo=function(t){Object(Ke["a"])(n,t);var e=Object(Xe["a"])(n);function n(t,r,i){var o;return Object(ut["a"])(this,n),o=e.call(this),new Xo(Object(on["a"])(o),t,r,i),Object.seal(Object(on["a"])(o)),o}return Object(lt["a"])(n,[{key:"x",get:function(){return Go(this)[Yi].x}},{key:"y",get:function(){return Go(this)[Yi].y}},{key:"size",get:function(){return Go(this)[Gi]}},{key:"halfEdges",value:regeneratorRuntime.mark((function t(){var e,n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(ct["a"])(Go(this)[Ki]()),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return r=n.value,t.next=7,r.$;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))},{key:"move",value:function(t,e){return dt["g"].Not.Number(t)&&dt["b"].Throw.TypeError("Vertex.x MUST be a number."),dt["g"].Not.Number(e)&&dt["b"].Throw.TypeError("Vertex.y MUST be a number."),Go(this)[Qi](t,e),this}},{key:"getFaceList",value:function(){return Go(this)[Xi]().map(qo)}},{key:"getHalfEdgeList",value:function(){return Go(this)[qi]().map(qo)}},{key:"getEdgeList",value:function(){return Go(this)[Ji]().map(qo)}}]),n}(Ui),Qo="if",Zo="af",ta="iv",ea="av",na="ih",ra="ah",ia=new WeakMap,oa=function(t){return ia.get(t)},aa=function(t,e,n,r,i,o,a,s){Object(Ke["a"])(u,t);var c=Object(Xe["a"])(u);function u(t,e,n){var r;return Object(ut["a"])(this,u),r=c.call(this,t,e),ia.set(t,Object(on["a"])(r)),r.$=t,r[na]=n,n[Bo]=n[Uo][Bo]=Object(on["a"])(r),r[Ri](),r}return Object(lt["a"])(u,[{key:e,value:function(){this[Ai][Zi].add(this)}},{key:n,value:function(){this[na]=null}},{key:r,get:function(){return this[na][_o]}},{key:i,get:function(){return this[ra][_o]}},{key:o,get:function(){return this[na][Ho]}},{key:a,get:function(){return this[ra][Ho]}},{key:s,get:function(){return this[na][Uo]}}]),u}(zi,Bi,Hi,Qo,Zo,ta,ea,ra),sa=function(t){Object(Ke["a"])(n,t);var e=Object(Xe["a"])(n);function n(t,r){var i;return Object(ut["a"])(this,n),i=e.call(this),new aa(Object(on["a"])(i),t,r),Object.freeze(Object(on["a"])(i)),i}return Object(lt["a"])(n,[{key:"thisFace",get:function(){return oa(this)[Qo].$}},{key:"thatFace",get:function(){return oa(this)[Zo].$}},{key:"thisVertex",get:function(){return oa(this)[ta].$}},{key:"thatVertex",get:function(){return oa(this)[ea].$}},{key:"thisHalfEdge",get:function(){return oa(this)[na].$}},{key:"thatHalfEdge",get:function(){return oa(this)[ra].$}}]),n}(Ui),ca="f",ua="H",la="C",ha="O",fa="P",da=new WeakMap,pa=function(t){return da.get(t)},va=function(t,e,n,r,i,o,a){Object(Ke["a"])(c,t);var s=Object(Xe["a"])(c);function c(t,e,n){var r;return Object(ut["a"])(this,c),r=s.call(this,t,e),da.set(t,Object(on["a"])(r)),r.$=t,r[ca]=n,r}return Object(lt["a"])(c,[{key:e,value:function(){var t=this[Ai];t[eo].add(this),t[io].set(this[ca],this)}},{key:n,value:function(){this[ca]=null}},{key:r,value:function(){return p.getPathOfHalfEdge(this[ca].outerComponent)}},{key:i,value:function(){return this[ua]().map(this[Ai][wo])}},{key:o,value:function(){return p.queryChildFaceList(this[ca]).map(this[Ai][$o])}},{key:a,value:function(t,e){var n=p.getPolygonFromFaceOuter(this[ca]);return h.containsPoint(n,{x:t,y:e})}}]),c}(zi,Bi,Hi,ua,ha,la,fa),ya=function(t){Object(Ke["a"])(n,t);var e=Object(Xe["a"])(n);function n(t,r){var i;return Object(ut["a"])(this,n),i=e.call(this),new va(Object(on["a"])(i),t,r),Object.freeze(Object(on["a"])(i)),i}return Object(lt["a"])(n,[{key:"getChildFaceList",value:function(){return pa(this)[la]().map(qo)}},{key:"getOuterHalfEdgeList",value:function(){return pa(this)[ha]().map(qo)}},{key:"containsPoint",value:function(t,e){return pa(this)[fa](t,e)}}]),n}(Ui),ga=function(t){return new ya(t,p.createGlobalFace())},ba=new WeakMap,ma=function(t){return ba.get(t)},wa=function(t,e,n,r,i,o,a,s,c){Object(Ke["a"])(l,t);var u=Object(Xe["a"])(l);function l(t,e,n){var r;return Object(ut["a"])(this,l),r=u.call(this,t,e),ba.set(t,Object(on["a"])(r)),r.$=t,r[Ro]=n,r[Bo]=null,r[Bi](),r}return Object(lt["a"])(l,[{key:e,value:function(){this[Ai][oo].set(this[Ro],this)}},{key:n,value:function(){this[Ro]=null,this[Bo]=null}},{key:r,get:function(){return this[Ro].twin}},{key:i,get:function(){return this[Ai][mo](this[Ro].origin)}},{key:o,get:function(){return this[Ai][$o](this[Ro].incidentFace)}},{key:a,get:function(){return this[Ai][wo](this[Ro].next)}},{key:s,get:function(){return this[Ai][wo](this[Ro].previous)}},{key:c,get:function(){return this[Ai][wo](this[Mo])}}]),l}(zi,Bi,Hi,Mo,Ho,_o,Vo,zo,Uo),$a=function(t){Object(Ke["a"])(n,t);var e=Object(Xe["a"])(n);function n(t,r){var i;return Object(ut["a"])(this,n),i=e.call(this),new wa(Object(on["a"])(i),t,r),Object.freeze(Object(on["a"])(i)),i}return Object(lt["a"])(n,[{key:"vertex",get:function(){return ma(this)[Ho].$}},{key:"edge",get:function(){return ma(this)[Bo].$}},{key:"face",get:function(){return ma(this)[_o].$}},{key:"next",get:function(){return ma(this)[Vo].$}},{key:"previous",get:function(){return ma(this)[zo].$}},{key:"back",get:function(){return ma(this)[Uo].$}}]),n}(Ui),xa=new WeakMap,Oa=function(t){return xa.get(t)},ja=function(t,e,n,r,i,o,a,s,c,u,l,h,f,d,v,y,g,b,m){function w(t){var e;Object(ut["a"])(this,w),xa.set(t,this),this.$=t,this[Zi]=new Set,this[to]=new Set;var n=this[ro]=new Map,r=this[no]=pa(ga(this));this[eo]=new Set;var i=this[io]=new Map,o=this[oo]=new Map;this[wo]=function(t){return o.get(t)};var a=r[ca];this[$o]=function(t){return a===t?r:i.get(t)},this[mo]=function(t){return n.get(t)},this[Co]=(e={},Object(ht["a"])(e,Po,dt["d"]),Object(ht["a"])(e,Lo,dt["d"]),Object(ht["a"])(e,Fo,dt["d"]),Object(ht["a"])(e,Do,dt["d"]),Object(ht["a"])(e,No,dt["d"]),Object(ht["a"])(e,Wo,dt["d"]),Object(ht["a"])(e,Ao,dt["d"]),Object(ht["a"])(e,Io,dt["d"]),e)}return Object(lt["a"])(w,[{key:t,value:function(t,e){var n=new Jo(this,t,e);return this[Co][Po](n),n}},{key:e,value:function(t,e,n){t[Qi](e,n)}},{key:n,value:function(t,e){var n=this[no][ca],r=t[Yi],i=e[Yi],o=ki(r,i,n),a=o.twin,s=o.incidentFace,c=a.incidentFace;if(s!==c){var u=this[$o](s)?c:s,l=new ya(this,u);pa(l)[Ri](),this[Co][No](l)}var h=new $a(this,o),f=new $a(this,a),d=new sa(this,ma(h));return this[Co][Ao](h),this[Co][Ao](f),this[Co][Fo](d),d}},{key:r,value:function(t,e){var n=p.splitHalfEdgeByVertex(t[na][Ro],e[Yi]),r=t[na][Mo],i=new $a(this,n),o=new $a(this,r),a=new sa(this,ma(i));return t[ra][Bo]=t,this[Co][Ao](i),this[Co][Ao](o),this[Co][Fo](a),a}},{key:i,value:function(t){var e=t[Yi],n=p.getVertexHalfEdgeList(e);2!==n.length&&dt["b"].throwError("The MeshHalfEdge number of this MeshVertex is NOT 2.");var r=this[wo](e.incidentEdge.twin.next)[Bo],i=this[wo](e.incidentEdge)[Bo],o=this[wo](Di(e));o[Uo][Bo]=i,i[na]=o,r[na]=n[0];var a,s=Object(ct["a"])(n);try{for(s.s();!(a=s.n()).done;){var c=a.value;this[wo](c)[Bo]=r}}catch(u){s.e(u)}finally{s.f()}return this[Eo](),this[ro].delete(t[Yi]),this[to].delete(t),this[Co][Lo](t.$),i}},{key:o,value:function(t){var e=t[na],n=e[Ro],r=Wi(n);return this[ko](),this[Eo](),this[So](),this[mo](r)}},{key:a,value:function(t){Li(t[Yi]),this[Eo](),this[So]()}},{key:s,value:function(t){this[fo](t),t[Mi](),this[ro].delete(t[Yi]),this[to].delete(t),this[Co][Lo](t.$)}},{key:c,value:function(t){Pi(t[na][Ro]),this[Eo](),this[So]()}},{key:u,value:function(t){return this[to].has(t)}},{key:l,value:function(t){return this[Zi].has(t)}},{key:h,value:function(t){return this[eo].has(t)}},{key:f,value:function(){return Array.from(this[Zi])}},{key:d,value:function(){return Array.from(this[eo])}},{key:v,value:function(){return Array.from(this[to])}},{key:y,value:function(t,e){var n=this[no],r=n[ca],i=p.getFaceOfPoint(r,{x:t,y:e});return i===r?n:this[$o](i)}},{key:g,value:function(){var t,e=this[ro],n=this[to],r=[],i=Object(ct["a"])(e);try{for(i.s();!(t=i.n()).done;){var o=Object(re["a"])(t.value,2),a=o[0],s=o[1];dt["g"].isNull(a.incidentEdge)&&(n.delete(s),s[Mi](),r.push(a),this[Co][Lo](s.$))}}catch(h){i.e(h)}finally{i.f()}for(var c=0,u=r;c<u.length;c++){var l=u[c];e.delete(l)}}},{key:b,value:function(){var t,e=this[oo],n=this[Zi],r=[],i=new Set,o=Object(ct["a"])(e);try{for(o.s();!(t=o.n()).done;){var a=Object(re["a"])(t.value,2),s=a[0],c=a[1];if(dt["g"].isNull(s.twin)){var u=c[Bo];n.delete(u),u[Mi](),c[Mi](),r.push(s),i.add(u),this[Co][Io](c.$)}}}catch(y){o.e(y)}finally{o.f()}for(var l=0,h=r;l<h.length;l++){var f=h[l];e.delete(f)}var d,p=Object(ct["a"])(i);try{for(p.s();!(d=p.n()).done;){var v=d.value;this[Co][Do](v.$)}}catch(y){p.e(y)}finally{p.f()}}},{key:m,value:function(){var t,e=this[io],n=this[eo],r=[],i=Object(ct["a"])(e);try{for(i.s();!(t=i.n()).done;){var o=Object(re["a"])(t.value,2),a=o[0],s=o[1];dt["g"].isNull(a.outerComponent)&&(n.delete(s),s[Mi](),r.push(a),this[Co][Wo](s.$))}}catch(h){i.e(h)}finally{i.f()}for(var c=0,u=r;c<u.length;c++){var l=u[c];e.delete(l)}}}]),w}(ao,so,co,uo,lo,ho,fo,po,vo,yo,go,bo,Oo,To,jo,xo,ko,Eo,So),Ta=function(){function t(){Object(ut["a"])(this,t),new ja(this),dt["e"].seal(this)}return Object(lt["a"])(t,[{key:"globalFace",get:function(){return Oa(this)[no].$}},{key:"createVertex",value:function(t,e){return dt["g"].Not.Number(t)&&dt["b"].throwError("The `x` MUST be a number."),dt["g"].Not.Number(e)&&dt["b"].throwError("The `y` MUST be a number."),Oa(this)[ao](t,e)}},{key:"moveVertex",value:function(t,e,n){dt["b"].instanceOf(t,Jo)||dt["b"].Throw.TypeError("The `vertex` MUST be a MeshVertex."),dt["g"].Not.Number(e)&&dt["b"].Throw.TypeError("Vertex.x MUST be a number."),dt["g"].Not.Number(n)&&dt["b"].Throw.TypeError("Vertex.y MUST be a number.");var r=Oa(this),i=Go(t);return r[yo](i)||dt["b"].throwError("The `vertex` does NOT belong to this mesh."),r[so](i,e,n)}},{key:"link",value:function(t,e){dt["b"].instanceOf(t,Jo)||dt["b"].Throw.TypeError("The `thisVertex` MUST be a MeshVertex."),dt["b"].instanceOf(e,Jo)||dt["b"].Throw.TypeError("The `thatVertex` MUST be a MeshVertex.");var n=Oa(this),r=Go(t),i=Go(e);return n[yo](r)||dt["b"].throwError("The `thisVertex` does NOT belong to this mesh."),n[yo](i)||dt["b"].throwError("The `thatVertex` does NOT belong to this mesh."),n[co](r,i)}},{key:"split",value:function(t,e){dt["b"].instanceOf(t,sa)||dt["b"].Throw.TypeError("The `edge` MUST be a MeshEdge."),dt["b"].instanceOf(e,Jo)||dt["b"].Throw.TypeError("The `vertex` MUST be a MeshVertex.");var n=Oa(this),r=oa(t),i=Go(e);return n[go](r)||dt["b"].throwError("The `edge` does NOT belong to this mesh."),n[yo](i)||dt["b"].throwError("The `vertex` does NOT belong to this mesh."),n[uo](r,i)}},{key:"merge",value:function(t){dt["b"].instanceOf(t,Jo)||dt["b"].Throw.TypeError("The `vertex` MUST be a MeshVertex.");var e=Oa(this)[lo](Go(t));return dt["g"].isNull(e)?null:e.$}},{key:"combine",value:function(t){dt["b"].instanceOf(t,sa)||dt["b"].Throw.TypeError("The `edge` MUST be a MeshEdge.");var e=Oa(this)[ho](oa(t));return dt["g"].isUndefined(e)?null:e.$}},{key:"clearVertex",value:function(t){dt["b"].instanceOf(t,Jo)||dt["b"].Throw.TypeError("The `vertex` MUST be a MeshVertex.");var e=Oa(this),n=Go(t);e[yo](n)||dt["b"].throwError("The `vertex` does NOT belong to this mesh."),e[fo](n)}},{key:"removeVertex",value:function(t){dt["b"].instanceOf(t,Jo)||dt["b"].Throw.TypeError("The `vertex` MUST be a MeshVertex.");var e=Oa(this),n=Go(t);e[yo](n)||dt["b"].throwError("The `vertex` does NOT belong to this mesh."),e[po](n)}},{key:"removeEdge",value:function(t){dt["b"].instanceOf(t,sa)||dt["b"].Throw.TypeError("The `edge` MUST be a MeshEdge.");var e=Oa(this),n=oa(t);e[go](n)||dt["b"].throwError("The `edge` does NOT belong to this mesh."),e[vo](n)}},{key:"getAllVertexList",value:function(){return Oa(this)[jo]().map(qo)}},{key:"getAllEdgeList",value:function(){return Oa(this)[Oo]().map(qo)}},{key:"getAllFaceList",value:function(){return Oa(this)[To]().map(qo)}},{key:"hasVertex",value:function(t){return dt["b"].instanceOf(t,Jo)||dt["b"].Throw.TypeError("The `vertex` MUST be a MeshVertex."),Oa(this)[yo](Go(t))}},{key:"hasEdge",value:function(t){return dt["b"].instanceOf(t,sa)||dt["b"].Throw.TypeError("The `edge` MUST be a MeshEdge."),Oa(this)[go](oa(t))}},{key:"hasFace",value:function(t){return dt["b"].instanceOf(t,ya)||dt["b"].Throw.TypeError("The `face` MUST be a MeshFace."),Oa(this)[bo](pa(t))}},{key:"getFaceOfPoint",value:function(t,e){return dt["g"].Not.Number(t)&&dt["b"].Throw.TypeError("The `x` MUST be a number."),dt["g"].Not.Number(e)&&dt["b"].Throw.TypeError("The `y` MUST be a number."),Oa(this)[xo](t,e).$}},{key:"flush",value:function(){var t=Oa(this);t[ko](),t[Eo](),t[So]()}},{key:"flushVertex",value:function(){Oa(this)[ko]()}}]),t}(),ka=function(){var t=Object(re["a"])(Sa[Ea],2),e=t[0],n=t[1];dt["e"].defineProperty(Ta.prototype,e,{get:function(){return Oa(this)[Co][n]},set:function(t){dt["g"].Not.Function(t)&&dt["b"].Throw.TypeError("listener MUST be a function."),Oa(this)[Co][n]=t}})},Ea=0,Sa=[["onVertexCreate",Po],["onVertexDestroy",Lo],["onEdgeCreate",Fo],["onEdgeDestroy",Do],["onFaceCreate",No],["onFaceDestroy",Wo],["onHalfEdgeCreate",Ao],["onHalfEdgeDestroy",Io]];Ea<Sa.length;Ea++)ka();function Ca(){return{mesh:new Ta,vertexToCorner:new Map,edgeToWall:new Map,faceToRoom:new Map,halfEdgeToSurface:new Map}}var Pa=x.define({options:$i,data:Ca,proxy:b.Proxy.Creator(yi),created:function(){var t=this,e=this.$data,n=e.mesh,r=e.vertexToCorner,i=e.edgeToWall,o=e.halfEdgeToSurface,a=e.faceToRoom;n.onFaceCreate=function(e){return t.$createElement("Room",e)},n.onEdgeCreate=function(e){return t.$createElement("Wall",e)},n.onVertexCreate=function(e){return t.$createElement("Corner",e)},n.onHalfEdgeCreate=function(e){return t.$createElement("Surface",e)},n.onFaceDestroy=function(t){a.get(t).$destroy(),a.delete(t)},n.onVertexDestroy=function(t){r.get(t).$destroy(),r.delete(t)},n.onEdgeDestroy=function(t){i.get(t).$destroy(),i.delete(t)},n.onHalfEdgeDestroy=function(t){o.get(t).$destroy(),o.delete(t)},this.$on("element-created",(function(e,n){t.$emit("".concat(n.toLowerCase(),"-created"),e)}));var s=this.$options.snap;this.$drawing.registerSnap({name:"structure-corner",get priority(){return s.corner.priority},get active(){return s.corner.active},handle:function(e,n,i){var o,a=Object(ct["a"])(r);try{for(a.s();!(o=a.n()).done;){var u=Object(re["a"])(o.value,1),l=u[0],h=t.$toCanvas(l.x,l.y),f=c.distanceToPoint.apply(c,[e,n].concat(Object(ft["a"])(h)));if(f<s.corner.maxDistance)return i.apply(void 0,Object(ft["a"])(h))}}catch(d){a.e(d)}finally{a.f()}}})},methods:{assertNoCornerAt:function(t,e){this.queryCorner(t,e)&&dt["b"].throwError("It could NOT create a new `Corner` in same place")},createCorner:function(t,e){this.assertNoCornerAt(t,e);var n=this.$data,r=n.mesh,i=n.vertexToCorner;return i.get(r.createVertex(t,e))},removeCorner:function(t){return t.remove()},createWall:function(t,e){var n=this.$data,r=n.mesh,i=n.edgeToWall;return i.get(r.link(t.vertex,e.vertex))},removeWall:function(t){return t.remove()},removeWallSimple:function(t){return t.removeSimple()},split:function(t,e,n){this.assertNoCornerAt(e,n);var r=t.thisSurface.corner,i=t.thatSurface.corner,o=this.createCorner(e,n);return this.$data.mesh.split(t.$state.edge,o.vertex),r.updateSurface(),i.updateSurface(),o.updateSurface(),o},merge:function(t){var e=this.$data,n=e.mesh,r=e.edgeToWall,i=n.merge(t.$state.vertex),o=r.get(i);return o.thisSurface.corner.updateSurface(),o.thatSurface.corner.updateSurface(),o},combine:function(t){var e=this.$data,n=e.mesh,r=e.vertexToCorner,i=n.combine(t.$state.edge),o=r.get(i);return o.updateAllSiblingSurface(),o},queryCorner:function(t,e){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=Object(ct["a"])(this.$data.vertexToCorner);try{for(i.s();!(n=i.n()).done;){var a=Object(re["a"])(n.value,2),s=a[0],c=a[1],u=o.fromBothPoint(s.x,s.y,t,e);if(o.length.apply(o,Object(ft["a"])(u))<r)return c}}catch(l){i.e(l)}finally{i.f()}return null},queryWallByFromTo:function(t,e){return t.getWallByToCorner(e)},getRoomOfPoint:function(t,e){var n=this.$data,r=n.mesh,i=n.faceToRoom;return i.get(r.getFaceOfPoint(t,e))}}}),La=function(t,e,n,r,i){var a=o.fromBothPoint(t,e,n,r),s=o.normalize.apply(o,Object(ft["a"])(a)),c=o.rotate90.apply(o,Object(ft["a"])(s)),u=o.multiply.apply(o,Object(ft["a"])(c).concat([i]));return Object(ft["a"])(u)},Fa=function(t){return[t.x,t.y]},Da=function(t){return t.back.vertex},Na=function(t){return t.updateSurface()};function Wa(t){return this.get(t)}var Aa=x.Element.define({proxy:b.Proxy.Creator(di),groupIndex:1e3,interative:!0,focusable:!0,hoverable:!0,render:function(t){var e=this.$plugin.$options.corner.style,n=e.color,r=e.opacity,i=e.radius,o=e.hover,a=this.$state.vertex,s=a.x,c=a.y,u=this.$toCanvas(s,c),l=Object(re["a"])(u,2),h=l[0],f=l[1];this.$hovering?t.beginFill(o.color,o.opacity):t.beginFill(n,r),t.drawCircle(0,0,i).endFill(),t.x=h,t.y=f},created:function(t){this.$data.vertexToCorner.set(this.$state.vertex=t,this)},state:function(){return{vertex:null}},getters:{x:function(){return this.vertex.x},y:function(){return this.vertex.y},vertex:function(){return this.$state.vertex},size:function(){return this.$state.vertex.size},destroyed:function(){return this.$state.vertex.destroyed}},methods:{move:function(t,e){var n=this.$plugin.queryCorner(t,e);dt["g"].Not.Null(n)&&n!==this&&dt["b"].throwError("It could NOT move the Corner to the same <".concat(t,", ").concat(e,"> place.")),this.$state.vertex.move(t,e),this.updateAllSiblingSurface(),this.$setDirty()},remove:function(){var t=this.$state.vertex,e=this.$data,n=e.mesh,r=e.vertexToCorner,i=t.getHalfEdgeList().map(Da).map(Wa,r);n.removeVertex(t);var o,a=Object(ct["a"])(i);try{for(a.s();!(o=a.n()).done;){var s=o.value;s.updateSurface()}}catch(c){a.e(c)}finally{a.f()}return this},surfaces:regeneratorRuntime.mark((function t(){var e,n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(ct["a"])(this.$state.vertex.halfEdges()),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return r=n.value,t.next=7,this.$data.halfEdgeToSurface.get(r);case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])})),getWallByToCorner:function(t){var e,n=Object(ct["a"])(this.surfaces());try{for(n.s();!(e=n.n()).done;){var r=e.value;if(r.back.corner===t)return r.wall}}catch(i){n.e(i)}finally{n.f()}return null},getAdjacentCornerList:function(){return this.$state.vertex.getHalfEdgeList().map(Da).map(Wa,this.$data.vertexToCorner)},updateAllSiblingSurface:function(){this.getAdjacentCornerList().concat([this]).forEach(Na)},updateSurface:function(){var t=this.$data,e=t.edgeToWall,n=t.halfEdgeToSurface,r=this.$state.vertex,i=r.getHalfEdgeList(),o=i.length;for(var a in i){var u=i[(a+o-1)%o],h=i[a],f=e.get(u.edge),d=e.get(h.edge),p=h.vertex,v=h.next,y=h.previous,g=Fa(y.vertex),b=Fa(p),m=Fa(v.vertex),w=La.apply(void 0,Object(ft["a"])(g).concat(Object(ft["a"])(b),[f.$state.thickness/2])),$=La.apply(void 0,Object(ft["a"])(b).concat(Object(ft["a"])(m),[d.$state.thickness/2])),x=Object(ft["a"])(c.translate.apply(c,Object(ft["a"])(b).concat(Object(ft["a"])(w)))),O=Object(ft["a"])(c.translate.apply(c,Object(ft["a"])(b).concat(Object(ft["a"])($)))),j=[].concat(Object(ft["a"])(c.translate.apply(c,Object(ft["a"])(g).concat(Object(ft["a"])(w)))),Object(ft["a"])(x)),T=[].concat(Object(ft["a"])(O),Object(ft["a"])(c.translate.apply(c,Object(ft["a"])(m).concat(Object(ft["a"])($))))),k=l.intersectSegment.apply(l,Object(ft["a"])(j).concat(Object(ft["a"])(T))),E=n.get(h),S=n.get(y);if(dt["g"].isNull(k)){var C=s.intersectLine.apply(s,Object(ft["a"])(x).concat(Object(ft["a"])(w),Object(ft["a"])(O),Object(ft["a"])($)));dt["g"].isNull(C)?(S.setTarget.apply(S,Object(ft["a"])(x)),E.setOrigin.apply(E,Object(ft["a"])(O))):(S.setTarget.apply(S,Object(ft["a"])(C)),E.setOrigin.apply(E,Object(ft["a"])(C)))}else S.setTarget.apply(S,Object(ft["a"])(k)),E.setOrigin.apply(E,Object(ft["a"])(k));d.$setDirty()}}}},Pa),Ia=x.Element.define({proxy:b.Proxy.Creator(vi),groupIndex:900,interative:!0,focusable:!0,hoverable:!0,render:function(t){var e,n,r=this.$plugin.$options.wall,i=r.midline,o=r.style,a=o.color,s=o.hoverColor,c=this.$state.edge,u=c.thisVertex,l=c.thatVertex,h=[u.x,u.y],f=[l.x,l.y];(t.beginFill(this.$hovering?s:a),this.drawPolygon(t),t.endFill(),i.show)&&(e=(n=t.lineStyle(i.width,i.color)).moveTo.apply(n,Object(ft["a"])(this.$toCanvas.apply(this,h)))).lineTo.apply(e,Object(ft["a"])(this.$toCanvas.apply(this,f)))},created:function(t){var e=this,n=t.thisVertex,r=t.thatVertex,i=this.$data,o=i.edgeToWall,a=i.vertexToCorner;o.set(this.$state.edge=t,this),a.get(n).updateSurface(),a.get(r).updateSurface(),this.$on("dirty",(function(){if(!t.destroyed){var n=e.thisSurface,r=e.thatSurface,i=n.room,o=r.room;dt["g"].Not.Null(i)&&i.$setDirty(),dt["g"].Not.Null(o)&&o.$setDirty(),n.emitChange(),r.emitChange()}}))},state:function(){return{type:0,thickness:300,edge:null}},getters:{thisSurface:function(){return this.$data.halfEdgeToSurface.get(this.$state.edge.thisHalfEdge)},thatSurface:function(){return this.$data.halfEdgeToSurface.get(this.$state.edge.thatHalfEdge)}},methods:{drawPolygon:function(t){var e=this.$state.edge,n=e.thisVertex,r=e.thatVertex,i=[n.x,n.y],o=[r.x,r.y],a=this.thisSurface,s=this.thatSurface;t.drawPolygon.apply(t,Object(ft["a"])(this.$toCanvas.apply(this,i)).concat(Object(ft["a"])(this.$toCanvas.apply(this,Object(ft["a"])(a.origin))),Object(ft["a"])(this.$toCanvas.apply(this,Object(ft["a"])(a.target))),Object(ft["a"])(this.$toCanvas.apply(this,o)),Object(ft["a"])(this.$toCanvas.apply(this,Object(ft["a"])(s.origin))),Object(ft["a"])(this.$toCanvas.apply(this,Object(ft["a"])(s.target)))))},setThickness:function(t){this.$state.thickness=t,this.thisSurface.corner.updateSurface(),this.thatSurface.corner.updateSurface(),this.$setDirty()},remove:function(){var t=this.thisSurface.corner,e=this.thatSurface.corner;this.removeSimple();for(var n=0,r=[t,e];n<r.length;n++){var i=r[n];0===i.size?i.remove():i.updateSurface()}return this.$proxy},removeSimple:function(){return this.$data.mesh.removeEdge(this.$state.edge),this.$proxy}}},Pa),Ma=(n("fb6a"),function(t){Object(Ke["a"])(n,t);var e=Object(Xe["a"])(n);function n(){return Object(ut["a"])(this,n),e.apply(this,arguments)}return Object(lt["a"])(n,[{key:"back",get:function(){return Hr(this).back.$proxy}},{key:"previous",get:function(){return Hr(this).previous.$proxy}},{key:"next",get:function(){return Hr(this).next.$proxy}},{key:"corner",get:function(){return Hr(this).corner.$proxy}},{key:"wall",get:function(){return Hr(this).wall.$proxy}},{key:"room",get:function(){var t=Hr(this).room;return t?t.$proxy:null}},{key:"origin",get:function(){return Hr(this).origin}},{key:"target",get:function(){return Hr(this).target}},{key:"originSafe",get:function(){return this.origin.slice(0)}},{key:"targetSafe",get:function(){return this.target.slice(0)}}]),n}(b.Proxy.Element)),Ra=function(t,e,n){n[0]=t,n[1]=e},Ha=x.Element.define({proxy:b.Proxy.Creator(Ma),groupIndex:920,state:function(){return{halfEdge:null,origin:[0,0],target:[0,0]}},render:function(t){var e,n,r,i=this.$state,o=i.origin,a=i.target;(e=(n=(r=t.lineStyle(1.5,2236962)).moveTo.apply(r,Object(ft["a"])(this.$toCanvas.apply(this,Object(ft["a"])(o))))).lineTo.apply(n,Object(ft["a"])(this.$toCanvas.apply(this,Object(ft["a"])(a))))).lineTo.apply(e,Object(ft["a"])(this.$toCanvas.apply(this,Object(ft["a"])(this.next.origin))))},created:function(t){this.$data.halfEdgeToSurface.set(this.$state.halfEdge=t,this)},getters:{next:function(){return this.$data.halfEdgeToSurface.get(this.$state.halfEdge.next)},previous:function(){return this.$data.halfEdgeToSurface.get(this.$state.halfEdge.previous)},back:function(){return this.$data.halfEdgeToSurface.get(this.$state.halfEdge.back)},corner:function(){return this.$data.vertexToCorner.get(this.$state.halfEdge.vertex)},wall:function(){return this.$data.edgeToWall.get(this.$state.halfEdge.edge)},room:function(){var t=this.$state.halfEdge.face,e=this.$data.faceToRoom.get(t);return dt["g"].isUndefined(e)?null:e},origin:function(){return this.$state.origin},target:function(){return this.$state.target}},methods:{setOrigin:function(t,e){return Ra(t,e,this.$state.origin),this.$setDirty(),this},setTarget:function(t,e){return Ra(t,e,this.$state.target),this.$setDirty(),this},emitChange:function(){this.$emit("change")}}},Pa),Ba=function(t){Object(Ke["a"])(n,t);var e=Object(Xe["a"])(n);function n(){return Object(ut["a"])(this,n),e.apply(this,arguments)}return Object(lt["a"])(n,[{key:"area",get:function(){return 0}},{key:"bounds",get:function(){return Hr(this).$getBounds()}},{key:"setFloor",value:function(t){return Hr(this).setFloor(t)}},{key:"getOuterSurfaceList",value:function(){return Hr(this).getOuterSurfaceList()}}]),n}(b.Proxy.Element),_a=cn;function Va(t){return this.get(t)}var za,Ua,Ya,Ga=x.Element.define({proxy:b.Proxy.Creator(Ba),groupIndex:800,interative:!0,focusable:!0,hoverable:!0,render:function(t){var e,n=[],r=this.$drawing,i=r.origin,o=r.scale,a=this.$state.face.getOuterHalfEdgeList().map(Va,this.$data.halfEdgeToSurface),s=Object(ct["a"])(a);try{for(s.s();!(e=s.n()).done;){var c=e.value;n.push.apply(n,Object(ft["a"])(this.$toCanvas.apply(this,Object(ft["a"])(c.origin))).concat(Object(ft["a"])(this.$toCanvas.apply(this,Object(ft["a"])(c.target)))))}}catch(u){s.e(u)}finally{s.f()}this.$plugin.$options.room.show&&(this.$state.floor&&t.beginTextureFill({texture:this.$state.floor,matrix:Object(un["a"])(_a.Matrix,[5/o,0,0,5/o].concat(Object(ft["a"])(i)))}),t.drawPolygon(n).endFill())},state:function(){return{face:null,floor:null}},created:function(t){this.$data.faceToRoom.set(this.$state.face=t,this)},methods:{setFloor:function(t){var e=this;return Object(Qr["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,_a.Texture.fromURL(t);case 2:e.$state.floor=n.sent,e.$setDirty();case 4:case"end":return n.stop()}}),n)})))()},getOuterSurfaceList:function(){var t=this.$data.halfEdgeToSurface,e=this.$state.face;return e.getOuterHalfEdgeList().map((function(e){return t.get(e).$proxy}))}}},Pa),Ka="com.3dnest.spoke.structure",Xa="structure",qa=O.define({id:Ka,namespace:Xa,version:hi["a"],plugin:Pa,elements:{Corner:Aa,Wall:Ia,Surface:Ha,Room:Ga}}),Ja=function(t){Object(Ke["a"])(n,t);var e=Object(Xe["a"])(n);function n(){return Object(ut["a"])(this,n),e.apply(this,arguments)}return Object(lt["a"])(n,[{key:"Builder",get:function(){return Hr(this).$data.builder}},{key:"Mover",get:function(){return Hr(this).$data.mover}},{key:"Spliter",get:function(){return Hr(this).$data.spliter}},{key:"Extender",get:function(){return Hr(this).$data.extender}},{key:"Chamber",get:function(){return Hr(this).$data.chamber}}]),n}(b.Proxy.Plugin),Qa=b.Options.define,Za=Qa({},{spliter:Qa({},{interaction:Qa({distance:50})})}),ts=x.define({options:Za,proxy:b.Proxy.Creator(Ja),data:function(){return{builder:null,mover:null,spliter:null,extender:null,chamber:null}},created:function(){dt["e"].assign(this.$data,{builder:this.$createTool("Builder"),mover:this.$createTool("Mover"),spliter:this.$createTool("Spliter"),extender:this.$createTool("Extender"),chamber:this.$createTool("Chamber")})}}),es=5,ns=65280,rs=x.Element.define({groupIndex:1200,interative:!0,state:function(){return{from:[0,0],to:[0,0]}},render:function(t){var e=this.$state,n=e.from,r=e.to,i=this.$toCanvas.apply(this,Object(ft["a"])(n)),o=Object(re["a"])(i,2),a=o[0],s=o[1],c=this.$toCanvas.apply(this,Object(ft["a"])(r)),u=Object(re["a"])(c,2),l=u[0],h=u[1];t.lineStyle(20,10066329,1,.5).moveTo(a,s).lineTo(l,h).beginFill(ns).lineStyle(0).drawCircle(l,h,es).drawCircle(a,s,es)},created:function(){this.$hide()},methods:{setFrom:function(t,e){var n=this.$state,r=n.from,i=n.to;r[0]=i[0]=t,r[1]=i[1]=e,this.$setDirty()},setTo:function(t,e){this.$state.to[0]=t,this.$state.to[1]=e,this.$setDirty()}}},ts),is=Symbol("PickupFrom"),os=Symbol("PickupTo"),as=x.Tool.READY,ss=function(t){Object(Ke["a"])(n,t);var e=Object(Xe["a"])(n);function n(){return Object(ut["a"])(this,n),e.apply(this,arguments)}return Object(lt["a"])(n,[{key:"setFromByTo",value:function(){return Hr(this).setFromByTo(),this}},{key:"setThickness",value:function(){}},{key:"setAlignment",value:function(){}}]),n}(b.Proxy.ToolProvider(["build","pick","drop"])),cs=x.Tool.define(Object(ht["a"])({},as,{entry:function(){this.$data.indicator.$hide()},leave:function(){this.$data.indicator.$show()}}),{build:[os,function(){var t=this.$data,e=t.from,n=t.to,r=this.$plugin.$drawing.structure,i=this.queryOrCreateCorner.apply(this,Object(ft["a"])(e)),o=this.queryOrCreateCorner.apply(this,Object(ft["a"])(n));r.createWall(i,o),this.setFromByTo(),this.$emit("end"),this.$emit("build")},as],pick:[[as,dt["d"],is],[is,dt["d"],os]],drop:[[os,dt["d"],is],[is,dt["d"],as],[as,dt["d"],as]]},{proxy:b.Proxy.Creator(ss),data:function(t){var e,n=this,r=t.$createElement("Builder"),i=[0,0],o=[0,0],a=(e={},Object(ht["a"])(e,is,(function(t){dt["e"].assign(i,t),r.setFrom.apply(r,Object(ft["a"])(t))})),Object(ht["a"])(e,os,(function(t){dt["e"].assign(o,t),r.setTo.apply(r,Object(ft["a"])(t))})),e);return t.$drawing.on("pointermove",(function(e){if(n.$state!==as){var r=e.virtualX,i=e.virtualY;a[n.$state](t.$toGeometry(r,i))}})),{indicator:r,thickness:200,from:i,to:o}},reset:function(){this.$data.indicator.$hide(),this.$emit("end")},methods:{queryOrCreateCorner:function(t,e){var n=this.$plugin.$drawing.structure,r=n.queryCorner(t,e,us);return r||n.createCorner(t,e)},setFromByTo:function(){var t=this.$data,e=t.from,n=t.to,r=t.indicator;dt["e"].assign(e,n),r.setFrom.apply(r,Object(ft["a"])(e))}}}),us=10,ls=0,hs=1,fs=function(t){return t.corner},ds=function(t){return t.back.corner},ps=(za={},Object(ht["a"])(za,ls,dt["e"].freeze({name:ls,isBare:function(t){return t.previous===t.back},getSibling:function(t){return t.previous},getSourceCorner:ds,getTargetCorner:fs,compare:a.LT})),Object(ht["a"])(za,hs,dt["e"].freeze({name:hs,isBare:function(t){return t.next===t.back},getSibling:function(t){return t.next},getSourceCorner:fs,getTargetCorner:ds,compare:a.GT})),za),vs=(n("00b4"),function(t){return o.fromBothPoint.apply(o,Object(ft["a"])(t.corner.point).concat(Object(ft["a"])(t.next.corner.point)))}),ys=function(t,e){return o.cross.apply(o,Object(ft["a"])(vs(t)).concat(Object(ft["a"])(vs(e))))},gs=function(t,e){return o.dot.apply(o,Object(ft["a"])(vs(t)).concat(Object(ft["a"])(vs(e))))},bs=function(t){return s.fromSegment.apply(s,Object(ft["a"])(t.corner.point).concat(Object(ft["a"])(t.next.corner.point)))},ms=function(t){return bs(t.current)},ws=function(t){var e=t.plan.structure,n=e.createCorner.apply(e,Object(ft["a"])(t.intersection));return e.createWall(t.accessor.getSourceCorner(t.current),n),n},$s=[{name:"⊥",test:function(t){return a.EQ_0(ys(t.current,t.base))},execute:ws,Line:function(t,e){return[].concat(Object(ft["a"])(e.getSourceCorner(t.current).point),Object(ft["a"])(o.fromSegment.apply(o,Object(ft["a"])(t.target))))}},{name:"<",test:function(t,e){return e.compare(ys(t.current,t.base),0)},execute:ws,Line:ms},{name:"x",test:function(t){var e=t.current.corner,n=t.current.next.corner;return c.toLeftOfSegment.apply(c,Object(ft["a"])(e.point).concat(Object(ft["a"])(t.target)))!==c.toLeftOfSegment.apply(c,Object(ft["a"])(n.point).concat(Object(ft["a"])(t.target)))},execute:function(t){var e=t.plan.structure,n=t.accessor.getSourceCorner(t.current),r=e.split.apply(e,[t.current.wall].concat(Object(ft["a"])(t.intersection)));return t.weak&&setTimeout((function(){r.getWallByToCorner(n).remove()}),5),r},Line:ms},{name:"bare",test:function(t,e){return e.isBare(t.current)},execute:function(t){var e=t.accessor.getTargetCorner(t.current);return e.move.apply(e,Object(ft["a"])(t.intersection)),e},Line:function(t,e){return t.currentSide.weak?[].concat(Object(ft["a"])(e.getTargetCorner(t.current).point),Object(ft["a"])(o.fromSegment.apply(o,Object(ft["a"])(t.target)))):ms(t)}},{test:function(t,e){e.getSibling(t.current)===t.base&&dt["b"].throwError("Undefined target surface rule.")}}],xs={name:"null",execute:function(t){var e;return(e=t.plan.structure).createCorner.apply(e,Object(ft["a"])(t.intersection))}},Os=function(t,e){var n,r=Object(ct["a"])($s);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.test(t,e))return i}}catch(o){r.e(o)}finally{r.f()}return xs},js=[0,0,1,1],Ts=[0,0],ks=js,Es=[0,0],Ss=function(){function t(e,n){Object(ut["a"])(this,t),this.plan=e,this.accessor=n,this.rule=xs,this.path=[],this.weak=!1,this.intersection=dt["e"].assign([],Es),this.current=null,this.line=dt["e"].assign([],ks)}return Object(lt["a"])(t,[{key:"merging",get:function(){var t=this.plan.base;if(dt["g"].isNull(t))return!1;var e=this.accessor.getTargetCorner(t);return 2===e.size&&this.rule===$s[1]?a.EQ_0(gs(t,this.accessor.getSibling(t))):3===e.size&&a.EQ_0(ys(t.next,t.back.previous))}},{key:"executeRule",value:function(){return this.rule.execute(this)}},{key:"reset",value:function(){this.rule=xs,this.current=null,this.weak=!1,this.path.length=0,dt["e"].assign(this.line,ks),dt["e"].assign(this.intersection,Es)}}]),t}(),Cs=function(){function t(e){var n;Object(ut["a"])(this,t),this.sideName=ls,this.structure=e,this.base=null,this.current=null,this.target=[].concat(js),this.translation=[].concat(Ts),this.removing=new Set,this.side=(n={},Object(ht["a"])(n,ls,new Ss(this,ps[ls])),Object(ht["a"])(n,hs,new Ss(this,ps[hs])),n)}return Object(lt["a"])(t,[{key:"currentSide",get:function(){return this.side[this.sideName]}},{key:"resolve",value:function(t,e){this.reset(),this.base=t,this.removing.add(t);var n=o.normalize.apply(o,Object(ft["a"])(vs(t))),r=o.rotate90.apply(o,Object(ft["a"])(n)),i=o.multiply.apply(o,Object(ft["a"])(r).concat([e]));dt["e"].assign(this.translation,i);var a=l.translate.apply(l,Object(ft["a"])(t.corner.point).concat(Object(ft["a"])(t.next.corner.point),Object(ft["a"])(i)));for(var c in dt["e"].assign(this.target,a),ps){this.sideName=c;var u=ps[c],h=this.currentSide;if(u.isBare(t))this.setSideLine(c,[].concat(Object(ft["a"])(u.getTargetCorner(t).point),Object(ft["a"])(vs(t))));else{var f=t,d=null,p=!0;do{f=this.current=u.getSibling(f),h.path.push(f),d=Os(this,u),p&&(p=h.weak=u.getSourceCorner(f).size<3,p&&this.removing.add(f))}while(d===xs);this.setSideLine(c,d.Line(this,u)),h.current=f,h.rule=d}var v=s.intersectLine.apply(s,Object(ft["a"])(h.line).concat(Object(ft["a"])(s.fromSegment.apply(s,Object(ft["a"])(a)))));dt["e"].assign(h.intersection,v)}}},{key:"execute",value:function(){var t=[];for(var e in this.side){var n=this.side[e];console.log(n.rule.name),n.merging&&t.push(n.accessor.getTargetCorner(this.base))}var r=this.side[ls].executeRule(),i=this.side[hs].executeRule();for(var o in this.structure.createWall(r,i),this.base.wall.remove(),this.removing)o.wall.remove();console.log(t);for(var a=0,s=t;a<s.length;a++){var c=s[a];this.structure.merge(c)}}},{key:"reset",value:function(){this.base=null,this.current=null,this.sideName=ls,dt["e"].assign(this.target,js),dt["e"].assign(this.translation,Ts),this.removing.clear(),this.side[ls].reset(),this.side[hs].reset()}},{key:"setSideLine",value:function(t,e){return dt["e"].assign(this.side[t].line,e)}}]),t}(),Ps=x.Element.define({groupIndex:1220,interative:!0,state:function(){var t=this;return{wall:null,pointer:[0,0],plan:null,updatePointer:function(e){t.setPointer([e.pointerX,e.pointerY])},finish:function(){t.unbind(),t.$emit("finish")},cancel:function(e){2===e.button&&(t.unbind(),t.$emit("cancel"))}}},render:function(t){var e,n,r,i,o,a=this.$state,s=a.wall,u=a.pointer,l=a.plan,h=this.$toGeometry.apply(this,Object(ft["a"])(u)),f=s.thisSurface,d=s.thatSurface,p=c.toLeftOfSegment.apply(c,Object(ft["a"])(h).concat(Object(ft["a"])(f.corner.point),Object(ft["a"])(d.corner.point)))?f:d,v=c.distanceToSegment.apply(c,Object(ft["a"])(h).concat(Object(ft["a"])(p.corner.point),Object(ft["a"])(p.back.corner.point)));for(var y in l.resolve(p,v),(e=(n=t.lineStyle(10,255)).moveTo.apply(n,Object(ft["a"])(this.$toCanvas.apply(this,Object(ft["a"])(p.origin))))).lineTo.apply(e,Object(ft["a"])(this.$toCanvas.apply(this,Object(ft["a"])(p.target)))),l.side){var g,b,m=l.side[y],w=m.path,$=m.intersection,x=Object(ct["a"])(w);try{for(x.s();!(b=x.n()).done;){var O,j,T=b.value;(O=(j=t.lineStyle(10,l.removing.has(T)?16711680:65280)).moveTo.apply(j,Object(ft["a"])(this.$toCanvas.apply(this,Object(ft["a"])(T.origin))))).lineTo.apply(O,Object(ft["a"])(this.$toCanvas.apply(this,Object(ft["a"])(T.target))))}}catch(L){x.e(L)}finally{x.f()}(g=t.lineStyle(5,65280)).drawCircle.apply(g,Object(ft["a"])(this.$toCanvas.apply(this,Object(ft["a"])($))).concat([5]))}var k=Object(re["a"])(l.target,4),E=k[0],S=k[1],C=k[2],P=k[3];(r=(i=t.lineStyle(3)).moveTo.apply(i,Object(ft["a"])(this.$toCanvas(E,S)))).lineTo.apply(r,Object(ft["a"])(this.$toCanvas(C,P))),(o=t.beginFill(0)).drawCircle.apply(o,Object(ft["a"])(this.$state.pointer).concat([5]))},created:function(){this.$hide(),this.$state.plan=new Cs(this.$drawing.structure)},methods:{bind:function(){var t=this.$state,e=t.updatePointer,n=t.finish,r=t.cancel;this.$drawing.on("pointermove",e),an["a"].addEventListener(an["c"].WINDOW,"mouseup",n),an["a"].addEventListener(an["c"].WINDOW,"mousedown",r),this.$show()},unbind:function(){var t=this.$state,e=t.updatePointer,n=t.finish,r=t.cancel;this.$drawing.off("pointermove",e),an["a"].removeEventListener(an["c"].WINDOW,"mouseup",n),an["a"].removeEventListener(an["c"].WINDOW,"mousedown",r),this.$hide()},setPointer:function(t){dt["e"].assign(this.$state.pointer,t),this.$setDirty()},setWall:function(t){this.$state.wall=t,this.$setDirty()},reset:function(){this.$state.wall=null,this.$hide()}}}),Ls=Symbol("ExtenderWaiting"),Fs=Symbol("ExtenderActive"),Ds=x.Tool.READY,Ns=x.Tool.define((Ua={},Object(ht["a"])(Ua,Fs,(function(){this.$data.indicator.bind()})),Object(ht["a"])(Ua,Ls,(function(){this.$data.indicator.unbind(),this.$data.wall=null})),Ua),{open:[[Ls,dt["d"],Ls],[Ds,dt["d"],Ls]],close:[[Ds,dt["d"],Ds],[Ls,dt["d"],Ds]],capture:[Ls,function(){var t=this.$data,e=t.indicator,n=t.wall;e.setWall(n)},Fs],release:[Fs,dt["d"],Ls],extend:[Fs,function(){this.$data.indicator.$state.plan.execute()},Ls]},{data:function(t){var e=this,n=t.$createElement("Extender"),r={indicator:n,wall:null};return n.$on("cancel",(function(){return e.release()})).$on("finish",(function(){return e.extend()})),t.$drawing.structure.on("wall-created",(function(t){t.on("pointerdown",(function(r){e.$state===Ls&&(r.stopPropagation(),n.setPointer([r.pointerX,r.pointerY]),e.setWall(t),e.capture())}))})),r},methods:{setWall:function(t){this.$data.wall=t,this.$data.indicator.setWall(t)},execute:function(){}}}),Ws=x.Element.define({groupIndex:1150,interative:!0,state:function(){var t=this;return{origin:[0,0],current:[0,0],adjacentList:[],updateCurrent:function(e){t.setCurrent([e.virtualX,e.virtualY])},finish:function(){t.unbind(),t.$emit("finish")},cancel:function(e){2===e.button&&(t.unbind(),t.$emit("cancel"))}}},getters:{active:function(){return this.$visible}},created:function(){this.$hide()},render:function(t){var e,n=this.$state,r=n.adjacentList,i=n.current,o=this.$drawing.structure.options.corner.style.radius;(e=t.beginFill(0)).drawCircle.apply(e,Object(ft["a"])(i).concat([o])).lineStyle(2,0);var a,s=Object(ct["a"])(r);try{for(s.s();!(a=s.n()).done;){var c,u,l,h=a.value,f=this.$toCanvas.apply(this,Object(ft["a"])(h));(c=(u=(l=t.beginFill(16777215)).drawCircle.apply(l,Object(ft["a"])(f).concat([o]))).moveTo.apply(u,Object(ft["a"])(f))).lineTo.apply(c,Object(ft["a"])(i))}}catch(d){s.e(d)}finally{s.f()}},methods:{bind:function(){var t=this.$state,e=t.updateCurrent,n=t.cancel,r=t.finish;this.$drawing.on("pointermove",e),an["a"].addEventListener(an["c"].WINDOW,"mouseup",r),an["a"].addEventListener(an["c"].WINDOW,"mousedown",n),this.$show()},unbind:function(){var t=this.$state,e=t.updateCurrent,n=t.cancel,r=t.finish;this.$drawing.off("pointermove",e),an["a"].removeEventListener(an["c"].WINDOW,"mouseup",r),an["a"].removeEventListener(an["c"].WINDOW,"mousedown",n),this.$hide()},setCurrent:function(t){dt["e"].assign(this.$state.current,t),this.$setDirty()},setOrigin:function(t){dt["e"].assign(this.$state.origin,t),this.setCurrent(this.$toCanvas.apply(this,Object(ft["a"])(t)))},setSiblingList:function(t){this.$state.adjacentList=t,this.$setDirty()}}},ts),As=Symbol("MoverWaiting"),Is=Symbol("MoverActive"),Ms=x.Tool.READY,Rs=["open","close"],Hs=function(t){return dt["b"].instanceOf(t,di)},Bs=function(t){Object(Ke["a"])(n,t);var e=Object(Xe["a"])(n);function n(){return Object(ut["a"])(this,n),e.apply(this,arguments)}return Object(lt["a"])(n,[{key:"setCorner",value:function(t){Hs(t)&&dt["b"].Throw.TypeError("Invalid corner, a Strucure.CornerProxy expected."),Hr(this).setCorner(t)}}]),n}(b.Proxy.ToolProvider(Rs)),_s=x.Tool.define((Ya={},Object(ht["a"])(Ya,Is,(function(){this.$data.indicator.bind()})),Object(ht["a"])(Ya,As,(function(){this.$data.indicator.unbind(),this.$data.corner=null})),Ya),{open:[[Ms,dt["d"],As],[As,dt["d"],As]],close:[[As,dt["d"],Ms],[Ms,dt["d"],Ms]],capture:[As,function(){this.setCorner(this.$data.corner)},Is],release:[Is,dt["d"],As],move:[Is,function(){var t,e=this.$plugin.$drawing.structure,n=this.$data,r=n.indicator,i=n.corner,o=(t=this.$plugin).$toGeometry.apply(t,Object(ft["a"])(r.$state.current)),a=e.queryCorner.apply(e,Object(ft["a"])(o)),s=dt["g"].isNull(a)?i:e.combine(e.createWall(a,i));s.move.apply(s,Object(ft["a"])(o))},As]},{proxy:b.Proxy.Creator(Bs),data:function(t){var e=this,n=t.$createElement("Mover"),r={corner:null,indicator:n};return n.$on("cancel",(function(){return e.release()})).$on("finish",(function(){return e.move()})),t.$drawing.structure.on("corner-created",(function(t){t.on("pointerdown",(function(n){e.$state===As&&(n.stopPropagation(),e.setCorner(t),e.capture())}))})),r},reset:function(){this.$data.indicator.$hide(),this.$data.corner=null},methods:{setCorner:function(t){var e=this.$data.indicator,n=t.getAdjacentCornerList().map(Vs);this.$data.corner=t,e.setOrigin(Vs(t)),e.setSiblingList(n)}}}),Vs=function(t){return[t.x,t.y]},zs=x.Element.define({groupIndex:1210,state:function(){return{breakpoint:[0,0],segment:[0,0,0,0]}},render:function(t){var e,n=this.$state,r=n.segment,i=n.breakpoint,o=Object(re["a"])(r,4),a=o[0],s=o[1],c=o[2],u=o[3];(e=t.lineStyle(1,0).moveTo(a,s).lineTo(c,u)).drawCircle.apply(e,Object(ft["a"])(i).concat([5]))},created:function(){this.$hide()},methods:{setBreakpoint:function(t){this.$state.breakpoint=t,this.$setDirty()},setSegment:function(t){this.$state.segment=t,this.$setDirty()}}},ts),Us=Symbol("SpliterDetecting"),Ys=Symbol("SpliterDetected"),Gs=x.Tool.READY,Ks=["open","close"],Xs=function(t){Object(Ke["a"])(n,t);var e=Object(Xe["a"])(n);function n(){return Object(ut["a"])(this,n),e.apply(this,arguments)}return Object(lt["a"])(n)}(b.Proxy.ToolProvider(Ks)),qs=x.Tool.define(Object(ht["a"])({},Ys,{entry:function(){this.$data.indicator.$show()},leave:function(){this.$data.indicator.$hide()}}),{open:[Gs,dt["d"],Us],found:[[Us,dt["d"],Ys],[Ys,dt["d"],Ys]],lost:[[Ys,dt["d"],Us],[Us,dt["d"],Us]],close:[[Gs,dt["d"],Gs],[Us,dt["d"],Gs],[Ys,dt["d"],Gs]]},{proxy:b.Proxy.Creator(Xs),data:function(t){var e=this,n=t.$createElement("Spliter"),r=t.$options,i=t.$drawing,o=i.structure,a=Date.now(),u=null,l=[0,0];return i.on("pointermove",(function(i){if(e.$state!==Gs){var h=Date.now();if(!(h-a<15)){a=h;var f,d=i.pointerX,p=i.pointerY,v=[d,p],y=Object(ct["a"])(o.getAllWallList());try{for(y.s();!(f=y.n()).done;){var g=f.value,b=g.thisSurface.corner,m=g.thatSurface.corner,w=[].concat(Object(ft["a"])(t.$toCanvas(b.x,b.y)),Object(ft["a"])(t.$toCanvas(m.x,m.y))),$=c.distanceToSegment.apply(c,v.concat(Object(ft["a"])(w)));if($<r.spliter.interaction.distance)return l=c.project.apply(c,v.concat(Object(ft["a"])(s.fromSegment.apply(s,Object(ft["a"])(w))))),u=g,n.setBreakpoint(l),n.setSegment(w),void e.found()}}catch(x){y.e(x)}finally{y.f()}e.lost()}}})).on("pointerup",(function(){e.$state===Ys&&o.split.apply(o,[u].concat(Object(ft["a"])(t.$toGeometry.apply(t,Object(ft["a"])(l)))))})),{indicator:n}},reset:function(){this.close()}}),Js=x.Element.define({groupIndex:1160,interative:!0,state:function(){return{from:[0,0],to:[0,0]}},created:function(){this.$hide()},render:function(t){var e=this.$state,n=e.from,r=e.to,i=this.$toCanvas.apply(this,Object(ft["a"])(n)),o=Object(re["a"])(i,2),a=o[0],s=o[1],c=this.$toCanvas.apply(this,Object(ft["a"])(r)),u=Object(re["a"])(c,2),l=u[0],h=u[1];t.lineStyle(2,0).moveTo(a,s).lineTo(a,h).lineTo(l,h).lineTo(l,s).closePath().beginFill(16711680).drawCircle(l,h,5).beginFill(65280).drawCircle(a,s,5)},methods:{setFrom:function(t,e){var n=this.$state,r=n.from,i=n.to;r[0]=i[0]=t,r[1]=i[1]=e,this.$setDirty()},setTo:function(t,e){this.$state.to[0]=t,this.$state.to[1]=e,this.$setDirty()}}},ts),Qs=Symbol("PickupFrom"),Zs=Symbol("PickupTo"),tc=x.Tool.READY,ec=function(t){Object(Ke["a"])(n,t);var e=Object(Xe["a"])(n);function n(){return Object(ut["a"])(this,n),e.apply(this,arguments)}return Object(lt["a"])(n,[{key:"setThickness",value:function(){}},{key:"setAlignment",value:function(){}}]),n}(b.Proxy.ToolProvider(["build","pick","drop"]));function nc(t){return this.createCorner.apply(this,Object(ft["a"])(t))}function rc(t,e,n){this.createWall(t,n[(e+1)%4])}var ic=x.Tool.define(Object(ht["a"])({},tc,{entry:function(){this.$data.indicator.$hide()},leave:function(){this.$data.indicator.$show()}}),{pick:[[tc,dt["d"],Qs],[Qs,dt["d"],Zs]],drop:[[Zs,dt["d"],Qs],[Qs,dt["d"],tc],[tc,dt["d"],tc]],build:[[Zs,function(){var t=this.$data,e=t.indicator,n=Object(re["a"])(t.from,2),r=n[0],i=n[1],o=Object(re["a"])(t.to,2),a=o[0],s=o[1],c=this.$plugin.$drawing.structure;e.setFrom.apply(e,Object(ft["a"])(e.$state.to)),[[r,i],[a,i],[a,s],[r,s]].map(nc,c).forEach(rc,c)},tc]]},{proxy:b.Proxy.Creator(ec),data:function(t){var e,n=this,r=t.$createElement("Chamber"),i=[0,0],o=[0,0],a=(e={},Object(ht["a"])(e,Qs,(function(t,e){i[0]=t,i[1]=e,r.setFrom(t,e)})),Object(ht["a"])(e,Zs,(function(t,e){o[0]=t,o[1]=e,r.setTo(t,e)})),e);return t.$drawing.on("pointermove",(function(e){if(n.$state!==tc){var r=e.pointerX,i=e.pointerY;a[n.$state].apply(a,Object(ft["a"])(t.$toGeometry(r,i)))}})),{indicator:r,from:i,to:o}}}),oc=O.define({id:"com.3dnest.spoke.bricklayer",namespace:"bricklayer",version:li["a"],plugin:ts,elements:{Builder:S.Indicator,Spliter:N.Indicator,Mover:F.Indicator,Extender:P.Indicator,Chamber:A.Indicator},tools:{Builder:S.Tool,Mover:F.Tool,Spliter:N.Tool,Extender:P.Tool,Chamber:A.Tool}}),ac=function(t){return t.$proxy},sc=function(t){Object(Ke["a"])(n,t);var e=Object(Xe["a"])(n);function n(){return Object(ut["a"])(this,n),e.apply(this,arguments)}return Object(lt["a"])(n,[{key:"createBitmap",value:function(t,e,n){return Hr(this).createBitmap(t,e,n)}},{key:"getAllBitmapList",value:function(){return Hr(this).$getElementList("Bitmap").map(ac)}}]),n}(b.Proxy.Plugin),cc=x.define({proxy:b.Proxy.Creator(sc),methods:{createBitmap:function(t,e,n){var r=this;return Object(Qr["a"])(regeneratorRuntime.mark((function i(){var o,a;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,cn.Texture.fromURL(t);case 2:return o=i.sent,a=r.$drawing.scale,i.abrupt("return",r.$createElement("Bitmap",o,e||o.width*a,n||o.height*a).$proxy);case 5:case"end":return i.stop()}}),i)})))()}}}),uc=function(t){Object(Ke["a"])(n,t);var e=Object(Xe["a"])(n);function n(){return Object(ut["a"])(this,n),e.apply(this,arguments)}return Object(lt["a"])(n,[{key:"url",get:function(){return Hr(this).url}},{key:"width",get:function(){return Hr(this).width}},{key:"height",get:function(){return Hr(this).height}},{key:"rotation",get:function(){return Hr(this).rotation}},{key:"x",get:function(){return Hr(this).x}},{key:"y",get:function(){return Hr(this).y}},{key:"alpha",get:function(){return Hr(this).alpha}},{key:"setWidth",value:function(t){Hr(this).setWidth(t)}},{key:"setHeight",value:function(t){Hr(this).setHeight(t)}},{key:"setRotation",value:function(t){Hr(this).setRotation(t)}},{key:"setPosition",value:function(t,e){Hr(this).setPosition(t,e)}},{key:"setAlpha",value:function(t){Hr(this).setAlpha(t)}},{key:"remove",value:function(){Hr(this).remove()}}]),n}(b.Proxy.Element),lc=cn,hc=x.Element.define({proxy:b.Proxy.Creator(uc),groupIndex:-100,interative:!0,focusable:!0,draggable:!0,state:function(){return{name:"Bitmap",texture:null,width:0,height:0,x:0,y:0,rotation:0,alpha:1}},getters:{url:function(){return this.$state.texture.baseTexture.cacheId},width:function(){return this.$state.width},height:function(){return this.$state.height},rotation:function(){return this.$state.rotation},x:function(){return this.$state.x},y:function(){return this.$state.y},alpha:function(){return this.$state.alpha}},created:function(t,e,n){this.setTexture(t),this.setWidth(e),this.setHeight(n)},destroy:function(){},render:function(t){var e=this.$state,n=e.texture,r=e.width,i=e.height,o=e.x,a=e.y,s=e.rotation,c=e.alpha,u=this.$drawing.scale,l=r/u,h=i/u,f=l>0?l:n.width,d=h>0?h:n.height;t.pivot.x=l/2,t.pivot.y=h/2,t.beginTextureFill({texture:n,alpha:c,matrix:new lc.Matrix(f/n.width,0,0,d/n.height,0,0)}).drawRect(0,0,f,d);var p=this.$toCanvas(o,a),v=Object(re["a"])(p,2);t.x=v[0],t.y=v[1],t.rotation=s},methods:{setTexture:function(t){this.$state.texture=t,this.$setDirty()},setWidth:function(t){this.$state.width=t,this.$setDirty()},setHeight:function(t){this.$state.height=t,this.$setDirty()},setRotation:function(t){this.$state.rotation=t,this.$setDirty()},setPosition:function(t,e){this.$state.x=t,this.$state.y=e,this.$setDirty()},setAlpha:function(t){this.$state.alpha=t,this.$setDirty()},remove:function(){this.$destroy()}}},cc),fc=n("3d1c"),dc=O.define({id:"com.3dnest.spoke.negative",namespace:"negative",version:fc["a"],plugin:cc,elements:{Bitmap:hc}}),pc=n("2c55"),vc=x.define({proxy:function(){var t=this;return{setPosition:function(e,n){t.setPosition(e,n)},setRotation:function(e){t.setRotation(e)}}},data:function(){return{compass:null}},created:function(){this.$data.compass=this.$createElement("Element")},methods:{setPosition:function(t,e){this.$data.compass.setPosition(t,e)},setRotation:function(t){this.$data.compass.setRotation(t)}}}),yc=x.Element.define({state:function(){return{x:50,y:50,rotation:0,compassColor:16777215,northPointColor:14423100,southPointColor:4098301}},created:function(){var t=new cn.Text,e=new cn.Text;t.text="N",t.style.fontSize=12,t.transform.position.x=-4,t.transform.position.y=-34,e.text="S",e.style.fontSize=12,e.transform.position.x=-4,e.transform.position.y=19,this.$graphics.addChild(t),this.$graphics.addChild(e),window.p=this},render:function(t){var e,n,r,i,o,a,s,c,u,l,h=this.$state,f=h.x,d=h.y,p=h.rotation,v=h.compassColor,y=h.northPointColor,g=h.southPointColor,b=[0,0],m=[0,-20],w=[-6,0],$=[6,0],x=[0,20],O=(e=(n=(r=(i=(o=(a=(s=(c=(u=(l=t.beginFill(v)).moveTo.apply(l,b).lineStyle(0).drawCircle(0,0,35).beginFill(y)).moveTo.apply(u,b)).lineTo.apply(c,w)).lineTo.apply(s,m)).lineTo.apply(a,$)).lineTo.apply(o,b).beginFill(g)).lineTo.apply(i,w)).lineTo.apply(r,x)).lineTo.apply(n,$)).lineTo.apply(e,b).endFill().lineStyle(1,9082010).moveTo(0,-35).lineTo(0,-32).moveTo(0,35).lineTo(0,32).moveTo(-35,0).lineTo(-28,0).moveTo(35,0).lineTo(28,0);O.x=f,O.y=d,O.rotation=p},methods:{resetPosition:function(){this.$state.x=50,this.$state.y=50,this.$setDirty()},setPosition:function(t,e){this.$state.x=t,this.$state.y=e,this.$setDirty()},setRotation:function(t){this.$state.rotation=t,this.$setDirty()},setCompassColor:function(t){this.$state.compassColor=t,this.$setDirty()},setNorthPointColor:function(t){this.$state.northPointColor=t,this.$setDirty()},setSouthPointColor:function(t){this.$state.southPointColor=t,this.$setDirty()}}}),gc=O.define({id:"com.3dnest.spoke.compass",namespace:"compass",version:pc["a"],plugin:vc,elements:{Element:yc}}),bc=n("2bbc"),mc=function(t){Object(Ke["a"])(n,t);var e=Object(Xe["a"])(n);function n(){return Object(ut["a"])(this,n),e.apply(this,arguments)}return Object(lt["a"])(n,[{key:"transformer",get:function(){return Hr(this).transformer}},{key:"selector",get:function(){return Hr(this).selector}},{key:"addTransformerAdapter",value:function(t,e){return Hr(this).addTransformerAdapter(t,e)}},{key:"addSelectorAdapter",value:function(t,e){return Hr(this).addSelectorAdapter(t,e)}},{key:"transformerAction",value:function(t){return Hr(this).transformerAction(t)}},{key:"selectorAction",value:function(t){return Hr(this).selectorAction(t)}}]),n}(b.Proxy.Plugin),wc=x.define({proxy:b.Proxy.Creator(mc),data:function(){return{transformer:null,selector:null,transformerAdapter:new Map,selectorAdapter:new Map}},created:function(){this.$data.transformer=this.$createTool("Transformer"),this.$data.selector=this.$createTool("Selector")},getters:{transformer:function(){return this.$data.transformer},selector:function(){return this.$data.selector}},methods:{addTransformerAdapter:function(t,e){this.$data.transformerAdapter.set(t,e)},addSelectorAdapter:function(t,e){this.$data.selectorAdapter.set(t,e)},transformerAction:function(t){var e=t?this.$data.transformerAdapter.get(t.constructor):null;e?this.$data.transformer.pick():this.$data.transformer.drop()},selectorAction:function(t){var e=t?this.$data.selectorAdapter.get(t.constructor):null;e?this.$data.selector.pick():this.$data.selector.drop()}}}),$c=function(t,e,n,r,i,o){return c.project.apply(c,[i,o].concat(Object(ft["a"])(s.fromSegment(t,e,n,r))))},xc=function(t,e,n,r,i,a){var s=$c(t,e,n,r,i,a);return o.length.apply(o,Object(ft["a"])(o.fromBothPoint.apply(o,[t,e].concat(Object(ft["a"])(s)))))},Oc=function(t,e,n,r,i){var a=o.normalize.apply(o,Object(ft["a"])(o.fromBothPoint(t,e,n,r))),s=Object(re["a"])(a,2),u=s[0],l=s[1],h=c.translate.apply(c,[t,e].concat(Object(ft["a"])(o.multiply(u,l,i)))),f=Object(re["a"])(h,2),d=f[0],p=f[1];return[d,p]},jc=x.Element.define({groupIndex:1300,interative:!0,state:function(){return{xStatus:0,yStatus:0,active:!1,x:0,y:0,width:0,height:0,rotation:0}},created:function(t,e){var n=this;this.$state.xStatus=t,this.$state.yStatus=e,this.$on("pointerdown",(function(t){t.stopPropagation(),n.beginAdjust()}))},render:function(t){if(this.$state.active){var e=this.$state,n=e.xStatus,r=e.yStatus,i=e.x,o=e.y,a=e.width,s=e.height,c=e.rotation,u=this.$drawing.scale;t.lineStyle(1,4096759).beginFill(16777215).drawRect(-5,-5,10,10),t.pivot.x=-n*a/2/u,t.pivot.y=r*s/2/u;var l=this.$toCanvas(i,o),h=Object(re["a"])(l,2);t.x=h[0],t.y=h[1],t.rotation=c}},methods:{show:function(){this.$state.active=!0,this.$setDirty()},hide:function(){this.$state.active=!1,this.$setDirty()},setPosition:function(t,e){this.$state.x=t,this.$state.y=e,this.$setDirty()},setWidth:function(t){this.$state.width=t,this.$setDirty()},setHeight:function(t){this.$state.height=t,this.$setDirty()},setRotation:function(t){this.$state.rotation=t,this.$setDirty()},updateState:function(t,e,n,r,i){this.setPosition(t,e),this.setWidth(n),this.setHeight(r),this.setRotation(i)},beginAdjust:function(){var t=this,e=this.$data.transformer.getElement(),n=this.$data.transformerAdapter.get(e.constructor),r=function(r){var i=t.$state,o=i.xStatus,a=i.yStatus,s=i.x,u=i.y,l=i.width,h=i.height,f=i.rotation,d=t.$toGeometry(r.pointerX,r.pointerY),p=s+o*l/2,v=u+a*h/2,y=c.rotate(p,v,-f,s,u),g=Object(re["a"])(y,2),b=g[0],m=g[1],w=xc(s,u,b,m,b,m),$=xc.apply(void 0,[s,u,b,m].concat(Object(ft["a"])(d))),x=c.rotate.apply(c,Object(ft["a"])(Oc(s,u,b,m,$)).concat([f,s,u])),O=Object(re["a"])(x,2),j=O[0],T=O[1],k=o*(j-p),E=a*(T-v),S=l+k,C=h+E,P=Oc(s,u,b,m,($-w)/2),L=Object(re["a"])(P,2),F=L[0],D=L[1];t.setWidth(S),t.setHeight(C),n.setWidth(e,S),n.setHeight(e,C),n.setPosition(e,F,D),t.$emit("update",{x:F,y:D,width:S,height:C,rotation:f})},i=function e(){t.$drawing.off("pointermove",r),window.removeEventListener("mouseup",e)};this.$drawing.on("pointermove",r),window.addEventListener("mouseup",i)}}},wc),Tc=30,kc=x.Element.define({groupIndex:1300,interative:!0,state:function(){return{active:!1,x:0,y:0,width:0,height:0,rotation:0}},created:function(){var t=this;this.$on("pointerdown",(function(e){e.stopPropagation(),t.beginAdjust()}))},render:function(t){if(this.$state.active){var e=this.$state,n=e.x,r=e.y,i=e.height,o=e.rotation,a=this.$drawing.scale;t.lineStyle(1,4096759).beginFill(16777215).drawCircle(0,0,5).moveTo(0,5).lineTo(0,Tc-5),t.pivot.x=0,t.pivot.y=i/a/2+Tc;var s=this.$toCanvas(n,r),c=Object(re["a"])(s,2);t.x=c[0],t.y=c[1],t.rotation=o}},methods:{show:function(){this.$state.active=!0,this.$setDirty()},hide:function(){this.$state.active=!1,this.$setDirty()},setPosition:function(t,e){this.$state.x=t,this.$state.y=e,this.$setDirty()},setWidth:function(t){this.$state.width=t,this.$setDirty()},setHeight:function(t){this.$state.height=t,this.$setDirty()},setRotation:function(t){this.$state.rotation=t,this.$setDirty()},updateState:function(t,e,n,r,i){this.setPosition(t,e),this.setWidth(n),this.setHeight(r),this.setRotation(i)},beginAdjust:function(){var t=this,e=this.$data.transformer.getElement(),n=this.$data.transformerAdapter.get(e.constructor),r=function(r){var i=t.$state,a=i.x,s=i.y,c=i.width,u=i.height,l=t.$toGeometry(r.pointerX,r.pointerY),h=Math.atan2.apply(Math,Object(ft["a"])(o.fromBothPoint.apply(o,[a,s].concat(Object(ft["a"])(l)))));t.setRotation(h),n.setRotation(e,h),t.$emit("update",{x:a,y:s,width:c,height:u,rotation:h})},i=function e(){t.$drawing.off("pointermove",r),window.removeEventListener("mouseup",e)};this.$drawing.on("pointermove",r),window.addEventListener("mouseup",i)}}},wc),Ec=x.Element.define({groupIndex:1200,interative:!0,state:function(){return{active:!1,x:0,y:0,width:0,height:0,rotation:0,isCreating:!1}},created:function(){var t=this;this.$on("pointerdown",(function(e){e.stopPropagation(),t.elementAdjust(e)}))},render:function(t){if(this.$state.active){var e=this.$state,n=e.x,r=e.y,i=e.width,o=e.height,a=e.rotation,s=this.$drawing.scale,c=i/s,u=o/s;t.lineStyle(1,16711680).beginFill(4096759,.01).drawRect(-c/2,-u/2,c,u).endFill(),t.pivot.x=0,t.pivot.y=0;var l=this.$toCanvas(n,r),h=Object(re["a"])(l,2);t.x=h[0],t.y=h[1],t.rotation=a}},methods:{show:function(){this.$state.active=!0,this.$setDirty()},hide:function(){this.$state.active=!1,this.$setDirty()},setPosition:function(t,e){this.$state.x=t,this.$state.y=e,this.$setDirty()},setWidth:function(t){this.$state.width=t,this.$setDirty()},setHeight:function(t){this.$state.height=t,this.$setDirty()},setRotation:function(t){this.$state.rotation=t,this.$setDirty()},setCreating:function(t){this.$state.isCreating=t,this.$setDirty()},updateState:function(t,e,n,r,i){this.setPosition(t,e),this.setWidth(n),this.setHeight(r),this.setRotation(i)},elementAdjust:function(t){var e=this,n=this.$drawing,r=this.$data.transformer.getElement(),i=this.$data.transformerAdapter.get(r.constructor),o=this.$state,a=o.width,s=o.height,c=o.rotation,u=o.isCreating,l=i.getPosition(r),h=Object(re["a"])(l,2),f=h[0],d=h[1],p=t?this.$toGeometry(t.pointerX,t.pointerY):[f,d],v=p[0]-f,y=p[1]-d,g=i.adjustVerify,b=function(t){var n=e.$toGeometry(t.pointerX,t.pointerY),o=n[0]-v,u=n[1]-y,l=e.$drawing.structure.getRoomByPoint(o,u);e.setPosition(o,u),g&&!g(r,e)||(i.setRoom&&i.setRoom(r,l),i.setPosition(r,o,u),e.$emit("update",{x:o,y:u,width:a,height:s,rotation:c}))},m=function(){n.off("pointermove",b),window.removeEventListener("mouseup",w),window.removeEventListener("keydown",$),u&&(e.setCreating(!1),e.hide())},w=function(){var t=e.$data.element;t&&e.setPosition.apply(e,Object(ft["a"])(i.getPosition(t))),m()},$=function(t){"Escape"===t.code&&u&&(r.remove(),m())};n.on("pointermove",b),window.addEventListener("mouseup",w),window.addEventListener("keydown",$)}}},wc),Sc=x.Element.define({groupIndex:1250,state:function(){return{active:!1,x:0,y:0,width:0,height:0,rotation:0}},render:function(t){if(this.$state.active){var e=this.$state,n=e.x,r=e.y,i=e.width,o=e.height,a=e.rotation,s=this.$drawing.scale,c=i/s,u=o/s;t.lineStyle(1,4096759).beginFill(16777215).drawCircle(0,0,5).endFill().beginFill(4096759,.2).drawRect(-c/2,-u/2,c,u).endFill(),t.pivot.x=0,t.pivot.y=0;var l=this.$toCanvas(n,r),h=Object(re["a"])(l,2);t.x=h[0],t.y=h[1],t.rotation=a}},methods:{show:function(){this.$state.active=!0,this.$setDirty()},hide:function(){this.$state.active=!1,this.$setDirty()},updateState:function(t,e,n,r,i){this.$state.x=t,this.$state.y=e,this.$state.width=n,this.$state.height=r,this.$state.rotation=i,this.$setDirty()}}},wc),Cc=x.Element.define({groupIndex:1300,state:function(){return{active:!1,x:0,y:0,width:0,height:0}},render:function(t){if(this.$state.active){var e=this.$state,n=e.x,r=e.y,i=e.width,o=e.height,a=this.$drawing.scale,s=i/a,c=o/a;t.lineStyle(1,4096759).beginFill(4096759,.2).drawRect(-s/2,-c/2,s,c).endFill(),t.pivot.x=0,t.pivot.y=0;var u=this.$toCanvas(n,r),l=Object(re["a"])(u,2);t.x=l[0],t.y=l[1]}},methods:{show:function(){this.$state.active=!0,this.$setDirty()},hide:function(){this.$state.active=!1,this.$setDirty()},updateState:function(t){var e=this.$drawing.scale,n=t.width*e,r=t.height*e,i=this.$toGeometry(t.x,t.y);this.$state.x=i[0]+n/2,this.$state.y=i[1]-r/2,this.$state.width=n,this.$state.height=r,this.$setDirty()},remove:function(){this.$destroy()}}},wc),Pc=x.Tool.READY,Lc=Symbol("Pick"),Fc=Symbol("Show"),Dc=function(t){Object(Ke["a"])(n,t);var e=Object(Xe["a"])(n);function n(){return Object(ut["a"])(this,n),e.apply(this,arguments)}return Object(lt["a"])(n,[{key:"getElement",value:function(){return Hr(this).getElement()}},{key:"moveElement",value:function(t){return Hr(this).moveElement(t)}}]),n}(b.Proxy.ToolProvider(["open","pick","drop","close"])),Nc=[[-1,1],[0,1],[1,1],[-1,0],[1,0],[-1,-1],[0,-1],[1,-1]],Wc=x.Tool.define(Object(ht["a"])({},Fc,(function(){this.updateState()})),{open:[[Pc,dt["d"],Lc]],pick:[[Lc,function(){var t=this;this.$data.element=this.$plugin.$drawing.focusing;var e,n=Object(ct["a"])(this.$data.handlers);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.show()}}catch(i){n.e(i)}finally{n.f()}this.$data.rotater.show(),this.$data.previewer.show(),this.$data.outline.show(),this.$data.element.on("update",this.$data.listener=function(){t.updateState()})},Fc],[Fc,function(){this.$data.element=this.$plugin.$drawing.focusing},Fc],[Pc,dt["d"],Pc]],drop:[[Fc,function(){var t,e=Object(ct["a"])(this.$data.handlers);try{for(e.s();!(t=e.n()).done;){var n=t.value;n.hide()}}catch(r){e.e(r)}finally{e.f()}this.$data.rotater.hide(),this.$data.previewer.hide(),this.$data.outline.hide(),this.$data.element.off("update",this.$data.listener),this.$data.element=null},Lc],[Lc,dt["d"],Lc],[Pc,dt["d"],Pc]],close:[[Fc,function(){var t,e=Object(ct["a"])(this.$data.handlers);try{for(e.s();!(t=e.n()).done;){var n=t.value;n.hide()}}catch(r){e.e(r)}finally{e.f()}this.$data.rotater.hide(),this.$data.previewer.hide(),this.$data.outline.hide(),this.$data.element.off("update",this.$data.listener),this.$data.element=null},Pc],[Lc,dt["d"],Pc],[Pc,dt["d"],Pc]]},{proxy:b.Proxy.Creator(Dc),data:function(t){var e=t.$createElement("Rotater"),n=t.$createElement("Previewer"),r=t.$createElement("Outline"),i=Nc.map((function(o){var a=t.$createElement.apply(t,["Handler"].concat(Object(ft["a"])(o)));return a.$on("update",(function(t){var o,a=t.x,s=t.y,c=t.width,u=t.height,l=t.rotation,h=Object(ct["a"])(i);try{for(h.s();!(o=h.n()).done;){var f=o.value;f.updateState(a,s,c,u,l)}}catch(d){h.e(d)}finally{h.f()}e.updateState(a,s,c,u,l),n.updateState(a,s,c,u,l),r.updateState(a,s,c,u,l)})),a}));return e.$on("update",(function(t){var e,o=t.x,a=t.y,s=t.width,c=t.height,u=t.rotation,l=Object(ct["a"])(i);try{for(l.s();!(e=l.n()).done;){var h=e.value;h.updateState(o,a,s,c,u)}}catch(f){l.e(f)}finally{l.f()}n.updateState(o,a,s,c,u),r.updateState(o,a,s,c,u)})),n.$on("update",(function(t){var n,o=t.x,a=t.y,s=t.width,c=t.height,u=t.rotation,l=Object(ct["a"])(i);try{for(l.s();!(n=l.n()).done;){var h=n.value;h.updateState(o,a,s,c,u)}}catch(f){l.e(f)}finally{l.f()}e.updateState(o,a,s,c,u),r.updateState(o,a,s,c,u)})),{element:null,handlers:i,rotater:e,previewer:n,outline:r,listener:dt["d"]}},methods:{updateState:function(){var t,e=this.$data.element,n=this.$plugin.$data.transformerAdapter.get(e.constructor),r=n.getPosition(e),i=Object(re["a"])(r,2),o=i[0],a=i[1],s=n.getWidth(e),c=n.getHeight(e),u=n.getRotation(e),l=Object(ct["a"])(this.$data.handlers);try{for(l.s();!(t=l.n()).done;){var h=t.value;h.updateState(o,a,s,c,u)}}catch(f){l.e(f)}finally{l.f()}this.$data.rotater.updateState(o,a,s,c,u),this.$data.previewer.updateState(o,a,s,c,u),this.$data.outline.updateState(o,a,s,c,u)},getElement:function(){return this.$data.element},moveElement:function(t){this.$data.element=t,this.updateState(),this.$data.previewer.setCreating(!0),this.$data.previewer.show(),this.$data.previewer.elementAdjust()}},reset:function(){this.close()}}),Ac=x.Tool.READY,Ic=Symbol("Pick"),Mc=Symbol("Show"),Rc=function(t){Object(Ke["a"])(n,t);var e=Object(Xe["a"])(n);function n(){return Object(ut["a"])(this,n),e.apply(this,arguments)}return Object(lt["a"])(n,[{key:"getElements",value:function(){return Hr(this).getElements()}}]),n}(b.Proxy.ToolProvider(["open","pick","drop","close"])),Hc=x.Tool.define(Object(ht["a"])({},Mc,(function(){this.addBounds()})),{open:[[Ac,dt["d"],Ic]],pick:[[Ic,dt["d"],Mc],[Mc,dt["d"],Mc],[Ac,dt["d"],Ac]],drop:[[Mc,function(){this.clearBounds()},Ic],[Ic,dt["d"],Ic],[Ac,dt["d"],Ac]],close:[[Mc,function(){this.clearBounds()},Ac],[Ic,dt["d"],Ac],[Ac,dt["d"],Ac]]},{proxy:b.Proxy.Creator(Rc),data:function(){return{boundsList:[],elements:[]}},methods:{addBounds:function(){var t=this.$plugin.$drawing.focusing,e=this.$data.elements.indexOf(t);if(e>-1){var n=this.$data.boundsList.splice(e,1),r=Object(re["a"])(n,1),i=r[0];return this.$data.elements.splice(e,1),void i.remove()}var o=this.$plugin.$createElement("Bounds");this.updateState(o),o.show(),this.$data.boundsList.push(o),this.$data.elements.push(t)},clearBounds:function(){var t,e=Object(ct["a"])(this.$data.boundsList);try{for(e.s();!(t=e.n()).done;){var n=t.value;n.remove()}}catch(r){e.e(r)}finally{e.f()}this.$data.boundsList=[],this.$data.elements=[]},updateState:function(t){var e=this.$plugin.$drawing.focusing,n=this.$plugin.$data.selectorAdapter.get(e.constructor),r=n.getBounds(e);t.updateState(r)},getElements:function(){return this.$data.elements}},reset:function(){this.close()}}),Bc=O.define({id:"com.3dnest.spoke.common",namespace:"common",version:bc["a"],plugin:wc,elements:{Handler:jc,Rotater:kc,Previewer:Ec,Outline:Sc,Bounds:Cc},tools:{Transformer:Wc,Selector:Hc}}),_c=n("0aa2"),Vc=b.Options.define,zc=Vc({enabled:!0},{rectangular:Vc({enabled:!0,referenceUnit:50},{style:Vc({color:255,lineWidth:1}),snap:Vc({enabled:!0})})}),Uc=function(t){Object(Ke["a"])(n,t);var e=Object(Xe["a"])(n);function n(){return Object(ut["a"])(this,n),e.apply(this,arguments)}return Object(lt["a"])(n)}(b.Proxy.Plugin),Yc=x.define({options:zc,proxy:b.Proxy.Creator(Uc),data:function(){return{layerList:[]}},created:function(){var t=this.$createElement("RectangularGrid");this.$data.layerList.push(t)}}),Gc=(n("6b93"),n("7db0"),[5,2,1]),Kc=function(t,e,n){return t.moveTo(0,e).lineTo(n,e)},Xc=function(t,e,n){return t.moveTo(e,0).lineTo(e,n)},qc=function(t){Object(Ke["a"])(n,t);var e=Object(Xe["a"])(n);function n(){return Object(ut["a"])(this,n),e.apply(this,arguments)}return Object(lt["a"])(n)}(b.Proxy.Element),Jc=x.Element.define({proxy:b.Proxy.Creator(qc),groupIndex:0,render:function(t){var e=this.$plugin.$options,n=e.rectangular.style,r=this.$drawing,i=r.width,o=r.height,a=r.scale,s=r.origin,c=Object(re["a"])(s,2),u=c[0],l=c[1],h=this.getUnitInMM(),f=function(t){return h*t/a};t.lineStyle(n.lineWidth,n.color,1,0);var d=0,p=0;for(d=1;(p=f(d))<u;d++)Xc(t,dt["c"].round(u-p),o);for(d=1;(p=f(d))<i-u;d++)Xc(t,dt["c"].round(u+p),o);for(d=1;(p=f(d))<l;d++)Kc(t,dt["c"].round(l-p),i);for(d=1;(p=f(d))<o-l;d++)Kc(t,dt["c"].round(l+p),i);t.lineStyle(1,16711680,1,0).moveTo(0,l).lineTo(i,l).moveTo(u,0).lineTo(u,o)},created:function(){var t=this,e=this.$plugin.$options;this.$drawing.registerSnap({name:"grid-point",priority:-1/0,get active(){return e.enabled&&e.rectangular.enabled&&e.rectangular.snap.enabled},handle:function(e,n,r){var i=t.getUnitInMM(),o=t.$toGeometry(e,n),a=o.map(Qc,i),s=t.$toCanvas.apply(t,Object(ft["a"])(a));r.apply(void 0,Object(ft["a"])(s))}})},methods:{getUnitInMM:function(){var t=this.$plugin.$options.rectangular.referenceUnit,e=t*this.$drawing.scale,n=dt["c"].pow(10,dt["c"].floor(dt["c"].log10(e)));return Gc.find(Zc,dt["c"].round(e/n))*n}}},Yc);function Qc(t){return dt["c"].round(t/this)*this}function Zc(t){return this>=t}var tu,eu=4,nu=x.Element.define({groupIndex:1e4,created:function(){var t=this;this.$drawing.on("snap",(function(){return t.$setDirty()}))},render:function(t){t.lineStyle(1,13421772).moveTo(-eu,-eu).lineTo(eu,eu).moveTo(eu,-eu).lineTo(-eu,eu);var e=Object(re["a"])(this.$drawing.virtual,2);t.x=e[0],t.y=e[1]}},Yc),ru=O.define({id:"com.3dnest.spoke.grid",namespace:"grid",version:_c["a"],plugin:Yc,elements:{RectangularGrid:Jc,Crosshair:nu}}),iu=n("c5c2"),ou=function(t){Object(Ke["a"])(n,t);var e=Object(Xe["a"])(n);function n(){return Object(ut["a"])(this,n),e.apply(this,arguments)}return Object(lt["a"])(n,[{key:"adjuster",get:function(){return Hr(this).adjuster}}]),n}(b.Proxy.Plugin),au=x.define({proxy:b.Proxy.Creator(ou),data:function(){return{adjuster:null}},created:function(){this.$data.adjuster=this.$createTool("Adjuster")},getters:{adjuster:function(){return this.$data.adjuster}}}),su=50,cu=function(t,e){var n=t.corner,r=t.back.corner,i=o.normalize.apply(o,Object(ft["a"])(o.fromBothPoint(n.x,n.y,r.x,r.y))),a=Object(re["a"])(i,2),s=a[0],u=a[1],l=c.translate.apply(c,[n.x,n.y].concat(Object(ft["a"])(o.multiply(s,u,e)))),h=Object(re["a"])(l,2),f=h[0],d=h[1];return[f,d]},uu=function(t,e,n){var r=t.corner,i=t.back.corner;return c.project.apply(c,[e,n].concat(Object(ft["a"])(s.fromSegment(r.x,r.y,i.x,i.y))))},lu=function(t,e,n){var r=t.corner,i=uu(t,e,n);return o.length.apply(o,Object(ft["a"])(o.fromBothPoint.apply(o,[r.x,r.y].concat(Object(ft["a"])(i)))))},hu=function(t,e,n,r,i){var a=null,s=null,u=0;if(t.forEach((function(t){var r=uu(t.thisSurface,e,n),i=Object(re["a"])(r,2),a=i[0],c=i[1],l=Math.min(t.thisSurface.corner.x,t.thatSurface.corner.x),h=Math.max(t.thisSurface.corner.x,t.thatSurface.corner.x),f=Math.min(t.thisSurface.corner.y,t.thatSurface.corner.y),d=Math.max(t.thisSurface.corner.y,t.thatSurface.corner.y);if(!(a<l||a>h||c<f||c>d)){var p=o.length.apply(o,Object(ft["a"])(o.fromBothPoint(e,n,a,c)));(!s||p<u)&&(s=t,u=p)}})),!s||u/r>su)i.corner.x=e,i.corner.y=n,i.back.corner.x=e+10,i.back.corner.y=n,a=i;else{var l=s.thisSurface,h=s.thatSurface;a=c.toLeftOfSegment(e,n,h.corner.x,h.corner.y,l.corner.x,l.corner.y)?h:l}return a},fu=x.Element.define({groupIndex:1200,interative:!0,hoverable:!0,state:function(){return{active:!1,surface:null,offset:0,width:0}},created:function(){var t=this;this.$on("pointerdown",(function(e){e.stopPropagation(),t.beginAdjust()}))},destroy:function(){},render:function(t){if(this.$state.active){var e=this.$state,n=e.surface,r=e.offset,i=e.width,o=this.$toCanvas.apply(this,Object(ft["a"])(cu(n,r-i/2))),a=Object(re["a"])(o,2),s=a[0],c=a[1];t.lineStyle(this.$hovering||this.$holding?2:1,this.$hovering||this.$holding?16777215:4096759).beginFill(4096759,.5).drawCircle(s,c,5)}},methods:{show:function(){this.$state.active=!0,this.$setDirty()},hide:function(){this.$state.active=!1,this.$setDirty()},setSurface:function(t){this.$state.surface=t,this.$setDirty()},setOffset:function(t){this.$state.offset=t,this.$setDirty()},setWidth:function(t){this.$state.width=t,this.$setDirty()},updateState:function(t,e,n){this.setSurface(t),this.setOffset(e),this.setWidth(n)},beginAdjust:function(){var t=this,e=this.$data.adjuster.getElement(),n=this.$state,r=n.surface,i=n.offset,o=n.width,a=function(n){var a=t.$toGeometry(n.pointerX,n.pointerY),s=lu.apply(void 0,[r].concat(Object(ft["a"])(a))),c=i-o/2-s,u=i-c/2,l=o+c;t.setOffset(u),t.setWidth(l),e.setOffset(u),e.setWidth(l),t.$emit("update",{surface:r,offset:u,width:l})},s=function e(){t.$drawing.off("pointermove",a),window.removeEventListener("mouseup",e)};this.$drawing.on("pointermove",a),window.addEventListener("mouseup",s)}}},au),du=x.Element.define({groupIndex:1200,interative:!0,hoverable:!0,state:function(){return{active:!1,surface:null,offset:0,width:0}},created:function(){var t=this;this.$on("pointerdown",(function(e){e.stopPropagation(),t.beginAdjust()}))},destroy:function(){},render:function(t){if(this.$state.active){var e=this.$state,n=e.surface,r=e.offset,i=e.width,o=this.$toCanvas.apply(this,Object(ft["a"])(cu(n,r+i/2))),a=Object(re["a"])(o,2),s=a[0],c=a[1];t.lineStyle(this.$hovering||this.$holding?2:1,this.$hovering||this.$holding?16777215:4096759).beginFill(4096759,.5).drawRect(s-5,c-5,10,10)}},methods:{show:function(){this.$state.active=!0,this.$setDirty()},hide:function(){this.$state.active=!1,this.$setDirty()},setSurface:function(t){this.$state.surface=t,this.$setDirty()},setOffset:function(t){this.$state.offset=t,this.$setDirty()},setWidth:function(t){this.$state.width=t,this.$setDirty()},updateState:function(t,e,n){this.setSurface(t),this.setOffset(e),this.setWidth(n)},beginAdjust:function(){var t=this,e=this.$data.adjuster.getElement(),n=this.$state,r=n.surface,i=n.offset,o=n.width,a=function(n){var a=t.$toGeometry(n.pointerX,n.pointerY),s=lu.apply(void 0,[r].concat(Object(ft["a"])(a))),c=s-i-o/2,u=i+c/2,l=o+c;t.setOffset(u),t.setWidth(l),e.setOffset(u),e.setWidth(l),t.$emit("update",{surface:r,offset:u,width:l})},s=function e(){t.$drawing.off("pointermove",a),window.removeEventListener("mouseup",e)};this.$drawing.on("pointermove",a),window.addEventListener("mouseup",s)}}},au),pu=x.Element.define({groupIndex:1200,interative:!0,state:function(){return{surface:null,offset:0,width:0,listener:null,isCreating:!1}},methods:{show:function(){var t=this,e=this.$data.adjuster.getElement();e.on("pointerdown",this.$state.listener=function(n){t.$state.isCreating||t.hollowAdjust(e,n)}),this.$setDirty()},hide:function(){var t=this.$data.adjuster.getElement();t&&t.off("pointerdown",this.$state.listener),this.$setDirty()},setSurface:function(t){this.$state.surface=t,this.$setDirty()},setOffset:function(t){this.$state.offset=t,this.$setDirty()},setWidth:function(t){this.$state.width=t,this.$setDirty()},setCreating:function(t){this.$state.isCreating=t,this.$setDirty()},updateState:function(t,e,n){this.setSurface(t),this.setOffset(e),this.setWidth(n)},adjustAction:function(t,e,n,r){this.setSurface(e),this.setOffset(n),t.setSurface(e),t.setOffset(n),this.$emit("update",{surface:e,offset:n,width:r})},hollowAdjust:function(t,e){var n=this,r=this.$state,i=r.surface,o=r.offset,a=r.width,s=r.isCreating,c=this.$drawing,u=e?lu.apply(void 0,[i].concat(Object(ft["a"])(this.$toGeometry(e.pointerX,e.pointerY))))-o:0,l=i,h=o,f=c.structure.getAllWallList(),d=function(e){var r=n.$toGeometry(e.pointerX,e.pointerY),i=hu.apply(void 0,[f].concat(Object(ft["a"])(r),[n.$drawing.scale,t.virtualSurface]));if("virtual"!==i.name){var o=lu.apply(void 0,[i].concat(Object(ft["a"])(r)))-u,s=lu.apply(void 0,[i].concat(Object(ft["a"])(i.originSafe))),c=lu.apply(void 0,[i].concat(Object(ft["a"])(i.targetSafe))),l=lu.apply(void 0,[i].concat(Object(ft["a"])(i.back.originSafe))),h=lu.apply(void 0,[i].concat(Object(ft["a"])(i.back.targetSafe))),d=Math.max(s,h)+a/2,p=Math.min(c,l)-a/2,v=o<d?d:o>p?p:o;n.adjustAction(t,i,v,a)}else n.adjustAction(t,i,0,a)},p=function(){c.off("pointermove",d),window.removeEventListener("mouseup",v),window.removeEventListener("keydown",y),s&&n.setCreating(!1)},v=function(){"virtual"===t.surface.name&&(s?t.remove():n.adjustAction(t,l,h,a)),p()},y=function(e){"Escape"===e.code&&s&&(t.remove(),p())};c.on("pointermove",d),window.addEventListener("mouseup",v),window.addEventListener("keydown",y)}}},au),vu=x.Tool.READY,yu=Symbol("Pick"),gu=Symbol("Show"),bu=function(t){Object(Ke["a"])(n,t);var e=Object(Xe["a"])(n);function n(){return Object(ut["a"])(this,n),e.apply(this,arguments)}return Object(lt["a"])(n,[{key:"getElement",value:function(){return Hr(this).getElement()}},{key:"moveElement",value:function(t){return Hr(this).moveElement(t)}}]),n}(b.Proxy.ToolProvider(["open","pick","drop","close"])),mu=x.Tool.define(Object(ht["a"])({},gu,(function(){this.updateState()})),{open:[[vu,dt["d"],yu]],pick:[[yu,function(){var t=this;this.$data.element=this.$plugin.$drawing.focusing,this.$data.element.on("update",this.$data.listener=function(){t.updateState()}),this.$data.headHandler.show(),this.$data.rearHandler.show(),this.$data.mover.show()},gu],[gu,function(){var t=this;this.$data.element!==this.$plugin.$drawing.focusing&&(this.$data.element.off("update",this.$data.listener),this.$data.mover.hide(),this.$data.element=this.$plugin.$drawing.focusing,this.$data.element.on("update",this.$data.listener=function(){t.updateState()}),this.$data.mover.show())},gu],[vu,dt["d"],vu]],drop:[[gu,function(){this.$data.headHandler.hide(),this.$data.rearHandler.hide(),this.$data.mover.hide(),this.$data.element.off("update",this.$data.listener),this.$data.element=null},yu],[yu,dt["d"],yu],[vu,dt["d"],vu]],close:[[gu,function(){this.$data.headHandler.hide(),this.$data.rearHandler.hide(),this.$data.mover.hide()},vu],[yu,dt["d"],vu],[vu,dt["d"],vu]]},{proxy:b.Proxy.Creator(bu),data:function(t){var e=t.$createElement("HeadHandler"),n=t.$createElement("RearHandler"),r=t.$createElement("Mover");return e.$on("update",(function(t){var e=t.surface,i=t.offset,o=t.width;n.updateState(e,i,o),r.updateState(e,i,o)})),n.$on("update",(function(t){var n=t.surface,i=t.offset,o=t.width;e.updateState(n,i,o),r.updateState(n,i,o)})),r.$on("update",(function(t){var r=t.surface,i=t.offset,o=t.width;n.updateState(r,i,o),e.updateState(r,i,o)})),{element:null,headHandler:e,rearHandler:n,mover:r,listener:dt["d"]}},methods:{updateState:function(){var t=this.$data.element,e=t.surface,n=t.offset,r=t.width;this.$data.headHandler.updateState(e,n,r),this.$data.rearHandler.updateState(e,n,r),this.$data.mover.updateState(e,n,r)},getElement:function(){return this.$data.element},moveElement:function(t){this.$data.element=t,this.drop(),this.$data.mover.setCreating(!0),this.$data.mover.hollowAdjust(t)}},reset:function(){this.close()}}),wu=O.define({id:"com.3dnest.spoke.hammer",namespace:"hammer",version:iu["a"],plugin:au,elements:{HeadHandler:fu,RearHandler:du,Mover:pu},tools:{Adjuster:mu}}),$u=n("7612"),xu=function(t){Object(Ke["a"])(n,t);var e=Object(Xe["a"])(n);function n(){return Object(ut["a"])(this,n),e.apply(this,arguments)}return Object(lt["a"])(n,[{key:"from",get:function(){return dt["b"].throwError("The `.from` getter MUST be implemented.")}},{key:"to",get:function(){return dt["b"].throwError("The `.to` getter MUST be implemented.")}}]),n}(sn["a"].Emitter),Ou=function(t){return dt["b"].instanceOf(t,xu)},ju=Ou,Tu=function(t){Object(Ke["a"])(n,t);var e=Object(Xe["a"])(n);function n(){return Object(ut["a"])(this,n),e.apply(this,arguments)}return Object(lt["a"])(n,[{key:"createDimension",value:function(t){return ju(t)||dt["b"].Throw.TypeError("Invalid adaptor, a adaptor expected."),Hr(this).createDimension(t).$proxy}},{key:"removeAll",value:function(){Hr(this).removeAll()}}]),n}(b.Proxy.Plugin),ku=function(t){return 360/t},Eu=function(t){return-t},Su=x.define({proxy:b.Proxy.Creator(Tu),data:function(){return{fontsizer:ku,textOffsetYModifier:Eu}},methods:{createDimension:function(t){return this.$createElement("Dimension",t)},setFontsizer:function(t){this.$data.fontsizer=t,this.$forceUpdate()},setTextOffsetYModifier:function(t){this.$data.textOffsetYModifier=t,this.$forceUpdate()},removeAll:function(){this.$getElementList("Dimension").forEach((function(t){return t.$proxy.remove()}))}}}),Cu=function(t){Object(Ke["a"])(n,t);var e=Object(Xe["a"])(n);function n(){return Object(ut["a"])(this,n),e.apply(this,arguments)}return Object(lt["a"])(n,[{key:"offset",get:function(){return Hr(this).$state.offset},set:function(t){dt["g"].Not.Number(t)&&dt["b"].Throw.TypeError("Invalid value, a number expected."),Hr(this).setOffset(t)}},{key:"hide",value:function(){Hr(this).$hide()}},{key:"show",value:function(){Hr(this).$show()}},{key:"remove",value:function(){Hr(this).$destroy()}}]),n}(b.Proxy.Element),Pu=200,Lu=300,Fu=0,Du=100,Nu=30,Wu=dt["c"].PI,Au=Wu/2,Iu=function(t){return t>Au&&t<=Wu||t>-Wu&&t<=-Au},Mu=x.Element.define({proxy:b.Proxy.Creator(Cu),groupIndex:2e3,interative:!0,focusable:!0,state:function(){return{element:null,offset:Pu,valueText:null}},render:function(t){var e=this.$state,n=e.element,r=e.offset,a=e.valueText,s=this.$drawing.scale,u=this.$data,h=u.fontsizer,f=u.textOffsetYModifier,d=Lu/s,p=Fu/s,v=Du/s,y=Nu/s,g=h(s),b=n.from,m=n.to,w=o.length.apply(o,Object(ft["a"])(o.from.apply(o,Object(ft["a"])(b).concat(Object(ft["a"])(m)))));a.style.fontSize=g,a.text=dt["c"].round(w),a.y=f(g),a.pivot.set(a.width/2,a.height/2);var $=i.Segment.apply(i,Object(ft["a"])(this.$toCanvas.apply(this,Object(ft["a"])(b))).concat(Object(ft["a"])(this.$toCanvas.apply(this,Object(ft["a"])(m))))),x=o.fromSegment.apply(o,Object(ft["a"])($)),O=Object(re["a"])(x,2),j=O[0],T=O[1],k=o.length(j,T)/2;t.lineStyle(1,0),r<0?t.moveTo(-k,v).lineTo(-k,-d).moveTo(k,v).lineTo(k,-d):t.moveTo(-k,d).lineTo(-k,-v).moveTo(k,d).lineTo(k,-v),t.moveTo(-k-p,0).lineTo(k+p,0).lineStyle(3).moveTo(-k-y,y).lineTo(-k+y,-y).moveTo(k-y,y).lineTo(k+y,-y);var E=l.middle.apply(l,Object(ft["a"])($)),S=o.invert.apply(o,Object(ft["a"])(o.rotate90.apply(o,Object(ft["a"])(o.normalize(j,T))))),C=o.multiply.apply(o,Object(ft["a"])(S).concat([r/s])),P=c.translate.apply(c,Object(ft["a"])(E).concat(Object(ft["a"])(C))),L=Object(re["a"])(P,2);t.x=L[0],t.y=L[1],Iu(t.rotation=dt["c"].atan2(T,j))&&(a.rotation=dt["c"].PI)},created:function(t){var e=this,n=this.$state.valueText=new cn.Text;dt["e"].assign(n.style,{stroke:16777215,strokeThickness:2}),t.on("change",(function(){return e.$setDirty()})),t.on("destroy",(function(){return e.$destroy()})),this.$state.element=t,this.$graphics.addChild(n)},methods:{setOffset:function(t){this.$state.offset=t,this.$setDirty()}}},Su),Ru=O.define({id:"com.3dnest.spoke.measure",namespace:"measure",version:$u["a"],plugin:Su,elements:{Dimension:Mu}}),Hu=n("c394"),Bu=function(t){Object(Ke["a"])(n,t);var e=Object(Xe["a"])(n);function n(){return Object(ut["a"])(this,n),e.apply(this,arguments)}return Object(lt["a"])(n,[{key:"LineLabeler",get:function(){return Hr(this).$data.lineLabeler}},{key:"TextLabeler",get:function(){return Hr(this).$data.textLabeler}},{key:"open",value:function(){return Hr(this).open()}},{key:"openTextLabeler",value:function(){return Hr(this).openTextLabeler()}},{key:"openLineLabeler",value:function(){return Hr(this).openLineLabeler()}},{key:"close",value:function(){return Hr(this).close()}}]),n}(b.Proxy.Plugin),_u=x.define({proxy:b.Proxy.Creator(Bu),data:function(){return{lineLabeler:null,textLabeler:null}},created:function(){var t=this;this.$data.lineLabeler=this.$createTool("LineLabeler"),this.$data.textLabeler=this.$createTool("TextLabeler"),this.$on("element-created",(function(e,n){t.$emit("".concat(n.toLowerCase(),"-created"),e)}))},methods:{open:function(){this.openTextLabeler()},openTextLabeler:function(){this.$data.lineLabeler.close(),this.$data.textLabeler.open()},openLineLabeler:function(){this.$data.textLabeler.close(),this.$data.lineLabeler.open()},close:function(){this.$data.textLabeler.close(),this.$data.lineLabeler.close()}}}),Vu=x.Element.define({groupIndex:1400,state:function(){return{origin:null,target:null}},created:function(){},methods:{}},_u),zu=x.Element.define({groupIndex:1500,interative:!0,focusable:!0,state:function(){return{pixiText:null,text:"",x:0,y:0}},render:function(t){var e=this.$state,n=e.pixiText,r=e.text,i=e.x,o=e.y,a=this.$drawing.scale;n.text=r||"No Text",n.style.fontSize=300/a,t.pivot.x=t.width/2,t.pivot.y=t.height/2;var s=this.$toCanvas(i,o),c=Object(re["a"])(s,2);t.x=c[0],t.y=c[1]},created:function(){var t=this.$state.pixiText=new cn.Text;this.$graphics.addChild(t)},methods:{setPosition:function(t,e){this.$state.x=t,this.$state.y=e,this.$setDirty()},setText:function(t){this.$state.text=t,this.$setDirty()}}},_u),Uu=x.Tool.READY,Yu=Symbol("Pick"),Gu={PICK:Yu},Ku=function(t){Object(Ke["a"])(n,t);var e=Object(Xe["a"])(n);function n(){return Object(ut["a"])(this,n),e.apply(this,arguments)}return Object(lt["a"])(n)}(b.Proxy.ToolProvider(["open","close"])),Xu=x.Tool.define({},{open:[[Uu,dt["d"],Yu]],close:[[Yu,dt["d"],Uu],[Uu,dt["d"],Uu]]},{proxy:b.Proxy.Creator(Ku),data:function(){return{}},methods:{},reset:function(){this.close()}}),qu=x.Tool.READY,Ju=Symbol("Pick"),Qu={PICK:Ju},Zu=function(t){Object(Ke["a"])(n,t);var e=Object(Xe["a"])(n);function n(){return Object(ut["a"])(this,n),e.apply(this,arguments)}return Object(lt["a"])(n)}(b.Proxy.ToolProvider(["open","pick","close"])),tl=x.Tool.define({},{open:[[qu,dt["d"],Ju]],pick:[[Ju,function(){var t,e=this.$plugin.$drawing,n=this.$plugin.$createElement("Text");n.setPosition.apply(n,Object(ft["a"])((t=this.$plugin).$toGeometry.apply(t,Object(ft["a"])(e.pointer))))},qu]],close:[[Ju,dt["d"],qu],[qu,dt["d"],qu]]},{proxy:b.Proxy.Creator(Zu),data:function(){return{}},methods:{},reset:function(){this.close()}}),el=O.define({id:"com.3dnest.spoke.label",namespace:"label",version:Hu["a"],plugin:_u,elements:{Line:Vu,Text:zu},tools:{LineLabeler:Xu,TextLabeler:tl}}),nl=Math.PI,rl=60,il=15,ol=10,al={stateless:{line:0,arcLine:14145753,fill:16777215,windowFill:13421772},hover:{line:8053503,arcLine:15464441,fill:16777215,windowFill:13421772},select:{line:4096759,arcLine:15068665,fill:16777215,windowFill:13421772}},sl=function(t){var e=t.hover,n=t.focus,r=t.select;return r||n?al.select:e?al.hover:al.stateless},cl={width:800,render:function(t,e){var n=e.width,r=e.height,i=e.fliped,o=e.scale,a=i?1:0,s=il/o,c=rl/o,u=sl(e);return t.lineStyle(s,u.arcLine).beginFill(u.fill,.1).arc(n*a,r/2,n,-nl/2*a-nl/2,-nl*a/2).lineTo(n*a,r/2).lineTo(0,r/2-n+a*n).endFill().beginFill(u.fill).lineStyle(s,u.fill).drawRect(0,0,n,r).lineStyle(s,u.line).moveTo(0,0).lineTo(0,r).moveTo(n,0).lineTo(n,r).lineStyle(s,u.line).drawRect((n-c)*a,r/2,c,-n),t.pivot.x=n/2,t.pivot.y=r/2,t}},ul={width:1500,render:function(t,e){var n=e.width,r=e.height,i=e.scale,o=il/i,a=rl/i,s=sl(e);return t.lineStyle(o,s.arcLine).beginFill(s.fill,.1).arc(0,r/2,n/2,-nl/2,0).lineTo(0,r/2).lineTo(0,(r-n)/2).endFill().beginFill(s.fill,.1).lineStyle(o,s.arcLine).arc(n,r/2,n/2,nl,-nl/2).lineTo(n,r/2).lineTo(n/2,r/2).endFill().beginFill(s.fill).lineStyle(o,s.fill).drawRect(0,0,n,r).lineStyle(o,s.line).moveTo(0,0).lineTo(0,r).moveTo(n,0).lineTo(n,r).drawRect(0,r/2,a,-n/2).drawRect(n,r/2,-a,-n/2),t.pivot.x=n/2,t.pivot.y=r/2,t}},ll={width:1500,render:function(t,e){var n=e.width,r=e.height,i=e.scale,o=e.fliped,a=o?-1:1,s=il/i,c=ol/i,u=sl(e);return t.lineStyle(s,u.line).beginFill(u.fill).drawRect(0,0,n,r).drawRect(0+s+c,r/2,2*n/3,r/4*a).drawRect(n-s-c,r/2,-2*n/3,-r/4*a),t.pivot.x=n/2,t.pivot.y=r/2,t}},hl={width:1450,render:function(t,e){var n=e.width,r=e.height,i=e.fliped,o=e.scale,a=i?1:0,s=il/o,c=sl(e);return t.lineStyle(s,c.line).beginFill(c.fill).drawRect(0,0,n,r).moveTo(0,r/3).lineTo(n,r/3).moveTo(0,2*r/3).lineTo(n,2*r/3).moveTo(n/4+a*n/2,r/3).lineTo(n/4+a*n/2,2*r/3).endFill(),t.pivot.x=n/2,t.pivot.y=r/2,t}},fl={width:2e3,render:function(t,e){var n=e.width,r=e.height,i=e.scale,o=il/i,a=sl(e);return t.lineStyle(o,a.fill).beginFill(a.fill).drawRect(0,0,n,r).endFill().lineStyle(o,a.line).drawRect(0,0,n,r/3).drawRect(0,2*r/3,n,r/3),t.pivot.x=n/2,t.pivot.y=r/2,t}},dl={width:800,render:function(t,e){var n=e.width,r=e.height,i=e.scale,o=il/i,a=sl(e);return t.lineStyle(o,a.line).beginFill(a.fill).drawRect(0,0,n,r).moveTo(0,r/2).lineTo(n,r/2).endFill(),t.pivot.x=n/2,t.pivot.y=r/2,t}},pl={width:1500,render:function(t,e){var n=e.width,r=e.scale,i=e.sillThickness,o=void 0===i?500/r:i,a=e.height,s=il/r,c=a,u=sl(e);return t.lineStyle(s,u.line).beginFill(u.windowFill).drawRect(0,-o,n,o).endFill().beginFill(u.fill).moveTo(0,-a).lineTo(0,-o).lineTo(n,-o).lineTo(n,-a).lineTo(n+c,-a).lineTo(n+c,-(o+c)).lineTo(-c,-(o+c)).lineTo(-c,-a).lineTo(0,-a).endFill().moveTo(-c/2,-a).lineTo(-c/2,-(o+c/2)).lineTo(n+c/2,-(o+c/2)).lineTo(n+c/2,-a),t.pivot.x=n/2,t.pivot.y=-a/2,t}},vl={width:1500,render:function(t,e){var n=e.width,r=e.height,i=e.scale,o=il/i,a=sl(e);return t.lineStyle(o,a.line).beginFill(a.fill).drawRect(0,0,n,r).endFill().moveTo(0,r/2).lineTo(n,r/2).moveTo(0,r/3).lineTo(n,r/3).moveTo(0,2*r/3).lineTo(n,2*r/3).moveTo(n/2,r/3).lineTo(n/2,2*r/3),t.pivot.x=n/2,t.pivot.y=r/2,t}},yl={render:function(t,e){var n=e.leftWidth,r=e.rightWidth,i=e.leftWallThickness,o=e.rightWallThickness,a=e.scale,s=il/a,c=sl(e);return t.lineStyle(s,c.line).beginFill(c.fill).moveTo(0,0).lineTo(r,0).lineTo(r,o).lineTo(i,o).lineTo(i,n).lineTo(0,n).lineTo(0,0).endFill().moveTo(i/2,n).lineTo(i/2,o/2).lineTo(r,o/2),t.pivot.x=r/2,t.pivot.y=o/2,t}},gl={render:function(t,e){var n=e.leftWidth,r=e.centerWidtn,i=e.rightWidth,o=e.leftWallThickness,a=e.centerWallThickness,s=e.rightWallThickness,c=e.scale,u=il/c,l=sl(e);return t.lineStyle(u,l.line).beginFill(l.fill).moveTo(0,0).lineTo(r,0).lineTo(r,i).lineTo(r-s,i).lineTo(r-s,a).lineTo(o,a).lineTo(o,n).lineTo(0,n).lineTo(0,0).endFill().moveTo(o/2,n).lineTo(o/2,a/2).lineTo(r-s/2,a/2).lineTo(r-s/2,i),t.pivot.x=r/2,t.pivot.y=a/2,t}},bl={render:function(t,e){var n=e.leftWidth,r=e.rightWidth,i=e.leftWindowThickness,o=e.rightWindowThickness,a=e.leftWallThickness,s=e.rightWallThickness,c=e.scale,u=il/c,l=sl(e);return t.lineStyle(u,l.line).beginFill(l.windowFill).moveTo(a,s).lineTo(r,s).lineTo(r,s-o).lineTo(a-i,s-o).lineTo(a-i,n).lineTo(a,n).lineTo(a,s).endFill().beginFill(l.fill).moveTo(a-i,s-o).lineTo(r,s-o).lineTo(r,0).lineTo(r+s,0).lineTo(r+s,-o).lineTo(-i,-o).lineTo(-i,n+a).lineTo(0,n+a).lineTo(0,n).lineTo(a-i,n).lineTo(a-i,s-o).endFill().moveTo(0,n+a/2).lineTo(a/2-i,n+a/2).lineTo(a/2-i,s/2-o).lineTo(r+s/2,s/2-o).lineTo(r+s/2,0),t.pivot.x=r/2,t.pivot.y=s/2,t}},ml={render:function(t,e){var n=e.leftWidth,r=e.centerWidtn,i=e.rightWidth,o=e.leftWindowThinkness,a=e.centerWindowThinkness,s=e.rightWindowThinkness,c=e.leftWallThickness,u=e.centerWallThickness,l=e.rightWallThickness,h=e.scale,f=il/h,d=sl(e);return t.lineStyle(f,d.line).beginFill(d.windowFill).moveTo(c,u).lineTo(r-l,u).lineTo(r-l,i).lineTo(r-l+s,i).lineTo(r-l+s,u-a).lineTo(c-o,u-a).lineTo(c-o,n).lineTo(c,n).lineTo(c,u).endFill().beginFill(d.fill).moveTo(c-o,u-a).lineTo(r+s-l,u-a).lineTo(r+s-l,i).lineTo(r,i).lineTo(r,i+l).lineTo(r+s,i+l).lineTo(r+s,-a).lineTo(-o,-a).lineTo(-o,n+c).lineTo(0,n+c).lineTo(0,n).lineTo(c-o,n).lineTo(c-o,u-a).endFill().moveTo(0,n+c/2).lineTo(c/2-o,n+c/2).lineTo(c/2-o,u/2-a).lineTo(r+s-l/2,u/2-a).lineTo(r+s-l/2,i+l/2).lineTo(r,i+l/2),t.pivot.x=r/2,t.pivot.y=u/2,t}},wl=[{value:"singleDoor",content:z.SingleDoor},{value:"doubleDoor",content:z.DoubleDoor},{value:"slidingDoor",content:z.SlidingDoor},{value:"parentDoor",content:z.ParentDoor},{value:"bealock",content:z.Bealock},{value:"basicWindow",content:U.BasicWindow},{value:"boilerWindow",content:U.BoilerWindow},{value:"floorWindow",content:U.FloorWindow}],$l=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:wl,n=Object(ct["a"])(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;T.register(r.value,r.content)}}catch(i){n.e(i)}finally{n.f()}return e.map((function(t){return t.value}))},xl=function(t){t.canvasElement.addEventListener("contextmenu",an["b"].preventDefault)},Ol=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;t.on("pointerdown",(function(n){if(n.button===e){var r=Object(re["a"])(t.origin,2),i=r[0],o=r[1],a=n.pointerX,s=n.pointerY,c=function(e){var n=e.pointerX,r=e.pointerY;t.setOrigin(i+n-a,o+r-s)},u=function e(){t.off("pointermove",c),an["a"].removeEventListener(an["c"].WINDOW,"mouseup",e)};t.on("pointermove",c),an["a"].addEventListener(an["c"].WINDOW,"mouseup",u)}}))},jl=function(t){an["a"].addEventListener(t.canvasElement,"wheel",(function(e){e.deltaY>0?t.setScaleInMode(t.scale+1,1):t.setScaleInMode(t.scale-1,1)}))},Tl=function(t,e){t.structure.on("room-created",(function(t){t.setFloor(e)}))},kl=Symbol(),El=Symbol(),Sl=Symbol(),Cl=Symbol(),Pl=Symbol(),Ll=Symbol(),Fl=Symbol(),Dl=(tu={},Object(ht["a"])(tu,kl,{open:function(t){t.hammer.adjuster.open(),t.common.transformer.open(),t.bricklayer.Mover.open(),t.bricklayer.Extender.open()},close:function(t){t.hammer.adjuster.close(),t.common.transformer.close(),t.bricklayer.Mover.close(),t.bricklayer.Extender.close()}}),Object(ht["a"])(tu,El,{open:function(t){t.common.selector.open()},close:function(t){t.common.selector.close()}}),Object(ht["a"])(tu,Sl,{open:function(t){t.bricklayer.Builder.pick()},close:function(t){t.bricklayer.Builder.drop().drop()}}),Object(ht["a"])(tu,Cl,{open:function(t){t.bricklayer.Spliter.open()},close:function(t){t.bricklayer.Spliter.close()}}),Object(ht["a"])(tu,Pl,{open:function(t){t.bricklayer.Chamber.pick()},close:function(t){t.bricklayer.Chamber.drop().drop()}}),Object(ht["a"])(tu,Ll,{open:function(){},close:function(){}}),Object(ht["a"])(tu,Fl,{open:function(t){t.label.open()},close:function(t){t.label.close()}}),tu),Nl=function(){function t(e){Object(ut["a"])(this,t),dt["b"].instanceOf(e,Wr)||dt["b"].Throw.TypeError("The `drawing` MUST be a DrawingProxy."),this.drawing=e,this.current=null,this.activeDefault()}return Object(lt["a"])(t,[{key:"active",value:function(t){this.current!==t&&(this.current&&Dl[this.current].close(this.drawing),Dl[t].open(this.drawing),this.current=t)}},{key:"activeDefault",value:function(){this.active(El)}},{key:"deactiveAllTool",value:function(){this.current&&(Dl[this.current].close(this.drawing),this.current=null)}}]),t}(),Wl=Object(lt["a"])((function t(){Object(ut["a"])(this,t)})),Al=function(t){var e=function(t){Object(Ke["a"])(n,t);var e=Object(Xe["a"])(n);function n(t){var r;return Object(ut["a"])(this,n),r=e.call(this),r.drawing=t,r}return Object(lt["a"])(n,[{key:"execute",value:function(){var t=this.drawing.structure.getAllWallList(),e=this.drawing.structure.getAllCornerList(),n=this.drawing.windoor.getAllHollowList(),r=this.drawing.furniture.getAllStuffList(),i=this.drawing.negative.getAllBitmapList(),o=t.map((function(t){var n=[];return n.push(e.indexOf(t.thisSurface.corner)),n.push(e.indexOf(t.thatSurface.corner)),n.push(t.thickness),n})),a=n.map((function(t){var n=t.materialName,r=t.width,i=t.fliped,o=t.offset,a=t.surface,s=e.indexOf(a.corner),c=e.indexOf(a.back.corner);return{materialName:n,width:r,fliped:i,offset:o,surface:[s,c]}})),s=r.map((function(t){var e=t.fill,n=t.x,r=t.y,i=t.width,o=t.height;return{fill:e,x:n,y:r,width:i,height:o}})),c=i.map((function(t){var e=t.url,n=t.width,r=t.height,i=t.x,o=t.y,a=t.rotation;return{url:e,width:n,height:r,x:i,y:o,rotation:a}}));return{cornerList:e.map((function(t){return[t.x,t.y]})),wallList:o,hollowList:a,stuffList:s,bitmapList:c}}}]),n}(Wl);return new e(t)},Il=function(t){var e=function(){function e(t){Object(ut["a"])(this,e),this.drawing=t}return Object(lt["a"])(e,[{key:"execute",value:function(e){var n=e.cornerList,r=e.wallList,i=e.hollowList,o=e.stuffList,a=e.bitmapList,s=n.map((function(e){var n;return(n=t.structure).createCorner.apply(n,Object(ft["a"])(e))}));r.forEach((function(e){var n=t.structure.createWall(s[e[0]],s[e[1]]);n.setThickness(e[2])})),i&&i.length&&i.forEach((function(e){var n=s[e.surface[0]],r=s[e.surface[1]],i=n.getWallByToCorner(r),o=t.windoor.createHollow(e.materialName,i.thisSurface.corner===n?i.thisSurface:i.thatSurface,e.offset);o.setWidth(e.width),o.fliped!==e.fliped&&o.flip()})),o&&o.length&&o.forEach((function(e){var n=e.fill,r=e.x,i=e.y,o=e.width,a=e.height;t.furniture.createStuff(n,r,i,o,a)})),a&&a.length&&a.forEach((function(e){var n=e.url,r=e.width,i=e.height,o=e.x,a=e.y,s=e.rotation;t.negative.createBitmap(n,r,i).then((function(t){t.setPosition(o,a),t.setRotation(s)}))}))}}]),e}();return new e(t)},Ml=(n("bf64"),{w:[0,-1],a:[-1,0],s:[0,1],d:[1,0]}),Rl=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;window.addEventListener("keydown",(function(n){var r=Object(re["a"])(t.origin,2),i=r[0],o=r[1],a=Ml[n.key];a&&t.setOrigin(i+e*a[0],o+e*a[1])}))},Hl=function(t){Object(Ke["a"])(n,t);var e=Object(Xe["a"])(n);function n(t){var r;return Object(ut["a"])(this,n),r=e.call(this),r.surface=t,t.on("dirty",(function(){return r.emit("change")})),t.on("destroy",(function(){return r.emit("destroy")})),r}return Object(lt["a"])(n,[{key:"from",get:function(){return this.surface.origin}},{key:"to",get:function(){return this.surface.target}}]),n}(H.BaseAdaptor);function Bl(t){var e=t.structure,n=t.measure;e.on("wall-created",(function(t){var e=t.thisSurface,r=t.thatSurface;n.createDimension(new Hl(e)),n.createDimension(new Hl(r))}))}var _l=Bl,Vl=function(t,e,n,r,i){var o=[[t-n/2,e+r/2],[t+n/2,e+r/2],[t+n/2,e-r/2],[t-n/2,e-r/2]];return o.map((function(n){return c.rotate.apply(c,Object(ft["a"])(n).concat([i,t,e])).slice(0)}))},zl=function(t,e,n){var r=t.map((function(t){var r=e.find((function(e){return h.containsPoint(Ul(e),{x:t[0],y:t[1]})})),i=n.find((function(e){return h.containsPoint(Ul(e),{x:t[0],y:t[1]})}));return r||(i?"wall":"blank")}));return!r.find((function(t){return"wall"===t}))&&!r.some((function(t){return t!==r[0]}))},Ul=function(t){return t.map((function(t){return{x:t[0],y:t[1]}}))},Yl={getPosition:function(t){return[t.x,t.y]},setPosition:function(t,e,n){t.setPosition(e,n)},getWidth:function(t){return t.width},setWidth:function(t,e){t.setWidth(e)},getHeight:function(t){return t.height},setHeight:function(t,e){t.setHeight(e)},getRotation:function(t){return t.rotation},setRotation:function(t,e){t.setRotation(e)}},Gl=function(t){t.common.addTransformerAdapter(ai,Object.assign({adjustVerify:function(e,n){var r=!0,i=t.structure.getAllRoomList(),o=i.map((function(t){return t.getOuterSurfaceList().map((function(t){return t.origin}))})),a=i.map((function(t){return t.getOuterSurfaceList().map((function(t){return t.back.origin}))}));if(o.length){var s=Vl(n.$state.x,n.$state.y,e.width,e.height,e.rotation);r=zl(s,o,a)}return r},setRoom:function(t,e){t.setRoom(e)}},Yl)),t.common.addTransformerAdapter(uc,Yl),t.common.addSelectorAdapter(ai,{getBounds:function(t){return t.$bounds}}),t.common.addSelectorAdapter(Kr,{getBounds:function(t){return t.$bounds}})},Kl=function(t){var e,n=t.drawing,r=t.tool,i=n.bricklayer.Builder,o=n.label.TextLabeler;n.on("pointerup",(function(t){if(0===t.button){var e=n.focusing;n.common.selectorAction(e),n.common.transformerAction(e),dt["b"].instanceOf(e,T.HollowProxy)?n.hammer.adjuster.pick():n.hammer.adjuster.drop()}})),n.on("pointerdown",(function(t){var e=t.button;if(i.$state===M.STATE.Builder.PICKUP_TO){if(0===e)return void i.build().pick().pick();2===e&&i.drop()}else i.$state===M.STATE.Builder.PICKUP_FROM&&0===e&&i.pick();o.$state===_.STATE.TextLabeler.PICK&&0===e&&o.pick().open()}));var a=n.bricklayer.Chamber,s=(e={},Object(ht["a"])(e,M.STATE.Chamber.PICKUP_FROM,(function(t){0===t&&a.pick()})),Object(ht["a"])(e,M.STATE.Chamber.PICKUP_TO,(function(t){0===t?a.build().pick():2===t&&a.drop()})),e);n.on("pointerdown",(function(t){a.$state!==x.Tool.READY&&s[a.$state](t.button)})),n.structure.on("room-created",(function(){i.$state===M.STATE.Builder.PICKUP_TO&&setTimeout((function(){i.drop()}))})),window.addEventListener("keydown",(function(t){if("Escape"===t.code){if(r.activated===X.Symbol.WALL_BUILDER&&i.$state===M.STATE.Builder.PICKUP_TO)return void i.drop();r.openDefault()}}))},Xl=new WeakMap,ql=function(t){return Xl.get(t)},Jl=function(){function t(e){Object(ut["a"])(this,t),Xl.set(this,new X.Constructor(e))}return Object(lt["a"])(t,[{key:"activated",get:function(){return ql(this).current}},{key:"openDefault",value:function(){ql(this).activeDefault()}},{key:"closeAllTool",value:function(){ql(this).deactiveAllTool()}},{key:"openTransformer",value:function(){ql(this).active(X.Symbol.TRANSFORMER)}},{key:"openSelector",value:function(){ql(this).active(X.Symbol.SELECTOR)}},{key:"openWallBuilder",value:function(){ql(this).active(X.Symbol.WALL_BUILDER)}},{key:"openChamber",value:function(){ql(this).active(X.Symbol.CHAMBER)}},{key:"openSpliter",value:function(){ql(this).active(X.Symbol.SPLITER)}},{key:"openViewport",value:function(){ql(this).active(X.Symbol.VIEWPORT)}},{key:"openLabel",value:function(){ql(this).active(X.Symbol.LABEL)}}]),t}(),Ql=function(t,e,n){var r=function(){function t(e){Object(ut["a"])(this,t),dt["b"].instanceOf(e,Wr)||dt["b"].Throw.TypeError("The `drawing` MUST be a DrawingProxy."),this.drawing=e}return Object(lt["a"])(t,[{key:"add",value:function(){var t=e.execute();return Zl(this.drawing),n.execute({cornerList:t.cornerList,wallList:t.wallList,hollowList:t.hollowList}),t}},{key:"changeFloor",value:function(t){var r=e.execute();return Zl(this.drawing),n.execute(t),r}}]),t}();return new r(t)},Zl=function(t){var e=t.windoor.getAllHollowList(),n=t.furniture.getAllStuffList(),r=t.structure.getAllCornerList(),i=t.negative.getAllBitmapList();e.forEach((function(t){return t.remove()})),n.forEach((function(t){return t.remove()})),r.forEach((function(t){return t.remove()})),i.forEach((function(t){return t.remove()}))},th="https://qhcmsoss.kujiale.com/ttex/L2HNXEIKN4FT2AABAAAAAAY8.jpg",eh=Object(lt["a"])((function t(e){Object(ut["a"])(this,t),this.drawing=e,this.tool=new Jl(e),this.serializer=q.Provider(e),this.deserializer=J.Provider(e),this.floor=et.Provider(e,this.serializer,this.deserializer)})),nh=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=new Wr,n=new eh(e);return t.element&&e.mount(t.element),tt.Surface.all(e),G.AdjustViewportByPointerButton(e),G.PreventDefaultContextMenu(e),G.AdjustZoomByWheel(e),G.SetDefaultFloor(e,th),Q.MovingByWASD(e,10),Gl(e),Kl(n),n};[qa,Jr,ui,oc,Bc,wu,ru,dc,gc,Ru,el].forEach((function(t){return or(t)}));var rh=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("b-table",{staticClass:"mb-0",attrs:{small:"",bordered:"","head-variant":"dark",items:t.items,fields:t.fieldList,hover:""}})],1)},ih=[],oh=(n("b680"),100),ah={name:"CoreState",data:function(){return{editor:null,width:0,height:0,scale:0,origin:[0,0],pointer:[0,0],virtual:[0,0],geometry:[0,0]}},computed:{items:function(){return[{key:"width",value:this.width,unit:"px"},{key:"height",value:this.height,unit:"px"},{key:"scale",value:this.scale,unit:"mm/px"},{key:"originX",value:this.origin[0],unit:"px"},{key:"originY",value:this.origin[1],unit:"px"},{key:"pointerX",value:this.pointer[0].toFixed(2),unit:"px"},{key:"pointerY",value:this.pointer[1].toFixed(2),unit:"px"},{key:"virtualX",value:this.virtual[0].toFixed(2),unit:"px"},{key:"virtualY",value:this.virtual[1].toFixed(2),unit:"px"},{key:"geometryX",value:this.geometry[0].toFixed(2),unit:"mm"},{key:"geometryY",value:this.geometry[1].toFixed(2),unit:"mm"}]},fieldList:function(){return[{key:"key",label:"Key"},{key:"value",label:"Value",class:"col-short-number"},{key:"unit",label:"Unit",class:"col-tiny-string"}]}},mounted:function(){var t=this;this.editor=this.$spoke.getEditor("editor"),this._interval=setInterval((function(){return t.flush()}),oh)},destroyed:function(){clearInterval(this._interval)},methods:{flush:function(){var t=this.editor.drawing;this.width=t.width,this.height=t.height,this.scale=t.scale,this.origin=t.origin,this.pointer=t.pointer,this.virtual=t.virtual}}},sh=ah,ch=n("0c7c"),uh=Object(ch["a"])(sh,rh,ih,!1,null,null,null),lh=uh.exports,hh=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"px-1"},[n("b-button-toolbar",{staticClass:"flex-column flex-nowrap"},[n("b-button",{staticClass:"text-nowrap mb-1",attrs:{variant:"danger"},on:{click:function(e){return t.example()}}},[t._v("示例")]),n("b-button",{staticClass:"text-nowrap",attrs:{variant:"danger"},on:{click:function(e){return t.dragExample()}}},[t._v("拖拽示例")])],1)],1)},fh=[],dh=100,ph=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:dh;return new Promise((function(e){return setTimeout(e,t)}))},vh={name:"Example",data:function(){return{editor:null}},mounted:function(){this.editor=this.$spoke.getEditor("editor")},methods:{example:function(){var t=this;return Object(Qr["a"])(regeneratorRuntime.mark((function e(){var n,r,i,o,a,s,c,u,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.editor.drawing,r=n.structure.createCorner(-2e3,3e3),i=n.structure.createCorner(5e3,3e3),o=n.structure.createCorner(5e3,-1500),a=n.structure.createCorner(-2e3,-1500),s=n.structure.createWall(r,i),e.next=8,ph();case 8:return c=n.structure.createWall(i,o),e.next=11,ph();case 11:return u=n.structure.createWall(o,a),e.next=14,ph();case 14:return l=n.structure.createWall(a,r),e.next=17,ph();case 17:return n.setOrigin(500,500),e.next=20,ph();case 20:return n.setScale(15),e.next=23,ph();case 23:return n.windoor.createHollow("singleDoor",s.thisSurface,1500),e.next=26,ph();case 26:return n.windoor.createHollow("boilerWindow",c.thisSurface,2e3),e.next=29,ph();case 29:return n.windoor.createHollow("singleDoor",u.thisSurface,1500),e.next=32,ph();case 32:return n.windoor.createHollow("basicWindow",l.thisSurface,1500),e.next=35,ph();case 35:return n.furniture.createStuff("bed",2e3,1e3,2e3,2e3),e.next=38,ph();case 38:case"end":return e.stop()}}),e)})))()},dragExample:function(){var t,e,n,r,i=this.editor.drawing,o=[1e4,0],a=(t=i.structure).createCorner.apply(t,o),s=i.structure.createCorner(o[0]+3e3,o[1]),c=i.structure.createCorner(o[0]+3e3,o[1]-3e3);i.structure.createWall(a,s),i.structure.createWall(s,c);var u=[17e3,-7e3],l=(e=i.structure).createCorner.apply(e,u),h=i.structure.createCorner(u[0]+3e3,u[1]),f=i.structure.createCorner(u[0]+3e3,u[1]+3e3),d=i.structure.createCorner(u[0]+3e3,u[1]-3e3);i.structure.createWall(l,h),i.structure.createWall(h,f),i.structure.createWall(h,d);var p=[0,-6e3],v=(n=i.structure).createCorner.apply(n,p),y=i.structure.createCorner(p[0]+3e3,p[1]),g=i.structure.createCorner(p[0]+6e3,p[1]),b=i.structure.createCorner(p[0]+3e3,p[1]-3e3);i.structure.createWall(v,y),i.structure.createWall(y,g),i.structure.createWall(y,b);var m=[11e3,-14e3],w=(r=i.structure).createCorner.apply(r,m),$=i.structure.createCorner(m[0]+3e3,m[1]),x=i.structure.createCorner(m[0]+6e3,m[1]+2e3),O=i.structure.createCorner(m[0]+3e3,m[1]-3e3);i.structure.createWall(w,$),i.structure.createWall($,x),i.structure.createWall($,O);var j=[0,-18e3],T=[[].concat(j),[j[0]+2500,j[1]+2500],[j[0]+3e3,j[1]-2500],[j[0]+5e3,j[1]-2500],[j[0]+1e4,j[1]],[j[0]+5e3,j[1]-5e3],[2e3,j[1]-5e3],[0,j[1]-2e3],[j[0]+7e3,j[1]-5e3],[j[0]+1e4,j[1]-8e3]].map((function(t){var e;return(e=i.structure).createCorner.apply(e,Object(ft["a"])(t))})),k=Object(re["a"])(T,10),E=k[0],S=k[1],C=k[2],P=k[3],L=k[4],F=k[5],D=k[6],N=k[7],W=k[8],A=k[9];i.structure.createWall(E,S),i.structure.createWall(E,C),i.structure.createWall(C,P),i.structure.createWall(P,L),i.structure.createWall(P,F),i.structure.createWall(F,D),i.structure.createWall(D,N),i.structure.createWall(F,W),i.structure.createWall(W,A),i.setScale(12),i.setOrigin(106,-1140)}}},yh=vh,gh=Object(ch["a"])(yh,hh,fh,!1,null,null,null),bh=gh.exports,mh=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"p-1"},[n("b-button-toolbar",{staticClass:"flex-column flex-nowrap mb-1"},[t._l(t.toolList,(function(e,r){return n("b-button",{key:e.value+r,staticClass:"text-nowrap mb-1",staticStyle:{"min-width":"50px"},attrs:{variant:e.value===t.currentTool?"primary":"info"},on:{click:function(n){return t.openTool(e)}}},[t._v(t._s(e.text))])})),t._l(t.adderList,(function(e,r){return n("b-button",{key:e.value+r,staticClass:"text-nowrap mb-1",class:{"mt-4":0===r},staticStyle:{"min-width":"50px"},attrs:{variant:e.value===t.currentTool?"primary":"info"},on:{click:function(n){return t.openTool(e)}}},[t._v(t._s(e.text))])}))],2)],1)},wh=[],$h=[{value:"selector",text:"选择器",open:"openSelector"},{value:"wallBuilder",text:"建墙器",open:"openWallBuilder"},{value:"chamber",text:"建房间",open:"openChamber"},{value:"transformer",text:"变形器",open:"openTransformer"},{value:"spliter",text:"截断器",open:"openSpliter"},{value:"label",text:"标注",open:"openLabel"}],xh=[{value:"negative",text:"添加底图",open:"closeAllTool"},{value:"windoor",text:"添加门窗",open:"closeAllTool"},{value:"furniture",text:"添加家具",open:"closeAllTool"},{value:"floor",text:"楼层",open:"closeAllTool"}],Oh={name:"Panel",data:function(){return{editor:null,currentTool:"selector"}},computed:{toolList:function(){return $h},adderList:function(){return xh}},mounted:function(){var t=this;this.editor=this.$spoke.getEditor("editor"),window.addEventListener("keydown",this._escListener=function(e){"Escape"===e.code&&t.openTool($h[0])})},destroyed:function(){window.removeEventListener("keydown",this._escListener)},methods:{openTool:function(t){this.currentTool=t.value,this.editor.tool[t.open](),this.$emit("changeTool",t.value)}}},jh=Oh,Th=Object(ch["a"])(jh,mh,wh,!1,null,null,null),kh=Th.exports,Eh=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"p-1"},[n("b-button-toolbar",{staticClass:"flex-column flex-nowrap"},[n("b-button",{staticClass:"text-nowrap mb-1",attrs:{variant:"danger"},on:{click:t.serialize}},[t._v("序列化")]),n("b-button",{staticClass:"text-nowrap",attrs:{variant:"danger"},on:{click:t.openDeserializeModal}},[t._v("反序列化")]),n("input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"file_input",attrs:{type:"file",accept:".json"},on:{change:t.onFileChange}}),n("b-modal",{ref:"serialize-modal",attrs:{size:"lg","hide-footer":"",title:"序列化结果"}},[n("div",{staticClass:"d-block text-center"},[n("b-form-textarea",{attrs:{id:"textarea",value:t.floorListString,readonly:"","no-resize":"",size:"sm",rows:"20"}}),n("b-button",{staticClass:"mt-3",attrs:{variant:"info",block:""},on:{click:t.download}},[t._v("下载 json")])],1)]),n("b-modal",{ref:"deserialize-modal",attrs:{size:"lg","hide-footer":"",title:"反序列化"}},[n("div",{staticClass:"d-block text-center"},[n("b-form-textarea",{attrs:{id:"textarea","no-resize":"",size:"sm",rows:"20"},model:{value:t.floorData,callback:function(e){t.floorData=e},expression:"floorData"}}),n("b-button",{staticClass:"mt-3",attrs:{variant:"info",block:""},on:{click:t.upload}},[t._v("上传 json")]),n("b-button",{staticClass:"mt-1",attrs:{variant:"info",block:""},on:{click:t.deserialize}},[t._v("反序列化")])],1)])],1)],1)},Sh=[],Ch=(n("e9c4"),n("c740"),n("2b3d"),n("9861"),{name:"Example",props:{value:Object},data:function(){return{editor:null,floorState:this.value,floorData:""}},computed:{floorListString:function(){return JSON.stringify(this.floorState.floorList,null,2)}},mounted:function(){this.editor=this.$spoke.getEditor("editor")},methods:{serialize:function(){var t=this.editor.serializer.execute();this.$set(this.floorState.floorList,this.floorState.currentFloor,t),this.$set(this.floorState.floorList[this.floorState.firstFloor],"isFirst",!0),this.updateFloorState(),this.$refs["serialize-modal"].show()},deserialize:function(){if(this.floorData){this.$set(this.floorState,"floorList",JSON.parse(this.floorData));var t=this.floorState.floorList.findIndex((function(t){return t.isFirst}));this.$set(this.floorState,"firstFloor",t>-1?t:0),this.$set(this.floorState,"currentFloor",this.floorState.firstFloor),this.updateFloorState(),this.editor.deserializer.execute(this.floorState.floorList[this.floorState.firstFloor]),this.floorData="",this.$refs["deserialize-modal"].hide()}},openDeserializeModal:function(){this.$refs["deserialize-modal"].show()},download:function(){var t=new Blob([this.floorListString],{type:"text/json"}),e=document.createElement("a");e.download="data.json",e.href=window.URL.createObjectURL(t),e.click()},upload:function(){this.$refs.file_input.click()},onFileChange:function(t){var e=this,n=t.target.files[0],r=new FileReader;r.readAsText(n,"utf8"),r.onload=function(){e.floorData=JSON.stringify(JSON.parse(this.result),null,2)}},updateFloorState:function(){this.$emit("input",this.floorState)}}}),Ph=Ch,Lh=Object(ch["a"])(Ph,Eh,Sh,!1,null,null,null),Fh=Lh.exports,Dh=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("b-button-toolbar",{staticClass:"flex-nowrap justify-content-center"},[n("b-button",{staticClass:"text-nowrap mr-1",staticStyle:{"min-width":"50px"},attrs:{variant:"info"},on:{click:t.deleteElement}},[t._v("删除")])],1)],1)},Nh=[],Wh={name:"SelectorDetail",data:function(){return{editor:null}},mounted:function(){this.init()},methods:{init:function(){this.editor=this.$spoke.getEditor("editor")},deleteElement:function(){var t=this,e=this.editor.drawing.common.selector.getElements();e.length&&e.forEach((function(e){e.remove(),t.editor.drawing.common.selector.drop()}))}}},Ah=Wh,Ih=Object(ch["a"])(Ah,Dh,Nh,!1,null,null,null),Mh=Ih.exports,Rh=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("b-button-toolbar",{staticClass:"flex-nowrap justify-content-center"})],1)},Hh=[],Bh={name:"WallBuilderDetail"},_h=Bh,Vh=Object(ch["a"])(_h,Rh,Hh,!1,null,null,null),zh=Vh.exports,Uh=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("b-button-toolbar",{staticClass:"flex-nowrap justify-content-center"},[n("b-button-toolbar",{directives:[{name:"show",rawName:"v-show",value:t.hollow.element,expression:"hollow.element"}],staticClass:"flex-nowrap"},[n("b-form-select",{staticClass:"mr-1",staticStyle:{width:"10em"},attrs:{options:t.materialList},on:{change:t.changeHollowMaterial},model:{value:t.hollow.materialName,callback:function(e){t.$set(t.hollow,"materialName",e)},expression:"hollow.materialName"}}),n("b-input-group",{staticClass:"mr-1 flex-nowrap",attrs:{prepend:"width"}},[n("b-form-input",{staticStyle:{width:"5em"},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.changeHollowWidth.apply(null,arguments)}},model:{value:t.hollow.width,callback:function(e){t.$set(t.hollow,"width",e)},expression:"hollow.width"}})],1),n("b-button",{staticClass:"mr-1 text-nowrap",attrs:{variant:"info"},on:{click:function(e){return t.flipHollow()}}},[t._v("flip")])],1),n("b-button-toolbar",{directives:[{name:"show",rawName:"v-show",value:t.stuff.element,expression:"stuff.element"}],staticClass:"flex-nowrap"},[n("b-input-group",{staticClass:"mr-1 flex-nowrap",attrs:{prepend:"width"}},[n("b-form-input",{staticStyle:{width:"5em"},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.changeStuffWidth.apply(null,arguments)}},model:{value:t.stuff.width,callback:function(e){t.$set(t.stuff,"width",e)},expression:"stuff.width"}})],1),n("b-input-group",{staticClass:"mr-1 flex-nowrap",attrs:{prepend:"height"}},[n("b-form-input",{staticStyle:{width:"5em"},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.changeStuffHeight.apply(null,arguments)}},model:{value:t.stuff.height,callback:function(e){t.$set(t.stuff,"height",e)},expression:"stuff.height"}})],1),n("b-input-group",{staticClass:"mr-1 flex-nowrap",attrs:{prepend:"rotation"}},[n("b-form-input",{staticStyle:{width:"5em"},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.changeStuffRotation.apply(null,arguments)}},model:{value:t.stuff.rotation,callback:function(e){t.$set(t.stuff,"rotation",e)},expression:"stuff.rotation"}})],1)],1)],1)],1)},Yh=[],Gh=(n("9129"),100),Kh={name:"TransformerDetail",data:function(){return{editor:null,hollow:{element:null,width:0,widthClone:0,materialName:""},stuff:{element:null,width:0,height:0,rotation:0,widthClone:0,heightClone:0,rotationClone:0}}},computed:{materialList:function(){return this.$parent.registeredWindoor}},mounted:function(){this.init()},destroyed:function(){clearInterval(this._interval)},methods:{init:function(){var t=this;this.editor=this.$spoke.getEditor("editor"),this._interval=setInterval((function(){t.flush()}),Gh)},flush:function(){var t=this.editor.drawing.hammer.adjuster.getElement(),e=this.editor.drawing.common.transformer.getElement();this.initHollow(t),this.initStuff(e)},initHollow:function(t){if(t){var e=Math.round(t.width);this.hollow.element=t,e!==this.hollow.widthClone&&(this.hollow.width=e),this.hollow.materialName=t.materialName,this.hollow.widthClone=e}else this.hollow.element=null},initStuff:function(t){if(t instanceof V.Furniture.StuffProxy){var e=Math.round(t.width),n=Math.round(t.height),r=Math.round(180*t.rotation/Math.PI);e!==this.stuff.widthClone&&(this.stuff.width=e),n!==this.stuff.heightClone&&(this.stuff.height=n),r!==this.stuff.rotationClone&&(this.stuff.rotation=r),this.stuff.element=t,this.stuff.widthClone=e,this.stuff.heightClone=n,this.stuff.rotationClone=r}else this.stuff.element=null},changeHollowMaterial:function(){this.hollow.element.setMaterial(this.hollow.materialName)},changeHollowWidth:function(){var t=Number(this.hollow.width);Number.isNaN(t)||this.hollow.element.setWidth(t)},flipHollow:function(){this.hollow.element.flip()},changeStuffWidth:function(){var t=Number(this.stuff.width);Number.isNaN(t)||this.stuff.element.setWidth(t)},changeStuffHeight:function(){var t=Number(this.stuff.height);Number.isNaN(t)||this.stuff.element.setHeight(t)},changeStuffRotation:function(){var t=this.stuff.rotation*Math.PI/180;Number.isNaN(t)||this.stuff.element.setRotation(t)}}},Xh=Kh,qh=Object(ch["a"])(Xh,Uh,Yh,!1,null,null,null),Jh=qh.exports,Qh=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("b-button-toolbar",{staticClass:"flex-nowrap justify-content-center"})],1)},Zh=[],tf={name:"SpliterDetail"},ef=tf,nf=Object(ch["a"])(ef,Qh,Zh,!1,null,null,null),rf=nf.exports,of=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("b-button-toolbar",{staticClass:"flex-nowrap justify-content-center"},[n("b-button",{staticClass:"text-nowrap mr-5",staticStyle:{"min-width":"50px"},attrs:{variant:"info"},on:{click:t.createBitmap}},[t._v("添加")])],1)],1)},af=[],sf={name:"NegativeDetail",data:function(){return{editor:null,currentBitmap:null}},mounted:function(){this.editor=this.$spoke.getEditor("editor")},methods:{createBitmap:function(){var t=this;return Object(Qr["a"])(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=t.editor.drawing,r="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fpic.to8to.com%2Fcase%2F2006%2F23%2F20200623_6a750511c8d76b01310a6wvonv822qh0.jpg&refer=http%3A%2F%2Fpic.to8to.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1645100826&t=0437dfdfef1405d8c159efd7c130d5ec",n.negative.createBitmap(r);case 3:case"end":return e.stop()}}),e)})))()}}},cf=sf,uf=Object(ch["a"])(cf,of,af,!1,null,null,null),lf=uf.exports,hf=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("b-button-toolbar",{staticClass:"flex-nowrap justify-content-center"},[n("b-form-select",{staticClass:"mr-1",staticStyle:{width:"10em"},attrs:{options:t.windoorList},model:{value:t.selectedHollow,callback:function(e){t.selectedHollow=e},expression:"selectedHollow"}}),n("b-button",{staticClass:"text-nowrap mr-5",attrs:{variant:"info"},on:{click:function(e){return t.createHollow()}}},[t._v("添加")])],1)],1)},ff=[],df={name:"WindoorDetail",data:function(){return{editor:null,hollowList:[],selectedHollow:""}},computed:{windoorList:function(){return this.$parent.registeredWindoor}},mounted:function(){this.editor=this.$spoke.getEditor("editor"),this.init()},methods:{init:function(){this.selectedHollow=this.windoorList[0].value},createHollow:function(){this.editor.drawing.windoor.createMovingHollow(this.selectedHollow)}}},pf=df,vf=Object(ch["a"])(pf,hf,ff,!1,null,null,null),yf=vf.exports,gf=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("b-button-toolbar",{staticClass:"flex-nowrap justify-content-center"},[n("b-form-select",{staticClass:"mr-1",staticStyle:{width:"10em"},attrs:{options:t.stuffList},model:{value:t.selectedStuff,callback:function(e){t.selectedStuff=e},expression:"selectedStuff"}}),n("b-input-group",{staticClass:"mr-1 flex-nowrap",attrs:{prepend:"宽"}},[n("b-form-input",{staticStyle:{width:"4em"},model:{value:t.width,callback:function(e){t.width=e},expression:"width"}})],1),n("b-input-group",{staticClass:"mr-1 flex-nowrap",attrs:{prepend:"高"}},[n("b-form-input",{staticStyle:{width:"4em"},model:{value:t.height,callback:function(e){t.height=e},expression:"height"}})],1),n("b-button",{staticClass:"text-nowrap",attrs:{variant:"info"},on:{click:function(e){return t.createFurniture()}}},[t._v("添加")])],1)],1)},bf=[],mf=[{text:"床",value:"bed"},{text:"沙发",value:"sofa"}],wf={name:"FurnitureDetail",data:function(){return{editor:null,selectedStuff:"bed",width:1e3,height:1e3}},computed:{stuffList:function(){return mf}},mounted:function(){this.editor=this.$spoke.getEditor("editor")},methods:{createFurniture:function(){this.editor.drawing.furniture.createMovingStuff(this.selectedStuff,this.width,this.height)}}},$f=wf,xf=Object(ch["a"])($f,gf,bf,!1,null,null,null),Of=xf.exports,jf=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("b-button-toolbar",{staticClass:"flex-nowrap justify-content-center"},[n("b-button",{staticClass:"text-nowrap mr-1",staticStyle:{"min-width":"50px"},attrs:{variant:"info"},on:{click:t.addFloor}},[t._v("新增楼层")]),n("b-button",{staticClass:"text-nowrap mr-1",staticStyle:{"min-width":"50px"},attrs:{variant:"info"},on:{click:t.addBasement}},[t._v("新增地下室")]),n("b-form-select",{staticClass:"mr-1",staticStyle:{width:"100px"},attrs:{options:t.floorOptions},on:{change:t.changeFloor},model:{value:t.selectedFloor,callback:function(e){t.selectedFloor=e},expression:"selectedFloor"}}),n("b-button",{directives:[{name:"show",rawName:"v-show",value:t.selectedFloor!==t.floorState.firstFloor,expression:"selectedFloor !== floorState.firstFloor"}],staticClass:"text-nowrap mr-1",staticStyle:{"min-width":"50px"},attrs:{variant:"info"},on:{click:t.deleteFloor}},[t._v("删除楼层")])],1)],1)},Tf=[],kf={name:"FloorDetail",props:{value:Object},data:function(){return{editor:null,floorState:this.value,selectedFloor:0}},watch:{floorState:{deep:!0,handler:function(t){this.selectedFloor=t.currentFloor}}},computed:{floorOptions:function(){var t=this.floorState.firstFloor;return this.floorState.floorList.map((function(e,n){return{value:n,text:"".concat(n<t?"负"+(t-n):n-t+1,"层")}})).reverse()}},mounted:function(){this.init()},methods:{init:function(){this.editor=this.$spoke.getEditor("editor"),0===this.floorState.floorList.length&&(this.floorState.floorList.push({}),this.$emit("input",this.floorState)),this.selectedFloor=this.floorState.currentFloor},addFloor:function(){this.floorState.floorList[this.selectedFloor]=this.editor.floor.add(),this.floorState.floorList.push({}),this.selectedFloor=this.floorState.floorList.length-1,this.updateFloorState()},addBasement:function(){this.floorState.floorList[this.selectedFloor]=this.editor.floor.add(),this.floorState.floorList.unshift({}),this.floorState.firstFloor+=1,this.selectedFloor=0,this.updateFloorState()},changeFloor:function(t){this.floorState.floorList[this.floorState.currentFloor]=this.editor.floor.changeFloor(this.floorState.floorList[t]),this.updateFloorState()},deleteFloor:function(){this.floorState.floorList.splice(this.selectedFloor,1),this.selectedFloor<this.floorState.firstFloor&&(this.floorState.firstFloor-=1),this.editor.floor.changeFloor(this.floorState.floorList[this.floorState.firstFloor]),this.selectedFloor=this.floorState.firstFloor,this.updateFloorState()},updateFloorState:function(){this.floorState.currentFloor=this.selectedFloor,this.$emit("input",this.floorState)}}},Ef=kf,Sf=Object(ch["a"])(Ef,jf,Tf,!1,null,null,null),Cf=Sf.exports,Pf=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("b-button-toolbar",{staticClass:"flex-nowrap justify-content-center"},[n("b-form-radio-group",{staticStyle:{height:"23px"},attrs:{options:t.options},on:{change:t.changeLabeler},model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}})],1),n("b-modal",{ref:"label-text-modal",attrs:{size:"sm","hide-footer":"",title:"标注内容"}},[n("div",{staticClass:"d-block text-center"},[n("b-form-input",{attrs:{placeholder:"No Text"},model:{value:t.textValue,callback:function(e){t.textValue=e},expression:"textValue"}}),n("b-button",{staticClass:"mt-3",attrs:{variant:"info",block:""},on:{click:t.changeText}},[t._v("确定")])],1)])],1)},Lf=[],Ff={name:"LabelDetail",data:function(){return{editor:null,selected:"textLabeler",options:[{value:"textLabeler",text:"文字标注"},{value:"lineLabeler",text:"引线标注"}],textLabel:null,textValue:"",listener:null}},mounted:function(){this.init()},destroyed:function(){this.editor.drawing.label.off("text-created",this.listener)},methods:{init:function(){var t=this;t.editor=t.$spoke.getEditor("editor"),t.editor.drawing.label.on("text-created",t.listener=function(e){t.textLabel=e,t.$refs["label-text-modal"].show()})},changeLabeler:function(t){var e=this.editor.drawing.label;"textLabeler"===t?e.openTextLabeler():e.openLineLabeler()},changeText:function(){this.textLabel.setText(this.textValue),this.$refs["label-text-modal"].hide(),this.textValue=""}}},Df=Ff,Nf=Object(ch["a"])(Df,Pf,Lf,!1,null,null,null),Wf=Nf.exports,Af=[{value:"bed",url:"https://qhyxpicoss.kujiale.com/r/2020/03/30/L4D1111ENDDVAXSVUGEJKFNNVCQD3WKVY8_199x225.png"},{value:"sofa",url:"https://qhrenderpicoss.kujiale.com/r/2021/04/15/L4D1111ENDDV7Y72IBEJKVNWMVXL3WKVY8_303x104.png"}],If={singleDoor:"单开门",doubleDoor:"双开门",slidingDoor:"滑门",parentDoor:"子母门",bealock:"垭口",basicWindow:"窗",boilerWindow:"飘窗",floorWindow:"落地窗"},Mf={selector:Mh,wallBuilder:zh,transformer:Jh,spliter:rf,negative:lf,windoor:yf,furniture:Of,floor:Cf,label:Wf},Rf={name:"Framework",components:{Example:bh,Panel:kh,Persistence:Fh,State:lh},data:function(){var t=this.$spoke.createEditor("editor");return t.drawing.on("element-focus",(function(t){return console.log(t)})),{editor:window.d=t,currentToolDetail:Mh,registeredWindoor:[],floorState:{floorList:[],currentFloor:0,firstFloor:0}}},mounted:function(){this.init()},methods:{init:function(){this.editor.drawing.mount(this.$refs["drawing"]),this.registeredWindoor=Y.windoorRegistry().map((function(t){return{text:If[t],value:t}}));var t,e=Object(ct["a"])(Af);try{for(e.s();!(t=e.n()).done;){var n=t.value;V.Furniture.registerUrl(n.value,n.url)}}catch(r){e.e(r)}finally{e.f()}},changeToolDetail:function(t){this.currentToolDetail=Mf[t]}}},Hf=Rf,Bf=Object(ch["a"])(Hf,at,st,!1,null,null,null),_f=Bf.exports,Vf={components:{Framework:_f}},zf=Vf,Uf=Object(ch["a"])(zf,it,ot,!1,null,null,null),Yf=Uf.exports,Gf={},Kf=Object.freeze({getEditor:function(t){var e=Gf[t];if(!e)throw new Error("id ".concat(t," is not existed"));return e},createEditor:function(t,e){var n=Gf[t];if(n)throw new Error("Duplicated id '".concat(t,"'"));return Gf[t]=nt.Editor(e)}}),Xf={install:function(t){t.prototype.$spoke=Kf}},qf=n("5f5b"),Jf=n("8f9c");window.PIXI=j.PIXI,rt["default"].use(Xf),rt["default"].use(qf["a"],Jf),rt["default"].config.productionTip=!1,new rt["default"]({render:function(t){return t(Yf)}}).$mount("#app")},"5d77":function(t){t.exports=JSON.parse('{"a":"0.0.0"}')},7612:function(t){t.exports=JSON.parse('{"a":"0.0.0"}')},"8f9c":function(t){t.exports=JSON.parse('{"breakpoints":["xs","sm","md","lg","xl","xxl"],"formControls":{"size":"sm"},"BButton":{"variant":"secondary","size":"sm"},"BToast":{"toaster":"b-toaster-top-center","autoHideDelay":3000,"variant":"primary","toastClass":null,"headerClass":null,"bodyClass":null},"BModal":{"cancelVariant":"secondary","okVariant":"primary"},"BFormGroup":{"size":"sm"},"BInputGroup":{"size":"sm"}}')},bf64:function(t,e){},c394:function(t){t.exports=JSON.parse('{"a":"0.0.0"}')},c5c2:function(t){t.exports=JSON.parse('{"a":"0.0.0"}')},e07e:function(t){t.exports=JSON.parse('{"a":"0.0.0"}')}});